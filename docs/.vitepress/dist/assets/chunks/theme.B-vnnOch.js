import{d as gt,o as N,c as A,r as D,n as di,a as xe,t as Si,b as St,w as K,e as bt,T as un,_ as Et,u as Ro,i as qo,f as Wo,g as Fn,h as Jt,j as U,k as L,p as As,l as Os,m as Ve,q as Dn,s as ci,v as ie,x as mn,y as _e,z as Hn,A as Un,B as Jo,C as Zo,D as Pe,F as qi,E as Us,G as zo,H as pn,I as Pt,J as me,K as go,L as dn,M as ge,N as yn,O as Ko,P as Rn,Q as Go,R as Yo,S as _o,U as vn,V as Xo,W as No,X as wo,Y as Lo,Z as Qo,$ as ta,a0 as ia,a1 as sa,a2 as ea,a3 as na}from"./framework.BXFFLb3j.js";const oa=gt({__name:"VPBadge",props:{text:{},type:{default:"tip"}},setup(r){return(h,m)=>(N(),A("span",{class:di(["VPBadge",h.type])},[D(h.$slots,"default",{},()=>[xe(Si(h.text),1)])],2))}}),aa={key:0,class:"VPBackdrop"},ha=gt({__name:"VPBackdrop",props:{show:{type:Boolean}},setup(r){return(h,m)=>(N(),St(un,{name:"fade"},{default:K(()=>[h.show?(N(),A("div",aa)):bt("",!0)]),_:1}))}}),ra=Et(ha,[["__scopeId","data-v-cb80dfb9"]]),li=Ro;function la(r,h){let m,v=!1;return()=>{m&&clearTimeout(m),v?m=setTimeout(r,h):(r(),(v=!0)&&setTimeout(()=>v=!1,h))}}function jn(r){return/^\//.test(r)?r:`/${r}`}function qn(r){const{pathname:h,search:m,hash:v,protocol:y}=new URL(r,"http://a.com");if(qo(r)||r.startsWith("#")||!y.startsWith("http")||!Wo(h))return r;const{site:M}=li(),j=h.endsWith("/")||h.endsWith(".html")?r:r.replace(/(?:(^\.+)\/)?.*$/,`$1${h.replace(/(\.md)?$/,M.value.cleanUrls?"":".html")}${m}${v}`);return Fn(j)}function De({correspondingLink:r=!1}={}){const{site:h,localeIndex:m,page:v,theme:y,hash:M}=li(),j=Jt(()=>{var F,_t;return{label:(F=h.value.locales[m.value])==null?void 0:F.label,link:((_t=h.value.locales[m.value])==null?void 0:_t.link)||(m.value==="root"?"/":`/${m.value}/`)}});return{localeLinks:Jt(()=>Object.entries(h.value.locales).flatMap(([F,_t])=>j.value.label===_t.label?[]:{text:_t.label,link:ca(_t.link||(F==="root"?"/":`/${F}/`),y.value.i18nRouting!==!1&&r,v.value.relativePath.slice(j.value.link.length-1),!h.value.cleanUrls)+M.value})),currentLang:j}}function ca(r,h,m,v){return h?r.replace(/\/$/,"")+jn(m.replace(/(^|\/)index\.md$/,"$1").replace(/\.md$/,v?".html":"")):r}const ua=r=>(As("data-v-e909b15e"),r=r(),Os(),r),ma={class:"NotFound"},pa={class:"code"},da={class:"title"},ya=ua(()=>U("div",{class:"divider"},null,-1)),va={class:"quote"},fa={class:"action"},xa=["href","aria-label"],ba=gt({__name:"NotFound",setup(r){const{theme:h}=li(),{currentLang:m}=De();return(v,y)=>{var M,j,W,F,_t;return N(),A("div",ma,[U("p",pa,Si(((M=L(h).notFound)==null?void 0:M.code)??"404"),1),U("h1",da,Si(((j=L(h).notFound)==null?void 0:j.title)??"PAGE NOT FOUND"),1),ya,U("blockquote",va,Si(((W=L(h).notFound)==null?void 0:W.quote)??"But if you don't change your direction, and if you keep looking, you may end up where you are heading."),1),U("div",fa,[U("a",{class:"link",href:L(Fn)(L(m).link),"aria-label":((F=L(h).notFound)==null?void 0:F.linkLabel)??"go to home"},Si(((_t=L(h).notFound)==null?void 0:_t.linkText)??"Take me home"),9,xa)])])}}}),ka=Et(ba,[["__scopeId","data-v-e909b15e"]]);function Mo(r,h){if(Array.isArray(r))return ln(r);if(r==null)return[];h=jn(h);const m=Object.keys(r).sort((y,M)=>M.split("/").length-y.split("/").length).find(y=>h.startsWith(jn(y))),v=m?r[m]:[];return Array.isArray(v)?ln(v):ln(v.items,v.base)}function za(r){const h=[];let m=0;for(const v in r){const y=r[v];if(y.items){m=h.push(y);continue}h[m]||h.push({items:[]}),h[m].items.push(y)}return h}function ga(r){const h=[];function m(v){for(const y of v)y.text&&y.link&&h.push({text:y.text,link:y.link,docFooterText:y.docFooterText}),y.items&&m(y.items)}return m(r),h}function Bn(r,h){return Array.isArray(h)?h.some(m=>Bn(r,m)):Ve(r,h.link)?!0:h.items?Bn(r,h.items):!1}function ln(r,h){return[...r].map(m=>{const v={...m},y=v.base||h;return y&&v.link&&(v.link=y+v.link),v.items&&(v.items=ln(v.items,y)),v})}function be(){const{frontmatter:r,page:h,theme:m}=li(),v=Dn("(min-width: 960px)"),y=ci(!1),M=Jt(()=>{const Ei=m.value.sidebar,yi=h.value.relativePath;return Ei?Mo(Ei,yi):[]}),j=ci(M.value);ie(M,(Ei,yi)=>{JSON.stringify(Ei)!==JSON.stringify(yi)&&(j.value=M.value)});const W=Jt(()=>r.value.sidebar!==!1&&j.value.length>0&&r.value.layout!=="home"),F=Jt(()=>_t?r.value.aside==null?m.value.aside==="left":r.value.aside==="left":!1),_t=Jt(()=>r.value.layout==="home"?!1:r.value.aside!=null?!!r.value.aside:m.value.aside!==!1),ii=Jt(()=>W.value&&v.value),Ft=Jt(()=>W.value?za(j.value):[]);function At(){y.value=!0}function Xt(){y.value=!1}function Li(){y.value?Xt():At()}return{isOpen:y,sidebar:j,sidebarGroups:Ft,hasSidebar:W,hasAside:_t,leftAside:F,isSidebarEnabled:ii,open:At,close:Xt,toggle:Li}}function _a(r,h){let m;mn(()=>{m=r.value?document.activeElement:void 0}),_e(()=>{window.addEventListener("keyup",v)}),Hn(()=>{window.removeEventListener("keyup",v)});function v(y){y.key==="Escape"&&r.value&&(h(),m==null||m.focus())}}function Na(r){const{page:h,hash:m}=li(),v=ci(!1),y=Jt(()=>r.value.collapsed!=null),M=Jt(()=>!!r.value.link),j=ci(!1),W=()=>{j.value=Ve(h.value.relativePath,r.value.link)};ie([h,r,m],W),_e(W);const F=Jt(()=>j.value?!0:r.value.items?Bn(h.value.relativePath,r.value.items):!1),_t=Jt(()=>!!(r.value.items&&r.value.items.length));mn(()=>{v.value=!!(y.value&&r.value.collapsed)}),Un(()=>{(j.value||F.value)&&(v.value=!1)});function ii(){y.value&&(v.value=!v.value)}return{collapsed:v,collapsible:y,isLink:M,isActiveLink:j,hasActiveLink:F,hasChildren:_t,toggle:ii}}function wa(){const{hasSidebar:r}=be(),h=Dn("(min-width: 960px)"),m=Dn("(min-width: 1280px)");return{isAsideEnabled:Jt(()=>!m.value&&!h.value?!1:r.value?m.value:h.value)}}const En=[];function Vo(r){return typeof r.outline=="object"&&!Array.isArray(r.outline)&&r.outline.label||r.outlineTitle||"On this page"}function Wn(r){const h=[...document.querySelectorAll(".VPDoc :where(h1,h2,h3,h4,h5,h6)")].filter(m=>m.id&&m.hasChildNodes()).map(m=>{const v=Number(m.tagName[1]);return{element:m,title:La(m),link:"#"+m.id,level:v}});return Ma(h,r)}function La(r){let h="";for(const m of r.childNodes)if(m.nodeType===1){if(m.classList.contains("VPBadge")||m.classList.contains("header-anchor")||m.classList.contains("ignore-header"))continue;h+=m.textContent}else m.nodeType===3&&(h+=m.textContent);return h.trim()}function Ma(r,h){if(h===!1)return[];const m=(typeof h=="object"&&!Array.isArray(h)?h.level:h)||2,[v,y]=typeof m=="number"?[m,m]:m==="deep"?[2,6]:m;r=r.filter(j=>j.level>=v&&j.level<=y),En.length=0;for(const{element:j,link:W}of r)En.push({element:j,link:W});const M=[];t:for(let j=0;j<r.length;j++){const W=r[j];if(j===0)M.push(W);else{for(let F=j-1;F>=0;F--){const _t=r[F];if(_t.level<W.level){(_t.children||(_t.children=[])).push(W);continue t}}M.push(W)}}return M}function Va(r,h){const{isAsideEnabled:m}=wa(),v=la(M,100);let y=null;_e(()=>{requestAnimationFrame(M),window.addEventListener("scroll",v)}),Jo(()=>{j(location.hash)}),Hn(()=>{window.removeEventListener("scroll",v)});function M(){if(!m.value)return;const W=window.scrollY,F=window.innerHeight,_t=document.body.offsetHeight,ii=Math.abs(W+F-_t)<1,Ft=En.map(({element:Xt,link:Li})=>({link:Li,top:Pa(Xt)})).filter(({top:Xt})=>!Number.isNaN(Xt)).sort((Xt,Li)=>Xt.top-Li.top);if(!Ft.length){j(null);return}if(W<1){j(null);return}if(ii){j(Ft[Ft.length-1].link);return}let At=null;for(const{link:Xt,top:Li}of Ft){if(Li>W+Zo()+4)break;At=Xt}j(At)}function j(W){y&&y.classList.remove("active"),W==null?y=null:y=r.value.querySelector(`a[href="${decodeURIComponent(W)}"]`);const F=y;F?(F.classList.add("active"),h.value.style.top=F.offsetTop+39+"px",h.value.style.opacity="1"):(h.value.style.top="33px",h.value.style.opacity="0")}}function Pa(r){let h=0;for(;r!==document.body;){if(r===null)return NaN;h+=r.offsetTop,r=r.offsetParent}return h}const Sa=["href","title"],Ia=gt({__name:"VPDocOutlineItem",props:{headers:{},root:{type:Boolean}},setup(r){function h({target:m}){const v=m.href.split("#")[1],y=document.getElementById(decodeURIComponent(v));y==null||y.focus({preventScroll:!0})}return(m,v)=>{const y=Pe("VPDocOutlineItem",!0);return N(),A("ul",{class:di(["VPDocOutlineItem",m.root?"root":"nested"])},[(N(!0),A(qi,null,Us(m.headers,({children:M,link:j,title:W})=>(N(),A("li",null,[U("a",{class:"outline-link",href:j,onClick:h,title:W},Si(W),9,Sa),M!=null&&M.length?(N(),St(y,{key:0,headers:M},null,8,["headers"])):bt("",!0)]))),256))],2)}}}),Po=Et(Ia,[["__scopeId","data-v-35a71cb0"]]),$a={class:"content"},Ta={"aria-level":"2",class:"outline-title",id:"doc-outline-aria-label",role:"heading"},Ca=gt({__name:"VPDocAsideOutline",setup(r){const{frontmatter:h,theme:m}=li(),v=zo([]);pn(()=>{v.value=Wn(h.value.outline??m.value.outline)});const y=ci(),M=ci();return Va(y,M),(j,W)=>(N(),A("nav",{"aria-labelledby":"doc-outline-aria-label",class:di(["VPDocAsideOutline",{"has-outline":v.value.length>0}]),ref_key:"container",ref:y},[U("div",$a,[U("div",{class:"outline-marker",ref_key:"marker",ref:M},null,512),U("div",Ta,Si(L(Vo)(L(m))),1),Pt(Po,{headers:v.value,root:!0},null,8,["headers"])])],2))}}),Aa=Et(Ca,[["__scopeId","data-v-93551120"]]),Oa={class:"VPDocAsideCarbonAds"},Da=gt({__name:"VPDocAsideCarbonAds",props:{carbonAds:{}},setup(r){const h=()=>null;return(m,v)=>(N(),A("div",Oa,[Pt(L(h),{"carbon-ads":m.carbonAds},null,8,["carbon-ads"])]))}}),ja=r=>(As("data-v-1cd7a49d"),r=r(),Os(),r),Ba={class:"VPDocAside"},Ea=ja(()=>U("div",{class:"spacer"},null,-1)),Fa=gt({__name:"VPDocAside",setup(r){const{theme:h}=li();return(m,v)=>(N(),A("div",Ba,[D(m.$slots,"aside-top",{},void 0,!0),D(m.$slots,"aside-outline-before",{},void 0,!0),Pt(Aa),D(m.$slots,"aside-outline-after",{},void 0,!0),Ea,D(m.$slots,"aside-ads-before",{},void 0,!0),L(h).carbonAds?(N(),St(Da,{key:0,"carbon-ads":L(h).carbonAds},null,8,["carbon-ads"])):bt("",!0),D(m.$slots,"aside-ads-after",{},void 0,!0),D(m.$slots,"aside-bottom",{},void 0,!0)]))}}),Ha=Et(Fa,[["__scopeId","data-v-1cd7a49d"]]);function Ua(){const{theme:r,page:h}=li();return Jt(()=>{const{text:m="Edit this page",pattern:v=""}=r.value.editLink||{};let y;return typeof v=="function"?y=v(h.value):y=v.replace(/:path/g,h.value.filePath),{url:y,text:m}})}function Ra(){const{page:r,theme:h,frontmatter:m}=li();return Jt(()=>{var _t,ii,Ft,At,Xt,Li,Ei,yi;const v=Mo(h.value.sidebar,r.value.relativePath),y=ga(v),M=qa(y,Qs=>Qs.link.replace(/[?#].*$/,"")),j=M.findIndex(Qs=>Ve(r.value.relativePath,Qs.link)),W=((_t=h.value.docFooter)==null?void 0:_t.prev)===!1&&!m.value.prev||m.value.prev===!1,F=((ii=h.value.docFooter)==null?void 0:ii.next)===!1&&!m.value.next||m.value.next===!1;return{prev:W?void 0:{text:(typeof m.value.prev=="string"?m.value.prev:typeof m.value.prev=="object"?m.value.prev.text:void 0)??((Ft=M[j-1])==null?void 0:Ft.docFooterText)??((At=M[j-1])==null?void 0:At.text),link:(typeof m.value.prev=="object"?m.value.prev.link:void 0)??((Xt=M[j-1])==null?void 0:Xt.link)},next:F?void 0:{text:(typeof m.value.next=="string"?m.value.next:typeof m.value.next=="object"?m.value.next.text:void 0)??((Li=M[j+1])==null?void 0:Li.docFooterText)??((Ei=M[j+1])==null?void 0:Ei.text),link:(typeof m.value.next=="object"?m.value.next.link:void 0)??((yi=M[j+1])==null?void 0:yi.link)}}})}function qa(r,h){const m=new Set;return r.filter(v=>{const y=h(v);return m.has(y)?!1:m.add(y)})}const pe=gt({__name:"VPLink",props:{tag:{},href:{},noIcon:{type:Boolean},target:{},rel:{}},setup(r){const h=r,m=Jt(()=>h.tag??(h.href?"a":"span")),v=Jt(()=>h.href&&go.test(h.href)||h.target==="_blank");return(y,M)=>(N(),St(me(m.value),{class:di(["VPLink",{link:y.href,"vp-external-link-icon":v.value,"no-icon":y.noIcon}]),href:y.href?L(qn)(y.href):void 0,target:y.target??(v.value?"_blank":void 0),rel:y.rel??(v.value?"noreferrer":void 0)},{default:K(()=>[D(y.$slots,"default")]),_:3},8,["class","href","target","rel"]))}}),Wa={class:"VPLastUpdated"},Ja=["datetime"],Za=gt({__name:"VPDocFooterLastUpdated",setup(r){const{theme:h,page:m,lang:v}=li(),y=Jt(()=>new Date(m.value.lastUpdated)),M=Jt(()=>y.value.toISOString()),j=ci("");return _e(()=>{mn(()=>{var W,F,_t;j.value=new Intl.DateTimeFormat((F=(W=h.value.lastUpdated)==null?void 0:W.formatOptions)!=null&&F.forceLocale?v.value:void 0,((_t=h.value.lastUpdated)==null?void 0:_t.formatOptions)??{dateStyle:"short",timeStyle:"short"}).format(y.value)})}),(W,F)=>{var _t;return N(),A("p",Wa,[xe(Si(((_t=L(h).lastUpdated)==null?void 0:_t.text)||L(h).lastUpdatedText||"Last updated")+": ",1),U("time",{datetime:M.value},Si(j.value),9,Ja)])}}}),Ka=Et(Za,[["__scopeId","data-v-7a4a291e"]]),So=r=>(As("data-v-748ddfb1"),r=r(),Os(),r),Ga={key:0,class:"VPDocFooter"},Ya={key:0,class:"edit-info"},Xa={key:0,class:"edit-link"},Qa=So(()=>U("span",{class:"vpi-square-pen edit-link-icon"},null,-1)),th={key:1,class:"last-updated"},ih={key:1,class:"prev-next","aria-labelledby":"doc-footer-aria-label"},sh=So(()=>U("span",{class:"visually-hidden",id:"doc-footer-aria-label"},"Pager",-1)),eh={class:"pager"},nh=["innerHTML"],oh=["innerHTML"],ah={class:"pager"},hh=["innerHTML"],rh=["innerHTML"],lh=gt({__name:"VPDocFooter",setup(r){const{theme:h,page:m,frontmatter:v}=li(),y=Ua(),M=Ra(),j=Jt(()=>h.value.editLink&&v.value.editLink!==!1),W=Jt(()=>m.value.lastUpdated),F=Jt(()=>j.value||W.value||M.value.prev||M.value.next);return(_t,ii)=>{var Ft,At,Xt,Li;return F.value?(N(),A("footer",Ga,[D(_t.$slots,"doc-footer-before",{},void 0,!0),j.value||W.value?(N(),A("div",Ya,[j.value?(N(),A("div",Xa,[Pt(pe,{class:"edit-link-button",href:L(y).url,"no-icon":!0},{default:K(()=>[Qa,xe(" "+Si(L(y).text),1)]),_:1},8,["href"])])):bt("",!0),W.value?(N(),A("div",th,[Pt(Ka)])):bt("",!0)])):bt("",!0),(Ft=L(M).prev)!=null&&Ft.link||(At=L(M).next)!=null&&At.link?(N(),A("nav",ih,[sh,U("div",eh,[(Xt=L(M).prev)!=null&&Xt.link?(N(),St(pe,{key:0,class:"pager-link prev",href:L(M).prev.link},{default:K(()=>{var Ei;return[U("span",{class:"desc",innerHTML:((Ei=L(h).docFooter)==null?void 0:Ei.prev)||"Previous page"},null,8,nh),U("span",{class:"title",innerHTML:L(M).prev.text},null,8,oh)]}),_:1},8,["href"])):bt("",!0)]),U("div",ah,[(Li=L(M).next)!=null&&Li.link?(N(),St(pe,{key:0,class:"pager-link next",href:L(M).next.link},{default:K(()=>{var Ei;return[U("span",{class:"desc",innerHTML:((Ei=L(h).docFooter)==null?void 0:Ei.next)||"Next page"},null,8,hh),U("span",{class:"title",innerHTML:L(M).next.text},null,8,rh)]}),_:1},8,["href"])):bt("",!0)])])):bt("",!0)])):bt("",!0)}}}),ch=Et(lh,[["__scopeId","data-v-748ddfb1"]]),uh=r=>(As("data-v-3d4a6652"),r=r(),Os(),r),mh={class:"container"},ph=uh(()=>U("div",{class:"aside-curtain"},null,-1)),dh={class:"aside-container"},yh={class:"aside-content"},vh={class:"content"},fh={class:"content-container"},xh={class:"main"},bh=gt({__name:"VPDoc",setup(r){const{theme:h}=li(),m=dn(),{hasSidebar:v,hasAside:y,leftAside:M}=be(),j=Jt(()=>m.path.replace(/[./]+/g,"_").replace(/_html$/,""));return(W,F)=>{const _t=Pe("Content");return N(),A("div",{class:di(["VPDoc",{"has-sidebar":L(v),"has-aside":L(y)}])},[D(W.$slots,"doc-top",{},void 0,!0),U("div",mh,[L(y)?(N(),A("div",{key:0,class:di(["aside",{"left-aside":L(M)}])},[ph,U("div",dh,[U("div",yh,[Pt(Ha,null,{"aside-top":K(()=>[D(W.$slots,"aside-top",{},void 0,!0)]),"aside-bottom":K(()=>[D(W.$slots,"aside-bottom",{},void 0,!0)]),"aside-outline-before":K(()=>[D(W.$slots,"aside-outline-before",{},void 0,!0)]),"aside-outline-after":K(()=>[D(W.$slots,"aside-outline-after",{},void 0,!0)]),"aside-ads-before":K(()=>[D(W.$slots,"aside-ads-before",{},void 0,!0)]),"aside-ads-after":K(()=>[D(W.$slots,"aside-ads-after",{},void 0,!0)]),_:3})])])],2)):bt("",!0),U("div",vh,[U("div",fh,[D(W.$slots,"doc-before",{},void 0,!0),U("main",xh,[Pt(_t,{class:di(["vp-doc",[j.value,L(h).externalLinkIcon&&"external-link-icon-enabled"]])},null,8,["class"])]),Pt(ch,null,{"doc-footer-before":K(()=>[D(W.$slots,"doc-footer-before",{},void 0,!0)]),_:3}),D(W.$slots,"doc-after",{},void 0,!0)])])]),D(W.$slots,"doc-bottom",{},void 0,!0)],2)}}}),kh=Et(bh,[["__scopeId","data-v-3d4a6652"]]),zh=gt({__name:"VPButton",props:{tag:{},size:{default:"medium"},theme:{default:"brand"},text:{},href:{},target:{},rel:{}},setup(r){const h=r,m=Jt(()=>h.href&&go.test(h.href)),v=Jt(()=>h.tag||h.href?"a":"button");return(y,M)=>(N(),St(me(v.value),{class:di(["VPButton",[y.size,y.theme]]),href:y.href?L(qn)(y.href):void 0,target:h.target??(m.value?"_blank":void 0),rel:h.rel??(m.value?"noreferrer":void 0)},{default:K(()=>[xe(Si(y.text),1)]),_:1},8,["class","href","target","rel"]))}}),gh=Et(zh,[["__scopeId","data-v-b3974d2b"]]),_h=["src","alt"],Nh=gt({inheritAttrs:!1,__name:"VPImage",props:{image:{},alt:{}},setup(r){return(h,m)=>{const v=Pe("VPImage",!0);return h.image?(N(),A(qi,{key:0},[typeof h.image=="string"||"src"in h.image?(N(),A("img",ge({key:0,class:"VPImage"},typeof h.image=="string"?h.$attrs:{...h.image,...h.$attrs},{src:L(Fn)(typeof h.image=="string"?h.image:h.image.src),alt:h.alt??(typeof h.image=="string"?"":h.image.alt||"")}),null,16,_h)):(N(),A(qi,{key:1},[Pt(v,ge({class:"dark",image:h.image.dark,alt:h.image.alt},h.$attrs),null,16,["image","alt"]),Pt(v,ge({class:"light",image:h.image.light,alt:h.image.alt},h.$attrs),null,16,["image","alt"])],64))],64)):bt("",!0)}}}),cn=Et(Nh,[["__scopeId","data-v-623fa81d"]]),wh=r=>(As("data-v-07872c7c"),r=r(),Os(),r),Lh={class:"container"},Mh={class:"main"},Vh={key:0,class:"name"},Ph=["innerHTML"],Sh=["innerHTML"],Ih=["innerHTML"],$h={key:0,class:"actions"},Th={key:0,class:"image"},Ch={class:"image-container"},Ah=wh(()=>U("div",{class:"image-bg"},null,-1)),Oh=gt({__name:"VPHero",props:{name:{},text:{},tagline:{},image:{},actions:{}},setup(r){const h=yn("hero-image-slot-exists");return(m,v)=>(N(),A("div",{class:di(["VPHero",{"has-image":m.image||L(h)}])},[U("div",Lh,[U("div",Mh,[D(m.$slots,"home-hero-info-before",{},void 0,!0),D(m.$slots,"home-hero-info",{},()=>[m.name?(N(),A("h1",Vh,[U("span",{innerHTML:m.name,class:"clip"},null,8,Ph)])):bt("",!0),m.text?(N(),A("p",{key:1,innerHTML:m.text,class:"text"},null,8,Sh)):bt("",!0),m.tagline?(N(),A("p",{key:2,innerHTML:m.tagline,class:"tagline"},null,8,Ih)):bt("",!0)],!0),D(m.$slots,"home-hero-info-after",{},void 0,!0),m.actions?(N(),A("div",$h,[(N(!0),A(qi,null,Us(m.actions,y=>(N(),A("div",{key:y.link,class:"action"},[Pt(gh,{tag:"a",size:"medium",theme:y.theme,text:y.text,href:y.link,target:y.target,rel:y.rel},null,8,["theme","text","href","target","rel"])]))),128))])):bt("",!0),D(m.$slots,"home-hero-actions-after",{},void 0,!0)]),m.image||L(h)?(N(),A("div",Th,[U("div",Ch,[Ah,D(m.$slots,"home-hero-image",{},()=>[m.image?(N(),St(cn,{key:0,class:"image-src",image:m.image},null,8,["image"])):bt("",!0)],!0)])])):bt("",!0)])],2))}}),Dh=Et(Oh,[["__scopeId","data-v-07872c7c"]]),jh=gt({__name:"VPHomeHero",setup(r){const{frontmatter:h}=li();return(m,v)=>L(h).hero?(N(),St(Dh,{key:0,class:"VPHomeHero",name:L(h).hero.name,text:L(h).hero.text,tagline:L(h).hero.tagline,image:L(h).hero.image,actions:L(h).hero.actions},{"home-hero-info-before":K(()=>[D(m.$slots,"home-hero-info-before")]),"home-hero-info":K(()=>[D(m.$slots,"home-hero-info")]),"home-hero-info-after":K(()=>[D(m.$slots,"home-hero-info-after")]),"home-hero-actions-after":K(()=>[D(m.$slots,"home-hero-actions-after")]),"home-hero-image":K(()=>[D(m.$slots,"home-hero-image")]),_:3},8,["name","text","tagline","image","actions"])):bt("",!0)}}),Bh=r=>(As("data-v-40f684b7"),r=r(),Os(),r),Eh={class:"box"},Fh={key:0,class:"icon"},Hh=["innerHTML"],Uh=["innerHTML"],Rh=["innerHTML"],qh={key:4,class:"link-text"},Wh={class:"link-text-value"},Jh=Bh(()=>U("span",{class:"vpi-arrow-right link-text-icon"},null,-1)),Zh=gt({__name:"VPFeature",props:{icon:{},title:{},details:{},link:{},linkText:{},rel:{},target:{}},setup(r){return(h,m)=>(N(),St(pe,{class:"VPFeature",href:h.link,rel:h.rel,target:h.target,"no-icon":!0,tag:h.link?"a":"div"},{default:K(()=>[U("article",Eh,[typeof h.icon=="object"&&h.icon.wrap?(N(),A("div",Fh,[Pt(cn,{image:h.icon,alt:h.icon.alt,height:h.icon.height||48,width:h.icon.width||48},null,8,["image","alt","height","width"])])):typeof h.icon=="object"?(N(),St(cn,{key:1,image:h.icon,alt:h.icon.alt,height:h.icon.height||48,width:h.icon.width||48},null,8,["image","alt","height","width"])):h.icon?(N(),A("div",{key:2,class:"icon",innerHTML:h.icon},null,8,Hh)):bt("",!0),U("h2",{class:"title",innerHTML:h.title},null,8,Uh),h.details?(N(),A("p",{key:3,class:"details",innerHTML:h.details},null,8,Rh)):bt("",!0),h.linkText?(N(),A("div",qh,[U("p",Wh,[xe(Si(h.linkText)+" ",1),Jh])])):bt("",!0)])]),_:1},8,["href","rel","target","tag"]))}}),Kh=Et(Zh,[["__scopeId","data-v-40f684b7"]]),Gh={key:0,class:"VPFeatures"},Yh={class:"container"},Xh={class:"items"},Qh=gt({__name:"VPFeatures",props:{features:{}},setup(r){const h=r,m=Jt(()=>{const v=h.features.length;if(v){if(v===2)return"grid-2";if(v===3)return"grid-3";if(v%3===0)return"grid-6";if(v>3)return"grid-4"}else return});return(v,y)=>v.features?(N(),A("div",Gh,[U("div",Yh,[U("div",Xh,[(N(!0),A(qi,null,Us(v.features,M=>(N(),A("div",{key:M.title,class:di(["item",[m.value]])},[Pt(Kh,{icon:M.icon,title:M.title,details:M.details,link:M.link,"link-text":M.linkText,rel:M.rel,target:M.target},null,8,["icon","title","details","link","link-text","rel","target"])],2))),128))])])])):bt("",!0)}}),tr=Et(Qh,[["__scopeId","data-v-ec684931"]]),ir=gt({__name:"VPHomeFeatures",setup(r){const{frontmatter:h}=li();return(m,v)=>L(h).features?(N(),St(tr,{key:0,class:"VPHomeFeatures",features:L(h).features},null,8,["features"])):bt("",!0)}}),sr=gt({__name:"VPHomeContent",setup(r){const{width:h}=Ko({initialWidth:0,includeScrollbar:!1});return(m,v)=>(N(),A("div",{class:"vp-doc container",style:Rn(L(h)?{"--vp-offset":`calc(50% - ${L(h)/2}px)`}:{})},[D(m.$slots,"default",{},void 0,!0)],4))}}),er=Et(sr,[["__scopeId","data-v-e87be01f"]]),nr={class:"VPHome"},or=gt({__name:"VPHome",setup(r){const{frontmatter:h}=li();return(m,v)=>{const y=Pe("Content");return N(),A("div",nr,[D(m.$slots,"home-hero-before",{},void 0,!0),Pt(jh,null,{"home-hero-info-before":K(()=>[D(m.$slots,"home-hero-info-before",{},void 0,!0)]),"home-hero-info":K(()=>[D(m.$slots,"home-hero-info",{},void 0,!0)]),"home-hero-info-after":K(()=>[D(m.$slots,"home-hero-info-after",{},void 0,!0)]),"home-hero-actions-after":K(()=>[D(m.$slots,"home-hero-actions-after",{},void 0,!0)]),"home-hero-image":K(()=>[D(m.$slots,"home-hero-image",{},void 0,!0)]),_:3}),D(m.$slots,"home-hero-after",{},void 0,!0),D(m.$slots,"home-features-before",{},void 0,!0),Pt(ir),D(m.$slots,"home-features-after",{},void 0,!0),L(h).markdownStyles!==!1?(N(),St(er,{key:0},{default:K(()=>[Pt(y)]),_:1})):(N(),St(y,{key:1}))])}}}),ar=Et(or,[["__scopeId","data-v-07d1c0b4"]]),hr={},rr={class:"VPPage"};function lr(r,h){const m=Pe("Content");return N(),A("div",rr,[D(r.$slots,"page-top"),Pt(m),D(r.$slots,"page-bottom")])}const cr=Et(hr,[["render",lr]]),ur=gt({__name:"VPContent",setup(r){const{page:h,frontmatter:m}=li(),{hasSidebar:v}=be();return(y,M)=>(N(),A("div",{class:di(["VPContent",{"has-sidebar":L(v),"is-home":L(m).layout==="home"}]),id:"VPContent"},[L(h).isNotFound?D(y.$slots,"not-found",{key:0},()=>[Pt(ka)],!0):L(m).layout==="page"?(N(),St(cr,{key:1},{"page-top":K(()=>[D(y.$slots,"page-top",{},void 0,!0)]),"page-bottom":K(()=>[D(y.$slots,"page-bottom",{},void 0,!0)]),_:3})):L(m).layout==="home"?(N(),St(ar,{key:2},{"home-hero-before":K(()=>[D(y.$slots,"home-hero-before",{},void 0,!0)]),"home-hero-info-before":K(()=>[D(y.$slots,"home-hero-info-before",{},void 0,!0)]),"home-hero-info":K(()=>[D(y.$slots,"home-hero-info",{},void 0,!0)]),"home-hero-info-after":K(()=>[D(y.$slots,"home-hero-info-after",{},void 0,!0)]),"home-hero-actions-after":K(()=>[D(y.$slots,"home-hero-actions-after",{},void 0,!0)]),"home-hero-image":K(()=>[D(y.$slots,"home-hero-image",{},void 0,!0)]),"home-hero-after":K(()=>[D(y.$slots,"home-hero-after",{},void 0,!0)]),"home-features-before":K(()=>[D(y.$slots,"home-features-before",{},void 0,!0)]),"home-features-after":K(()=>[D(y.$slots,"home-features-after",{},void 0,!0)]),_:3})):L(m).layout&&L(m).layout!=="doc"?(N(),St(me(L(m).layout),{key:3})):(N(),St(kh,{key:4},{"doc-top":K(()=>[D(y.$slots,"doc-top",{},void 0,!0)]),"doc-bottom":K(()=>[D(y.$slots,"doc-bottom",{},void 0,!0)]),"doc-footer-before":K(()=>[D(y.$slots,"doc-footer-before",{},void 0,!0)]),"doc-before":K(()=>[D(y.$slots,"doc-before",{},void 0,!0)]),"doc-after":K(()=>[D(y.$slots,"doc-after",{},void 0,!0)]),"aside-top":K(()=>[D(y.$slots,"aside-top",{},void 0,!0)]),"aside-outline-before":K(()=>[D(y.$slots,"aside-outline-before",{},void 0,!0)]),"aside-outline-after":K(()=>[D(y.$slots,"aside-outline-after",{},void 0,!0)]),"aside-ads-before":K(()=>[D(y.$slots,"aside-ads-before",{},void 0,!0)]),"aside-ads-after":K(()=>[D(y.$slots,"aside-ads-after",{},void 0,!0)]),"aside-bottom":K(()=>[D(y.$slots,"aside-bottom",{},void 0,!0)]),_:3}))],2))}}),mr=Et(ur,[["__scopeId","data-v-18f63bde"]]),pr={class:"container"},dr=["innerHTML"],yr=["innerHTML"],vr=gt({__name:"VPFooter",setup(r){const{theme:h,frontmatter:m}=li(),{hasSidebar:v}=be();return(y,M)=>L(h).footer&&L(m).footer!==!1?(N(),A("footer",{key:0,class:di(["VPFooter",{"has-sidebar":L(v)}])},[U("div",pr,[L(h).footer.message?(N(),A("p",{key:0,class:"message",innerHTML:L(h).footer.message},null,8,dr)):bt("",!0),L(h).footer.copyright?(N(),A("p",{key:1,class:"copyright",innerHTML:L(h).footer.copyright},null,8,yr)):bt("",!0)])],2)):bt("",!0)}}),fr=Et(vr,[["__scopeId","data-v-7528d401"]]);function xr(){const{theme:r,frontmatter:h}=li(),m=zo([]),v=Jt(()=>m.value.length>0);return pn(()=>{m.value=Wn(h.value.outline??r.value.outline)}),{headers:m,hasLocalNav:v}}const br=r=>(As("data-v-c7be9e76"),r=r(),Os(),r),kr={class:"menu-text"},zr=br(()=>U("span",{class:"vpi-chevron-right icon"},null,-1)),gr={class:"header"},_r={class:"outline"},Nr=gt({__name:"VPLocalNavOutlineDropdown",props:{headers:{},navHeight:{}},setup(r){const h=r,{theme:m}=li(),v=ci(!1),y=ci(0),M=ci(),j=ci();function W(Ft){var At;(At=M.value)!=null&&At.contains(Ft.target)||(v.value=!1)}ie(v,Ft=>{if(Ft){document.addEventListener("click",W);return}document.removeEventListener("click",W)}),Go("Escape",()=>{v.value=!1}),pn(()=>{v.value=!1});function F(){v.value=!v.value,y.value=window.innerHeight+Math.min(window.scrollY-h.navHeight,0)}function _t(Ft){Ft.target.classList.contains("outline-link")&&(j.value&&(j.value.style.transition="none"),Yo(()=>{v.value=!1}))}function ii(){v.value=!1,window.scrollTo({top:0,left:0,behavior:"smooth"})}return(Ft,At)=>(N(),A("div",{class:"VPLocalNavOutlineDropdown",style:Rn({"--vp-vh":y.value+"px"}),ref_key:"main",ref:M},[Ft.headers.length>0?(N(),A("button",{key:0,onClick:F,class:di({open:v.value})},[U("span",kr,Si(L(Vo)(L(m))),1),zr],2)):(N(),A("button",{key:1,onClick:ii},Si(L(m).returnToTopLabel||"Return to top"),1)),Pt(un,{name:"flyout"},{default:K(()=>[v.value?(N(),A("div",{key:0,ref_key:"items",ref:j,class:"items",onClick:_t},[U("div",gr,[U("a",{class:"top-link",href:"#",onClick:ii},Si(L(m).returnToTopLabel||"Return to top"),1)]),U("div",_r,[Pt(Po,{headers:Ft.headers},null,8,["headers"])])],512)):bt("",!0)]),_:1})],4))}}),wr=Et(Nr,[["__scopeId","data-v-c7be9e76"]]),Lr=r=>(As("data-v-7d8f5dd9"),r=r(),Os(),r),Mr={class:"container"},Vr=["aria-expanded"],Pr=Lr(()=>U("span",{class:"vpi-align-left menu-icon"},null,-1)),Sr={class:"menu-text"},Ir=gt({__name:"VPLocalNav",props:{open:{type:Boolean}},emits:["open-menu"],setup(r){const{theme:h,frontmatter:m}=li(),{hasSidebar:v}=be(),{headers:y}=xr(),{y:M}=_o(),j=ci(0);_e(()=>{j.value=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--vp-nav-height"))}),pn(()=>{y.value=Wn(m.value.outline??h.value.outline)});const W=Jt(()=>y.value.length===0),F=Jt(()=>W.value&&!v.value),_t=Jt(()=>({VPLocalNav:!0,"has-sidebar":v.value,empty:W.value,fixed:F.value}));return(ii,Ft)=>L(m).layout!=="home"&&(!F.value||L(M)>=j.value)?(N(),A("div",{key:0,class:di(_t.value)},[U("div",Mr,[L(v)?(N(),A("button",{key:0,class:"menu","aria-expanded":ii.open,"aria-controls":"VPSidebarNav",onClick:Ft[0]||(Ft[0]=At=>ii.$emit("open-menu"))},[Pr,U("span",Sr,Si(L(h).sidebarMenuLabel||"Menu"),1)],8,Vr)):bt("",!0),Pt(wr,{headers:L(y),navHeight:j.value},null,8,["headers","navHeight"])])],2)):bt("",!0)}}),$r=Et(Ir,[["__scopeId","data-v-7d8f5dd9"]]);function Tr(){const r=ci(!1);function h(){r.value=!0,window.addEventListener("resize",y)}function m(){r.value=!1,window.removeEventListener("resize",y)}function v(){r.value?m():h()}function y(){window.outerWidth>=768&&m()}const M=dn();return ie(()=>M.path,m),{isScreenOpen:r,openScreen:h,closeScreen:m,toggleScreen:v}}const Cr={},Ar={class:"VPSwitch",type:"button",role:"switch"},Or={class:"check"},Dr={key:0,class:"icon"};function jr(r,h){return N(),A("button",Ar,[U("span",Or,[r.$slots.default?(N(),A("span",Dr,[D(r.$slots,"default",{},void 0,!0)])):bt("",!0)])])}const Br=Et(Cr,[["render",jr],["__scopeId","data-v-bd1ccbf1"]]),Io=r=>(As("data-v-0a9ef097"),r=r(),Os(),r),Er=Io(()=>U("span",{class:"vpi-sun sun"},null,-1)),Fr=Io(()=>U("span",{class:"vpi-moon moon"},null,-1)),Hr=gt({__name:"VPSwitchAppearance",setup(r){const{isDark:h,theme:m}=li(),v=yn("toggle-appearance",()=>{h.value=!h.value}),y=ci("");return Un(()=>{y.value=h.value?m.value.lightModeSwitchTitle||"Switch to light theme":m.value.darkModeSwitchTitle||"Switch to dark theme"}),(M,j)=>(N(),St(Br,{title:y.value,class:"VPSwitchAppearance","aria-checked":L(h),onClick:L(v)},{default:K(()=>[Er,Fr]),_:1},8,["title","aria-checked","onClick"]))}}),Jn=Et(Hr,[["__scopeId","data-v-0a9ef097"]]),Ur={key:0,class:"VPNavBarAppearance"},Rr=gt({__name:"VPNavBarAppearance",setup(r){const{site:h}=li();return(m,v)=>L(h).appearance&&L(h).appearance!=="force-dark"&&L(h).appearance!=="force-auto"?(N(),A("div",Ur,[Pt(Jn)])):bt("",!0)}}),qr=Et(Rr,[["__scopeId","data-v-fae4f2f4"]]),Zn=ci();let $o=!1,An=0;function Wr(r){const h=ci(!1);if(vn){!$o&&Jr(),An++;const m=ie(Zn,v=>{var y,M,j;v===r.el.value||(y=r.el.value)!=null&&y.contains(v)?(h.value=!0,(M=r.onFocus)==null||M.call(r)):(h.value=!1,(j=r.onBlur)==null||j.call(r))});Hn(()=>{m(),An--,An||Zr()})}return Xo(h)}function Jr(){document.addEventListener("focusin",To),$o=!0,Zn.value=document.activeElement}function Zr(){document.removeEventListener("focusin",To)}function To(){Zn.value=document.activeElement}const Kr={class:"VPMenuLink"},Gr=gt({__name:"VPMenuLink",props:{item:{}},setup(r){const{page:h}=li();return(m,v)=>(N(),A("div",Kr,[Pt(pe,{class:di({active:L(Ve)(L(h).relativePath,m.item.activeMatch||m.item.link,!!m.item.activeMatch)}),href:m.item.link,target:m.item.target,rel:m.item.rel},{default:K(()=>[xe(Si(m.item.text),1)]),_:1},8,["class","href","target","rel"])]))}}),fn=Et(Gr,[["__scopeId","data-v-cdceaf56"]]),Yr={class:"VPMenuGroup"},Xr={key:0,class:"title"},Qr=gt({__name:"VPMenuGroup",props:{text:{},items:{}},setup(r){return(h,m)=>(N(),A("div",Yr,[h.text?(N(),A("p",Xr,Si(h.text),1)):bt("",!0),(N(!0),A(qi,null,Us(h.items,v=>(N(),A(qi,null,["link"in v?(N(),St(fn,{key:0,item:v},null,8,["item"])):bt("",!0)],64))),256))]))}}),tl=Et(Qr,[["__scopeId","data-v-2551a641"]]),il={class:"VPMenu"},sl={key:0,class:"items"},el=gt({__name:"VPMenu",props:{items:{}},setup(r){return(h,m)=>(N(),A("div",il,[h.items?(N(),A("div",sl,[(N(!0),A(qi,null,Us(h.items,v=>(N(),A(qi,{key:JSON.stringify(v)},["link"in v?(N(),St(fn,{key:0,item:v},null,8,["item"])):"component"in v?(N(),St(me(v.component),No(ge({key:1},v.props)),null,16)):(N(),St(tl,{key:2,text:v.text,items:v.items},null,8,["text","items"]))],64))),128))])):bt("",!0),D(h.$slots,"default",{},void 0,!0)]))}}),nl=Et(el,[["__scopeId","data-v-8da9259e"]]),ol=r=>(As("data-v-c55c6200"),r=r(),Os(),r),al=["aria-expanded","aria-label"],hl={key:0,class:"text"},rl=["innerHTML"],ll=ol(()=>U("span",{class:"vpi-chevron-down text-icon"},null,-1)),cl={key:1,class:"vpi-more-horizontal icon"},ul={class:"menu"},ml=gt({__name:"VPFlyout",props:{icon:{},button:{},label:{},items:{}},setup(r){const h=ci(!1),m=ci();Wr({el:m,onBlur:v});function v(){h.value=!1}return(y,M)=>(N(),A("div",{class:"VPFlyout",ref_key:"el",ref:m,onMouseenter:M[1]||(M[1]=j=>h.value=!0),onMouseleave:M[2]||(M[2]=j=>h.value=!1)},[U("button",{type:"button",class:"button","aria-haspopup":"true","aria-expanded":h.value,"aria-label":y.label,onClick:M[0]||(M[0]=j=>h.value=!h.value)},[y.button||y.icon?(N(),A("span",hl,[y.icon?(N(),A("span",{key:0,class:di([y.icon,"option-icon"])},null,2)):bt("",!0),y.button?(N(),A("span",{key:1,innerHTML:y.button},null,8,rl)):bt("",!0),ll])):(N(),A("span",cl))],8,al),U("div",ul,[Pt(nl,{items:y.items},{default:K(()=>[D(y.$slots,"default",{},void 0,!0)]),_:3},8,["items"])])],544))}}),Kn=Et(ml,[["__scopeId","data-v-c55c6200"]]),pl=["href","aria-label","innerHTML"],dl=gt({__name:"VPSocialLink",props:{icon:{},link:{},ariaLabel:{}},setup(r){const h=r,m=Jt(()=>typeof h.icon=="object"?h.icon.svg:`<span class="vpi-social-${h.icon}" />`);return(v,y)=>(N(),A("a",{class:"VPSocialLink no-icon",href:v.link,"aria-label":v.ariaLabel??(typeof v.icon=="string"?v.icon:""),target:"_blank",rel:"noopener",innerHTML:m.value},null,8,pl))}}),yl=Et(dl,[["__scopeId","data-v-899e80f8"]]),vl={class:"VPSocialLinks"},fl=gt({__name:"VPSocialLinks",props:{links:{}},setup(r){return(h,m)=>(N(),A("div",vl,[(N(!0),A(qi,null,Us(h.links,({link:v,icon:y,ariaLabel:M})=>(N(),St(yl,{key:v,icon:y,link:v,ariaLabel:M},null,8,["icon","link","ariaLabel"]))),128))]))}}),Gn=Et(fl,[["__scopeId","data-v-aec6899b"]]),xl={key:0,class:"group translations"},bl={class:"trans-title"},kl={key:1,class:"group"},zl={class:"item appearance"},gl={class:"label"},_l={class:"appearance-action"},Nl={key:2,class:"group"},wl={class:"item social-links"},Ll=gt({__name:"VPNavBarExtra",setup(r){const{site:h,theme:m}=li(),{localeLinks:v,currentLang:y}=De({correspondingLink:!0}),M=Jt(()=>v.value.length&&y.value.label||h.value.appearance||m.value.socialLinks);return(j,W)=>M.value?(N(),St(Kn,{key:0,class:"VPNavBarExtra",label:"extra navigation"},{default:K(()=>[L(v).length&&L(y).label?(N(),A("div",xl,[U("p",bl,Si(L(y).label),1),(N(!0),A(qi,null,Us(L(v),F=>(N(),St(fn,{key:F.link,item:F},null,8,["item"]))),128))])):bt("",!0),L(h).appearance&&L(h).appearance!=="force-dark"&&L(h).appearance!=="force-auto"?(N(),A("div",kl,[U("div",zl,[U("p",gl,Si(L(m).darkModeSwitchLabel||"Appearance"),1),U("div",_l,[Pt(Jn)])])])):bt("",!0),L(m).socialLinks?(N(),A("div",Nl,[U("div",wl,[Pt(Gn,{class:"social-links-list",links:L(m).socialLinks},null,8,["links"])])])):bt("",!0)]),_:1})):bt("",!0)}}),Ml=Et(Ll,[["__scopeId","data-v-f6eb0a87"]]),Vl=r=>(As("data-v-8d5b6282"),r=r(),Os(),r),Pl=["aria-expanded"],Sl=Vl(()=>U("span",{class:"container"},[U("span",{class:"top"}),U("span",{class:"middle"}),U("span",{class:"bottom"})],-1)),Il=[Sl],$l=gt({__name:"VPNavBarHamburger",props:{active:{type:Boolean}},emits:["click"],setup(r){return(h,m)=>(N(),A("button",{type:"button",class:di(["VPNavBarHamburger",{active:h.active}]),"aria-label":"mobile navigation","aria-expanded":h.active,"aria-controls":"VPNavScreen",onClick:m[0]||(m[0]=v=>h.$emit("click"))},Il,10,Pl))}}),Tl=Et($l,[["__scopeId","data-v-8d5b6282"]]),Cl=["innerHTML"],Al=gt({__name:"VPNavBarMenuLink",props:{item:{}},setup(r){const{page:h}=li();return(m,v)=>(N(),St(pe,{class:di({VPNavBarMenuLink:!0,active:L(Ve)(L(h).relativePath,m.item.activeMatch||m.item.link,!!m.item.activeMatch)}),href:m.item.link,noIcon:m.item.noIcon,target:m.item.target,rel:m.item.rel,tabindex:"0"},{default:K(()=>[U("span",{innerHTML:m.item.text},null,8,Cl)]),_:1},8,["class","href","noIcon","target","rel"]))}}),Ol=Et(Al,[["__scopeId","data-v-c4466b3d"]]),Dl=gt({__name:"VPNavBarMenuGroup",props:{item:{}},setup(r){const h=r,{page:m}=li(),v=M=>"component"in M?!1:"link"in M?Ve(m.value.relativePath,M.link,!!h.item.activeMatch):M.items.some(v),y=Jt(()=>v(h.item));return(M,j)=>(N(),St(Kn,{class:di({VPNavBarMenuGroup:!0,active:L(Ve)(L(m).relativePath,M.item.activeMatch,!!M.item.activeMatch)||y.value}),button:M.item.text,items:M.item.items},null,8,["class","button","items"]))}}),jl=r=>(As("data-v-7c84bb69"),r=r(),Os(),r),Bl={key:0,"aria-labelledby":"main-nav-aria-label",class:"VPNavBarMenu"},El=jl(()=>U("span",{id:"main-nav-aria-label",class:"visually-hidden"}," Main Navigation ",-1)),Fl=gt({__name:"VPNavBarMenu",setup(r){const{theme:h}=li();return(m,v)=>L(h).nav?(N(),A("nav",Bl,[El,(N(!0),A(qi,null,Us(L(h).nav,y=>(N(),A(qi,{key:JSON.stringify(y)},["link"in y?(N(),St(Ol,{key:0,item:y},null,8,["item"])):"component"in y?(N(),St(me(y.component),No(ge({key:1},y.props)),null,16)):(N(),St(Dl,{key:2,item:y},null,8,["item"]))],64))),128))])):bt("",!0)}}),Hl=Et(Fl,[["__scopeId","data-v-7c84bb69"]]);function Ul(r){const{localeIndex:h,theme:m}=li();function v(y){var Li,Ei,yi;const M=y.split("."),j=(Li=m.value.search)==null?void 0:Li.options,W=j&&typeof j=="object",F=W&&((yi=(Ei=j.locales)==null?void 0:Ei[h.value])==null?void 0:yi.translations)||null,_t=W&&j.translations||null;let ii=F,Ft=_t,At=r;const Xt=M.pop();for(const Qs of M){let te=null;const de=At==null?void 0:At[Qs];de&&(te=At=de);const Se=Ft==null?void 0:Ft[Qs];Se&&(te=Ft=Se);const Ie=ii==null?void 0:ii[Qs];Ie&&(te=ii=Ie),de||(At=te),Se||(Ft=te),Ie||(ii=te)}return(ii==null?void 0:ii[Xt])??(Ft==null?void 0:Ft[Xt])??(At==null?void 0:At[Xt])??""}return v}const Rl=["aria-label"],ql={class:"DocSearch-Button-Container"},Wl=U("span",{class:"vp-icon DocSearch-Search-Icon"},null,-1),Jl={class:"DocSearch-Button-Placeholder"},Zl=U("span",{class:"DocSearch-Button-Keys"},[U("kbd",{class:"DocSearch-Button-Key"}),U("kbd",{class:"DocSearch-Button-Key"},"K")],-1),ko=gt({__name:"VPNavBarSearchButton",setup(r){const m=Ul({button:{buttonText:"Search",buttonAriaLabel:"Search"}});return(v,y)=>(N(),A("button",{type:"button",class:"DocSearch DocSearch-Button","aria-label":L(m)("button.buttonAriaLabel")},[U("span",ql,[Wl,U("span",Jl,Si(L(m)("button.buttonText")),1)]),Zl],8,Rl))}}),Kl={class:"VPNavBarSearch"},Gl={id:"local-search"},Yl={key:1,id:"docsearch"},Xl=gt({__name:"VPNavBarSearch",setup(r){const h=()=>null,m=()=>null,{theme:v}=li(),y=ci(!1),M=ci(!1);_e(()=>{});function j(){y.value||(y.value=!0,setTimeout(W,16))}function W(){const ii=new Event("keydown");ii.key="k",ii.metaKey=!0,window.dispatchEvent(ii),setTimeout(()=>{document.querySelector(".DocSearch-Modal")||W()},16)}const F=ci(!1),_t="";return(ii,Ft)=>{var At;return N(),A("div",Kl,[L(_t)==="local"?(N(),A(qi,{key:0},[F.value?(N(),St(L(h),{key:0,onClose:Ft[0]||(Ft[0]=Xt=>F.value=!1)})):bt("",!0),U("div",Gl,[Pt(ko,{onClick:Ft[1]||(Ft[1]=Xt=>F.value=!0)})])],64)):L(_t)==="algolia"?(N(),A(qi,{key:1},[y.value?(N(),St(L(m),{key:0,algolia:((At=L(v).search)==null?void 0:At.options)??L(v).algolia,onVnodeBeforeMount:Ft[2]||(Ft[2]=Xt=>M.value=!0)},null,8,["algolia"])):bt("",!0),M.value?bt("",!0):(N(),A("div",Yl,[Pt(ko,{onClick:j})]))],64)):bt("",!0)])}}}),Ql=gt({__name:"VPNavBarSocialLinks",setup(r){const{theme:h}=li();return(m,v)=>L(h).socialLinks?(N(),St(Gn,{key:0,class:"VPNavBarSocialLinks",links:L(h).socialLinks},null,8,["links"])):bt("",!0)}}),t1=Et(Ql,[["__scopeId","data-v-f191b639"]]),i1=["href","rel","target"],s1={key:1},e1={key:2},n1=gt({__name:"VPNavBarTitle",setup(r){const{site:h,theme:m}=li(),{hasSidebar:v}=be(),{currentLang:y}=De(),M=Jt(()=>{var F;return typeof m.value.logoLink=="string"?m.value.logoLink:(F=m.value.logoLink)==null?void 0:F.link}),j=Jt(()=>{var F;return typeof m.value.logoLink=="string"||(F=m.value.logoLink)==null?void 0:F.rel}),W=Jt(()=>{var F;return typeof m.value.logoLink=="string"||(F=m.value.logoLink)==null?void 0:F.target});return(F,_t)=>(N(),A("div",{class:di(["VPNavBarTitle",{"has-sidebar":L(v)}])},[U("a",{class:"title",href:M.value??L(qn)(L(y).link),rel:j.value,target:W.value},[D(F.$slots,"nav-bar-title-before",{},void 0,!0),L(m).logo?(N(),St(cn,{key:0,class:"logo",image:L(m).logo},null,8,["image"])):bt("",!0),L(m).siteTitle?(N(),A("span",s1,Si(L(m).siteTitle),1)):L(m).siteTitle===void 0?(N(),A("span",e1,Si(L(h).title),1)):bt("",!0),D(F.$slots,"nav-bar-title-after",{},void 0,!0)],8,i1)],2))}}),o1=Et(n1,[["__scopeId","data-v-2c2ef767"]]),a1={class:"items"},h1={class:"title"},r1=gt({__name:"VPNavBarTranslations",setup(r){const{theme:h}=li(),{localeLinks:m,currentLang:v}=De({correspondingLink:!0});return(y,M)=>L(m).length&&L(v).label?(N(),St(Kn,{key:0,class:"VPNavBarTranslations",icon:"vpi-languages",label:L(h).langMenuLabel||"Change language"},{default:K(()=>[U("div",a1,[U("p",h1,Si(L(v).label),1),(N(!0),A(qi,null,Us(L(m),j=>(N(),St(fn,{key:j.link,item:j},null,8,["item"]))),128))])]),_:1},8,["label"])):bt("",!0)}}),l1=Et(r1,[["__scopeId","data-v-992f960f"]]),c1=r=>(As("data-v-ce9a44a1"),r=r(),Os(),r),u1={class:"wrapper"},m1={class:"container"},p1={class:"title"},d1={class:"content"},y1={class:"content-body"},v1=c1(()=>U("div",{class:"divider"},[U("div",{class:"divider-line"})],-1)),f1=gt({__name:"VPNavBar",props:{isScreenOpen:{type:Boolean}},emits:["toggle-screen"],setup(r){const h=r,{y:m}=_o(),{hasSidebar:v}=be(),{frontmatter:y}=li(),M=ci({});return Un(()=>{M.value={"has-sidebar":v.value,home:y.value.layout==="home",top:m.value===0,"screen-open":h.isScreenOpen}}),(j,W)=>(N(),A("div",{class:di(["VPNavBar",M.value])},[U("div",u1,[U("div",m1,[U("div",p1,[Pt(o1,null,{"nav-bar-title-before":K(()=>[D(j.$slots,"nav-bar-title-before",{},void 0,!0)]),"nav-bar-title-after":K(()=>[D(j.$slots,"nav-bar-title-after",{},void 0,!0)]),_:3})]),U("div",d1,[U("div",y1,[D(j.$slots,"nav-bar-content-before",{},void 0,!0),Pt(Xl,{class:"search"}),Pt(Hl,{class:"menu"}),Pt(l1,{class:"translations"}),Pt(qr,{class:"appearance"}),Pt(t1,{class:"social-links"}),Pt(Ml,{class:"extra"}),D(j.$slots,"nav-bar-content-after",{},void 0,!0),Pt(Tl,{class:"hamburger",active:j.isScreenOpen,onClick:W[0]||(W[0]=F=>j.$emit("toggle-screen"))},null,8,["active"])])])])]),v1],2))}}),x1=Et(f1,[["__scopeId","data-v-ce9a44a1"]]),b1={key:0,class:"VPNavScreenAppearance"},k1={class:"text"},z1=gt({__name:"VPNavScreenAppearance",setup(r){const{site:h,theme:m}=li();return(v,y)=>L(h).appearance&&L(h).appearance!=="force-dark"&&L(h).appearance!=="force-auto"?(N(),A("div",b1,[U("p",k1,Si(L(m).darkModeSwitchLabel||"Appearance"),1),Pt(Jn)])):bt("",!0)}}),g1=Et(z1,[["__scopeId","data-v-8ffa58d0"]]),_1=gt({__name:"VPNavScreenMenuLink",props:{item:{}},setup(r){const h=yn("close-screen");return(m,v)=>(N(),St(pe,{class:"VPNavScreenMenuLink",href:m.item.link,target:m.item.target,rel:m.item.rel,onClick:L(h),innerHTML:m.item.text},null,8,["href","target","rel","onClick","innerHTML"]))}}),N1=Et(_1,[["__scopeId","data-v-feb69975"]]),w1=gt({__name:"VPNavScreenMenuGroupLink",props:{item:{}},setup(r){const h=yn("close-screen");return(m,v)=>(N(),St(pe,{class:"VPNavScreenMenuGroupLink",href:m.item.link,target:m.item.target,rel:m.item.rel,onClick:L(h)},{default:K(()=>[xe(Si(m.item.text),1)]),_:1},8,["href","target","rel","onClick"]))}}),Co=Et(w1,[["__scopeId","data-v-a7c463d0"]]),L1={class:"VPNavScreenMenuGroupSection"},M1={key:0,class:"title"},V1=gt({__name:"VPNavScreenMenuGroupSection",props:{text:{},items:{}},setup(r){return(h,m)=>(N(),A("div",L1,[h.text?(N(),A("p",M1,Si(h.text),1)):bt("",!0),(N(!0),A(qi,null,Us(h.items,v=>(N(),St(Co,{key:v.text,item:v},null,8,["item"]))),128))]))}}),P1=Et(V1,[["__scopeId","data-v-89af11f0"]]),S1=r=>(As("data-v-da30f6d4"),r=r(),Os(),r),I1=["aria-controls","aria-expanded"],$1=["innerHTML"],T1=S1(()=>U("span",{class:"vpi-plus button-icon"},null,-1)),C1=["id"],A1={key:0,class:"item"},O1={key:1,class:"item"},D1={key:2,class:"group"},j1=gt({__name:"VPNavScreenMenuGroup",props:{text:{},items:{}},setup(r){const h=r,m=ci(!1),v=Jt(()=>`NavScreenGroup-${h.text.replace(" ","-").toLowerCase()}`);function y(){m.value=!m.value}return(M,j)=>(N(),A("div",{class:di(["VPNavScreenMenuGroup",{open:m.value}])},[U("button",{class:"button","aria-controls":v.value,"aria-expanded":m.value,onClick:y},[U("span",{class:"button-text",innerHTML:M.text},null,8,$1),T1],8,I1),U("div",{id:v.value,class:"items"},[(N(!0),A(qi,null,Us(M.items,W=>(N(),A(qi,{key:JSON.stringify(W)},["link"in W?(N(),A("div",A1,[Pt(Co,{item:W},null,8,["item"])])):"component"in W?(N(),A("div",O1,[(N(),St(me(W.component),ge(W.props,{"screen-menu":""}),null,16))])):(N(),A("div",D1,[Pt(P1,{items:W.items},null,8,["items"])]))],64))),128))],8,C1)],2))}}),B1=Et(j1,[["__scopeId","data-v-da30f6d4"]]),E1={key:0,class:"VPNavScreenMenu"},F1=gt({__name:"VPNavScreenMenu",setup(r){const{theme:h}=li();return(m,v)=>L(h).nav?(N(),A("nav",E1,[(N(!0),A(qi,null,Us(L(h).nav,y=>(N(),A(qi,{key:JSON.stringify(y)},["link"in y?(N(),St(N1,{key:0,item:y},null,8,["item"])):"component"in y?(N(),St(me(y.component),ge({key:1},y.props,{"screen-menu":""}),null,16)):(N(),St(B1,{key:2,text:y.text||"",items:y.items},null,8,["text","items"]))],64))),128))])):bt("",!0)}}),H1=gt({__name:"VPNavScreenSocialLinks",setup(r){const{theme:h}=li();return(m,v)=>L(h).socialLinks?(N(),St(Gn,{key:0,class:"VPNavScreenSocialLinks",links:L(h).socialLinks},null,8,["links"])):bt("",!0)}}),Ao=r=>(As("data-v-57dba0d7"),r=r(),Os(),r),U1=Ao(()=>U("span",{class:"vpi-languages icon lang"},null,-1)),R1=Ao(()=>U("span",{class:"vpi-chevron-down icon chevron"},null,-1)),q1={class:"list"},W1=gt({__name:"VPNavScreenTranslations",setup(r){const{localeLinks:h,currentLang:m}=De({correspondingLink:!0}),v=ci(!1);function y(){v.value=!v.value}return(M,j)=>L(h).length&&L(m).label?(N(),A("div",{key:0,class:di(["VPNavScreenTranslations",{open:v.value}])},[U("button",{class:"title",onClick:y},[U1,xe(" "+Si(L(m).label)+" ",1),R1]),U("ul",q1,[(N(!0),A(qi,null,Us(L(h),W=>(N(),A("li",{key:W.link,class:"item"},[Pt(pe,{class:"link",href:W.link},{default:K(()=>[xe(Si(W.text),1)]),_:2},1032,["href"])]))),128))])],2)):bt("",!0)}}),J1=Et(W1,[["__scopeId","data-v-57dba0d7"]]),Z1={class:"container"},K1=gt({__name:"VPNavScreen",props:{open:{type:Boolean}},setup(r){const h=ci(null),m=wo(vn?document.body:null);return(v,y)=>(N(),St(un,{name:"fade",onEnter:y[0]||(y[0]=M=>m.value=!0),onAfterLeave:y[1]||(y[1]=M=>m.value=!1)},{default:K(()=>[v.open?(N(),A("div",{key:0,class:"VPNavScreen",ref_key:"screen",ref:h,id:"VPNavScreen"},[U("div",Z1,[D(v.$slots,"nav-screen-content-before",{},void 0,!0),Pt(F1,{class:"menu"}),Pt(J1,{class:"translations"}),Pt(g1,{class:"appearance"}),Pt(H1,{class:"social-links"}),D(v.$slots,"nav-screen-content-after",{},void 0,!0)])],512)):bt("",!0)]),_:3}))}}),G1=Et(K1,[["__scopeId","data-v-72e6f365"]]),Y1={key:0,class:"VPNav"},X1=gt({__name:"VPNav",setup(r){const{isScreenOpen:h,closeScreen:m,toggleScreen:v}=Tr(),{frontmatter:y}=li(),M=Jt(()=>y.value.navbar!==!1);return Lo("close-screen",m),mn(()=>{vn&&document.documentElement.classList.toggle("hide-nav",!M.value)}),(j,W)=>M.value?(N(),A("header",Y1,[Pt(x1,{"is-screen-open":L(h),onToggleScreen:L(v)},{"nav-bar-title-before":K(()=>[D(j.$slots,"nav-bar-title-before",{},void 0,!0)]),"nav-bar-title-after":K(()=>[D(j.$slots,"nav-bar-title-after",{},void 0,!0)]),"nav-bar-content-before":K(()=>[D(j.$slots,"nav-bar-content-before",{},void 0,!0)]),"nav-bar-content-after":K(()=>[D(j.$slots,"nav-bar-content-after",{},void 0,!0)]),_:3},8,["is-screen-open","onToggleScreen"]),Pt(G1,{open:L(h)},{"nav-screen-content-before":K(()=>[D(j.$slots,"nav-screen-content-before",{},void 0,!0)]),"nav-screen-content-after":K(()=>[D(j.$slots,"nav-screen-content-after",{},void 0,!0)]),_:3},8,["open"])])):bt("",!0)}}),Q1=Et(X1,[["__scopeId","data-v-7e1e9564"]]),Oo=r=>(As("data-v-5f73c6e2"),r=r(),Os(),r),tc=["role","tabindex"],ic=Oo(()=>U("div",{class:"indicator"},null,-1)),sc=["onKeydown"],ec=Oo(()=>U("span",{class:"vpi-chevron-right caret-icon"},null,-1)),nc=[ec],oc={key:1,class:"items"},ac=gt({__name:"VPSidebarItem",props:{item:{},depth:{}},setup(r){const h=r,{collapsed:m,collapsible:v,isLink:y,isActiveLink:M,hasActiveLink:j,hasChildren:W,toggle:F}=Na(Jt(()=>h.item)),_t=Jt(()=>W.value?"section":"div"),ii=Jt(()=>y.value?"a":"div"),Ft=Jt(()=>W.value?h.depth+2===7?"p":`h${h.depth+2}`:"p"),At=Jt(()=>y.value?void 0:"button"),Xt=Jt(()=>[[`level-${h.depth}`],{collapsible:v.value},{collapsed:m.value},{"is-link":y.value},{"is-active":M.value},{"has-active":j.value}]);function Li(yi){"key"in yi&&yi.key!=="Enter"||!h.item.link&&F()}function Ei(){h.item.link&&F()}return(yi,Qs)=>{const te=Pe("VPSidebarItem",!0);return N(),St(me(_t.value),{class:di(["VPSidebarItem",Xt.value])},{default:K(()=>[yi.item.text?(N(),A("div",ge({key:0,class:"item",role:At.value},Qo(yi.item.items?{click:Li,keydown:Li}:{},!0),{tabindex:yi.item.items&&0}),[ic,yi.item.link?(N(),St(pe,{key:0,tag:ii.value,class:"link",href:yi.item.link,rel:yi.item.rel,target:yi.item.target},{default:K(()=>[(N(),St(me(Ft.value),{class:"text",innerHTML:yi.item.text},null,8,["innerHTML"]))]),_:1},8,["tag","href","rel","target"])):(N(),St(me(Ft.value),{key:1,class:"text",innerHTML:yi.item.text},null,8,["innerHTML"])),yi.item.collapsed!=null&&yi.item.items&&yi.item.items.length?(N(),A("div",{key:2,class:"caret",role:"button","aria-label":"toggle section",onClick:Ei,onKeydown:ta(Ei,["enter"]),tabindex:"0"},nc,40,sc)):bt("",!0)],16,tc)):bt("",!0),yi.item.items&&yi.item.items.length?(N(),A("div",oc,[yi.depth<5?(N(!0),A(qi,{key:0},Us(yi.item.items,de=>(N(),St(te,{key:de.text,item:de,depth:yi.depth+1},null,8,["item","depth"]))),128)):bt("",!0)])):bt("",!0)]),_:1},8,["class"])}}}),hc=Et(ac,[["__scopeId","data-v-5f73c6e2"]]),rc=gt({__name:"VPSidebarGroup",props:{items:{}},setup(r){const h=ci(!0);let m=null;return _e(()=>{m=setTimeout(()=>{m=null,h.value=!1},300)}),ia(()=>{m!=null&&(clearTimeout(m),m=null)}),(v,y)=>(N(!0),A(qi,null,Us(v.items,M=>(N(),A("div",{key:M.text,class:di(["group",{"no-transition":h.value}])},[Pt(hc,{item:M,depth:0},null,8,["item"])],2))),128))}}),lc=Et(rc,[["__scopeId","data-v-769547d6"]]),Do=r=>(As("data-v-0d526d28"),r=r(),Os(),r),cc=Do(()=>U("div",{class:"curtain"},null,-1)),uc={class:"nav",id:"VPSidebarNav","aria-labelledby":"sidebar-aria-label",tabindex:"-1"},mc=Do(()=>U("span",{class:"visually-hidden",id:"sidebar-aria-label"}," Sidebar Navigation ",-1)),pc=gt({__name:"VPSidebar",props:{open:{type:Boolean}},setup(r){const h=r,{sidebarGroups:m,hasSidebar:v}=be(),y=ci(null),M=wo(vn?document.body:null);ie([h,y],()=>{var W;h.open?(M.value=!0,(W=y.value)==null||W.focus()):M.value=!1},{immediate:!0,flush:"post"});const j=ci(0);return ie(m,()=>{j.value+=1},{deep:!0}),(W,F)=>L(v)?(N(),A("aside",{key:0,class:di(["VPSidebar",{open:W.open}]),ref_key:"navEl",ref:y,onClick:F[0]||(F[0]=sa(()=>{},["stop"]))},[cc,U("nav",uc,[mc,D(W.$slots,"sidebar-nav-before",{},void 0,!0),(N(),St(lc,{items:L(m),key:j.value},null,8,["items"])),D(W.$slots,"sidebar-nav-after",{},void 0,!0)])],2)):bt("",!0)}}),dc=Et(pc,[["__scopeId","data-v-0d526d28"]]),yc=gt({__name:"VPSkipLink",setup(r){const h=dn(),m=ci();ie(()=>h.path,()=>m.value.focus());function v({target:y}){const M=document.getElementById(decodeURIComponent(y.hash).slice(1));if(M){const j=()=>{M.removeAttribute("tabindex"),M.removeEventListener("blur",j)};M.setAttribute("tabindex","-1"),M.addEventListener("blur",j),M.focus(),window.scrollTo(0,0)}}return(y,M)=>(N(),A(qi,null,[U("span",{ref_key:"backToTop",ref:m,tabindex:"-1"},null,512),U("a",{href:"#VPContent",class:"VPSkipLink visually-hidden",onClick:v}," Skip to content ")],64))}}),vc=Et(yc,[["__scopeId","data-v-e1874081"]]),fc=gt({__name:"Layout",setup(r){const{isOpen:h,open:m,close:v}=be(),y=dn();ie(()=>y.path,v),_a(h,v);const{frontmatter:M}=li(),j=ea(),W=Jt(()=>!!j["home-hero-image"]);return Lo("hero-image-slot-exists",W),(F,_t)=>{const ii=Pe("Content");return L(M).layout!==!1?(N(),A("div",{key:0,class:di(["Layout",L(M).pageClass])},[D(F.$slots,"layout-top",{},void 0,!0),Pt(vc),Pt(ra,{class:"backdrop",show:L(h),onClick:L(v)},null,8,["show","onClick"]),Pt(Q1,null,{"nav-bar-title-before":K(()=>[D(F.$slots,"nav-bar-title-before",{},void 0,!0)]),"nav-bar-title-after":K(()=>[D(F.$slots,"nav-bar-title-after",{},void 0,!0)]),"nav-bar-content-before":K(()=>[D(F.$slots,"nav-bar-content-before",{},void 0,!0)]),"nav-bar-content-after":K(()=>[D(F.$slots,"nav-bar-content-after",{},void 0,!0)]),"nav-screen-content-before":K(()=>[D(F.$slots,"nav-screen-content-before",{},void 0,!0)]),"nav-screen-content-after":K(()=>[D(F.$slots,"nav-screen-content-after",{},void 0,!0)]),_:3}),Pt($r,{open:L(h),onOpenMenu:L(m)},null,8,["open","onOpenMenu"]),Pt(dc,{open:L(h)},{"sidebar-nav-before":K(()=>[D(F.$slots,"sidebar-nav-before",{},void 0,!0)]),"sidebar-nav-after":K(()=>[D(F.$slots,"sidebar-nav-after",{},void 0,!0)]),_:3},8,["open"]),Pt(mr,null,{"page-top":K(()=>[D(F.$slots,"page-top",{},void 0,!0)]),"page-bottom":K(()=>[D(F.$slots,"page-bottom",{},void 0,!0)]),"not-found":K(()=>[D(F.$slots,"not-found",{},void 0,!0)]),"home-hero-before":K(()=>[D(F.$slots,"home-hero-before",{},void 0,!0)]),"home-hero-info-before":K(()=>[D(F.$slots,"home-hero-info-before",{},void 0,!0)]),"home-hero-info":K(()=>[D(F.$slots,"home-hero-info",{},void 0,!0)]),"home-hero-info-after":K(()=>[D(F.$slots,"home-hero-info-after",{},void 0,!0)]),"home-hero-actions-after":K(()=>[D(F.$slots,"home-hero-actions-after",{},void 0,!0)]),"home-hero-image":K(()=>[D(F.$slots,"home-hero-image",{},void 0,!0)]),"home-hero-after":K(()=>[D(F.$slots,"home-hero-after",{},void 0,!0)]),"home-features-before":K(()=>[D(F.$slots,"home-features-before",{},void 0,!0)]),"home-features-after":K(()=>[D(F.$slots,"home-features-after",{},void 0,!0)]),"doc-footer-before":K(()=>[D(F.$slots,"doc-footer-before",{},void 0,!0)]),"doc-before":K(()=>[D(F.$slots,"doc-before",{},void 0,!0)]),"doc-after":K(()=>[D(F.$slots,"doc-after",{},void 0,!0)]),"doc-top":K(()=>[D(F.$slots,"doc-top",{},void 0,!0)]),"doc-bottom":K(()=>[D(F.$slots,"doc-bottom",{},void 0,!0)]),"aside-top":K(()=>[D(F.$slots,"aside-top",{},void 0,!0)]),"aside-bottom":K(()=>[D(F.$slots,"aside-bottom",{},void 0,!0)]),"aside-outline-before":K(()=>[D(F.$slots,"aside-outline-before",{},void 0,!0)]),"aside-outline-after":K(()=>[D(F.$slots,"aside-outline-after",{},void 0,!0)]),"aside-ads-before":K(()=>[D(F.$slots,"aside-ads-before",{},void 0,!0)]),"aside-ads-after":K(()=>[D(F.$slots,"aside-ads-after",{},void 0,!0)]),_:3}),Pt(fr),D(F.$slots,"layout-bottom",{},void 0,!0)],2)):(N(),St(ii,{key:1}))}}}),xc=Et(fc,[["__scopeId","data-v-f7190ae6"]]),bc={Layout:xc,enhanceApp:({app:r})=>{r.component("Badge",oa)}},xn=(r,h)=>{const m=r.__vccOpts||r;for(const[v,y]of h)m[v]=y;return m},kc={},zc={t:"1661231422733",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3259",width:"20",height:"20"},gc=U("path",{d:"M682.666667 810.666667c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733334l226.133333-226.133333-226.133333-226.133333c-17.066667-17.066667-17.066667-42.666667 0-59.733334s42.666667-17.066667 59.733333 0l256 256c17.066667 17.066667 17.066667 42.666667 0 59.733334l-256 256c-8.533333 8.533333-17.066667 12.8-29.866666 12.8zM341.333333 810.666667c-12.8 0-21.333333-4.266667-29.866666-12.8l-256-256c-17.066667-17.066667-17.066667-42.666667 0-59.733334l256-256c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733334L145.066667 512l226.133333 226.133333c17.066667 17.066667 17.066667 42.666667 0 59.733334-8.533333 8.533333-17.066667 12.8-29.866667 12.8z","p-id":"3260"},null,-1),_c=[gc];function Nc(r,h){return N(),A("svg",zc,_c)}const wc=xn(kc,[["render",Nc]]),Lc={},Mc={t:"1661231449868",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3541",width:"20",height:"20"},Vc=U("path",{d:"M305.6 225.6c-17.6-17.6-43.2-17.6-59.2 0L19.2 460.8c-25.6 30.4-25.6 72 0 97.6l225.6 235.2c8 8 20.8 12.8 30.4 12.8s20.8-4.8 30.4-12.8c17.6-17.6 17.6-43.2 0-59.2L88 512l217.6-225.6c17.6-17.6 17.6-43.2 0-60.8zM1001.6 460.8L774.4 225.6c-17.6-17.6-43.2-17.6-59.2 0s-17.6 43.2 0 59.2L932.8 512 715.2 737.6c-17.6 17.6-17.6 43.2 0 59.2 8 8 17.6 12.8 30.4 12.8 12.8 0 20.8-4.8 30.4-12.8l225.6-235.2c28.8-28.8 28.8-70.4 0-100.8zM612.8 230.4c-20.8-8-46.4 4.8-56 25.6L382.4 742.4c-8 20.8 4.8 46.4 25.6 56 4.8 0 8 4.8 12.8 4.8 17.6 0 33.6-12.8 38.4-30.4l179.2-491.2c8-20.8-4.8-46.4-25.6-51.2z","p-id":"3542"},null,-1),Pc=[Vc];function Sc(r,h){return N(),A("svg",Mc,Pc)}const Ic=xn(Lc,[["render",Sc]]),$c={},Tc={viewBox:"0 0 544 560",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Cc=U("path",{d:"M399.503 143.667C399.319 152.501 406.332 159.812 415.167 159.997C424.001 160.181 431.312 153.168 431.497 144.333L399.503 143.667ZM416 120L431.997 120.333C431.999 120.207 432 120.081 432 119.954L416 120ZM360 64L360.046 48.0001C360.03 48 360.015 48 360 48L360 64ZM144 64V48C143.984 48 143.968 48 143.953 48.0001L144 64ZM80 128L64.0001 127.953C64 127.968 64 127.984 64 128L80 128ZM80 344H64C64 344.015 64 344.03 64.0001 344.046L80 344ZM136 400L135.954 416C135.97 416 135.985 416 136 416L136 400ZM160 416C168.837 416 176 408.837 176 400C176 391.163 168.837 384 160 384V416ZM217 160H439V128H217V160ZM439 160C461.644 160 480 178.356 480 201H512C512 160.683 479.317 128 439 128V160ZM480 201V423H512V201H480ZM480 423C480 445.644 461.644 464 439 464V496C479.317 496 512 463.317 512 423H480ZM439 464H217V496H439V464ZM217 464C194.356 464 176 445.644 176 423H144C144 463.317 176.683 496 217 496V464ZM176 423V201H144V423H176ZM176 201C176 178.356 194.356 160 217 160V128C176.683 128 144 160.683 144 201H176ZM431.497 144.333L431.997 120.333L400.003 119.667L399.503 143.667L431.497 144.333ZM432 119.954C431.946 100.888 424.347 82.6173 410.865 69.1349L388.238 91.7624C395.741 99.2658 399.97 109.434 400 120.046L432 119.954ZM410.865 69.1349C397.383 55.6526 379.112 48.0543 360.046 48.0001L359.954 79.9999C370.566 80.0301 380.734 84.2589 388.238 91.7624L410.865 69.1349ZM360 48H144V80H360V48ZM143.953 48.0001C122.767 48.0627 102.467 56.5064 87.4868 71.4868L110.114 94.1142C119.117 85.1118 131.316 80.0376 144.047 79.9999L143.953 48.0001ZM87.4868 71.4868C72.5064 86.4673 64.0627 106.767 64.0001 127.953L95.9999 128.047C96.0376 115.316 101.112 103.117 110.114 94.1142L87.4868 71.4868ZM64 128V344H96V128H64ZM64.0001 344.046C64.0543 363.112 71.6526 381.383 85.1349 394.865L107.762 372.238C100.259 364.734 96.0301 354.566 95.9999 343.954L64.0001 344.046ZM85.1349 394.865C98.6173 408.347 116.888 415.946 135.954 416L136.046 384C125.434 383.97 115.266 379.741 107.762 372.238L85.1349 394.865ZM136 416H160V384H136V416Z",fill:"currentColor"},null,-1),Ac=[Cc];function Oc(r,h){return N(),A("svg",Tc,Ac)}const Dc=xn($c,[["render",Oc]]),hn="vitepress-demo-preview",rn=(r,h,m,v)=>{let y=h===""?`${r}`:`${r}-${h}`;return m&&(y+=`__${m}`),v&&(y+=`--${v}`),y},jo=(r="")=>({b:()=>rn(hn,r),e:(h="")=>rn(hn,r,h),m:(h="")=>rn(hn,r,"",h),bem:(h,m,v)=>rn(hn,h,m,v)}),jc=()=>{const r=ci(!0);return{isCodeFold:r,setCodeFold:h=>{r.value=h}}},Bc=()=>({copyContent:ci(""),clickCopy:async r=>{await navigator.clipboard.writeText(r)}}),Ec={},Fc={width:"20",height:"20",viewBox:"0 0 48 48",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},Hc=U("path",{d:"M24 4L29.2533 7.83204L35.7557 7.81966L37.7533 14.0077L43.0211 17.8197L41 24L43.0211 30.1803L37.7533 33.9923L35.7557 40.1803L29.2533 40.168L24 44L18.7467 40.168L12.2443 40.1803L10.2467 33.9923L4.97887 30.1803L7 24L4.97887 17.8197L10.2467 14.0077L12.2443 7.81966L18.7467 7.83204L24 4Z",fill:"currentColor",stroke:"#333","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Uc=U("path",{d:"M17 24L22 29L32 19",fill:"currentColor",stroke:"#333","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Rc=[Hc,Uc];function qc(r,h){return N(),A("svg",Fc,Rc)}const Wc=xn(Ec,[["render",qc]]),Jc=gt({__name:"message-notice",props:{content:{default:""},close:null},setup(r,{expose:h}){const m=r,v=jo(),y=ci(!1),M=_t=>{y.value=_t},j=ci(-999),W=_t=>{j.value=_t};ie(y,_t=>{_t===!0&&setTimeout(()=>{y.value=!1},3e3)});const F=()=>{m.close()};return h({setVisible:M,setTopHeight:W}),(_t,ii)=>(N(),St(un,{name:"slide-fade",onAfterLeave:F},{default:K(()=>[y.value?(N(),A("div",{key:0,class:di([L(v).bem("message-notice","container")]),style:Rn({top:j.value+"px"})},[Pt(Wc),U("span",null,Si(r.content),1)],6)):bt("",!0)]),_:1}))}}),On=[],Zc={open:()=>{const r=document.createElement("div"),h=na(Jc,{content:"",close:()=>{document.body.removeChild(r),On.pop(),h.unmount()}}),m=h.mount(r);document.body.appendChild(r);const v=On.length,y=v===0?10:(v+1)*10+v*42;m.setTopHeight(y),m.setVisible(!0),On.push(m)}},Kc=["innerHTML"],Gc=gt({__name:"ElementPlus",props:{code:null,showCode:null,title:{default:""},description:{default:""}},setup(r){const h=r,m=jo(),{isCodeFold:v,setCodeFold:y}=jc(),{clickCopy:M}=Bc(),j=ci(decodeURIComponent(h.code)),W=ci(decodeURIComponent(h.showCode)),F=ci(null),_t=()=>{M(j.value),Zc.open()},ii=Jt(()=>{var At;return F.value?(At=F.value)==null?void 0:At.clientHeight:0}),Ft=At=>{v.value?F.value.style.height="0px":F.value.style.height=`${At}px`};return _e(()=>{const At=ii.value;Ft(At)}),ie(v,()=>{const At=ii.value;Ft(At)}),(At,Xt)=>(N(),A("div",{class:di([L(m).e("element-plus__container")])},[U("section",{class:di([L(m).bem("preview")])},[D(At.$slots,"default")],2),U("section",{class:di([L(m).bem("description")])},[U("div",{class:di([L(m).bem("description","split-line")])},null,2),U("div",{class:di([L(m).bem("description","handle-btn")])},[L(v)?(N(),St(wc,{key:1,onClick:Xt[1]||(Xt[1]=Li=>L(y)(!1))})):(N(),St(Ic,{key:0,onClick:Xt[0]||(Xt[0]=Li=>L(y)(!0))})),Pt(Dc,{onClick:_t})],2)],2),U("section",{class:di([L(m).bem("source")]),ref_key:"sourceCodeArea",ref:F},[U("div",{innerHTML:W.value,class:"language-vue"},null,8,Kc)],2)],2))}});(function(r,h){typeof exports=="object"&&typeof module<"u"?h(exports):typeof define=="function"&&define.amd?define(["exports"],h):h((r=r||(typeof window<"u"?window:global)).OIMO={})})(void 0,function(r){Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Math.sign===void 0&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),Function.prototype.name===void 0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&(Object.assign=function(t){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),e=1;e<arguments.length;e++){var n=arguments[e];if(n!=null)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(s[o]=n[o])}return s});var h,m,v,y,M="1.0.9",j=0,W=1,F=2,_t=3,ii=0,Ft=0,At=1,Xt=2,Li=3,Ei=4,yi=5,Qs=0,te=1,de=2,Se=3,Ie=4,Yn=5,Xn=6,T={sqrt:Math.sqrt,abs:Math.abs,floor:Math.floor,cos:Math.cos,sin:Math.sin,acos:Math.acos,asin:Math.asin,atan2:Math.atan2,round:Math.round,pow:Math.pow,max:Math.max,min:Math.min,random:Math.random,degtorad:.017453292519943295,radtodeg:57.29577951308232,PI:3.141592653589793,TwoPI:6.283185307179586,PI90:1.570796326794896,PI270:4.712388980384689,INF:1/0,EPZ:1e-5,EPZ2:1e-6,lerp:function(t,s,e){return(1-e)*t+e*s},randInt:function(t,s){return t+T.floor(T.random()*(s-t+1))},rand:function(t,s){return t+T.random()*(s-t)},generateUUID:(m="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),v=new Array(36),y=0,function(){for(var t=0;t<36;t++)t===8||t===13||t===18||t===23?v[t]="-":t===14?v[t]="4":(y<=2&&(y=33554432+16777216*Math.random()|0),h=15&y,y>>=4,v[t]=m[t===19?3&h|8:h]);return v.join("")}),int:function(t){return T.floor(t)},fix:function(t,s){return t.toFixed(s||3,10)},clamp:function(t,s,e){return T.max(s,T.min(e,t))},distance:function(t,s){var e=s[0]-t[0],n=s[1]-t[1],o=s[2]-t[2];return T.sqrt(e*e+n*n+o*o)},acosClamp:function(t){return t>1?0:t<-1?T.PI:T.acos(t)},distanceVector:function(t,s){var e=t.x-s.x,n=t.y-s.y,o=t.z-s.z;return e*e+n*n+o*o},dotVectors:function(t,s){return t.x*s.x+t.y*s.y+t.z*s.z}};function bs(t,s){console.error("[OIMO] "+t+": "+s)}function bn(t){this.parent=t,this.infos=new Float32Array(13),this.f=[0,0,0],this.times=[0,0,0,0],this.broadPhase=this.parent.broadPhaseType,this.version=M,this.fps=0,this.tt=0,this.broadPhaseTime=0,this.narrowPhaseTime=0,this.solvingTime=0,this.totalTime=0,this.updateTime=0,this.MaxBroadPhaseTime=0,this.MaxNarrowPhaseTime=0,this.MaxSolvingTime=0,this.MaxTotalTime=0,this.MaxUpdateTime=0}function $(t,s,e){this.x=t||0,this.y=s||0,this.z=e||0}function ks(t,s,e,n){this.x=t||0,this.y=s||0,this.z=e||0,this.w=n!==void 0?n:1}function xs(t,s,e,n,o,a,l,d,u){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("OIMO.Mat33: the constructor no longer reads arguments. use .set() instead.")}function je(t,s,e,n,o,a){this.elements=new Float32Array(6);var l=this.elements;l[0]=t||0,l[1]=e||0,l[2]=o||0,l[3]=s||0,l[4]=n||0,l[5]=a||0}Object.assign(bn.prototype,{setTime:function(t){this.times[t||0]=performance.now()},resetMax:function(){this.MaxBroadPhaseTime=0,this.MaxNarrowPhaseTime=0,this.MaxSolvingTime=0,this.MaxTotalTime=0,this.MaxUpdateTime=0},calcBroadPhase:function(){this.setTime(2),this.broadPhaseTime=this.times[2]-this.times[1]},calcNarrowPhase:function(){this.setTime(3),this.narrowPhaseTime=this.times[3]-this.times[2]},calcEnd:function(){this.setTime(2),this.solvingTime=this.times[2]-this.times[1],this.totalTime=this.times[2]-this.times[0],this.updateTime=this.totalTime-(this.broadPhaseTime+this.narrowPhaseTime+this.solvingTime),this.tt===100&&this.resetMax(),this.tt>100&&(this.broadPhaseTime>this.MaxBroadPhaseTime&&(this.MaxBroadPhaseTime=this.broadPhaseTime),this.narrowPhaseTime>this.MaxNarrowPhaseTime&&(this.MaxNarrowPhaseTime=this.narrowPhaseTime),this.solvingTime>this.MaxSolvingTime&&(this.MaxSolvingTime=this.solvingTime),this.totalTime>this.MaxTotalTime&&(this.MaxTotalTime=this.totalTime),this.updateTime>this.MaxUpdateTime&&(this.MaxUpdateTime=this.updateTime)),this.upfps(),this.tt++,this.tt>500&&(this.tt=0)},upfps:function(){this.f[1]=Date.now(),this.f[1]-1e3>this.f[0]&&(this.f[0]=this.f[1],this.fps=this.f[2],this.f[2]=0),this.f[2]++},show:function(){return["Oimo.js "+this.version+"<br>",this.broadPhase+"<br><br>","FPS: "+this.fps+" fps<br><br>","rigidbody "+this.parent.numRigidBodies+"<br>","contact &nbsp;&nbsp;"+this.parent.numContacts+"<br>","ct-point &nbsp;"+this.parent.numContactPoints+"<br>","paircheck "+this.parent.broadPhase.numPairChecks+"<br>","island &nbsp;&nbsp;&nbsp;"+this.parent.numIslands+"<br><br>","Time in milliseconds<br><br>","broadphase &nbsp;"+T.fix(this.broadPhaseTime)+" | "+T.fix(this.MaxBroadPhaseTime)+"<br>","narrowphase "+T.fix(this.narrowPhaseTime)+" | "+T.fix(this.MaxNarrowPhaseTime)+"<br>","solving &nbsp;&nbsp;&nbsp;&nbsp;"+T.fix(this.solvingTime)+" | "+T.fix(this.MaxSolvingTime)+"<br>","total &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+T.fix(this.totalTime)+" | "+T.fix(this.MaxTotalTime)+"<br>","updating &nbsp;&nbsp;&nbsp;"+T.fix(this.updateTime)+" | "+T.fix(this.MaxUpdateTime)+"<br>"].join(`
`)},toArray:function(){return this.infos[0]=this.parent.broadPhase.types,this.infos[1]=this.parent.numRigidBodies,this.infos[2]=this.parent.numContacts,this.infos[3]=this.parent.broadPhase.numPairChecks,this.infos[4]=this.parent.numContactPoints,this.infos[5]=this.parent.numIslands,this.infos[6]=this.broadPhaseTime,this.infos[7]=this.narrowPhaseTime,this.infos[8]=this.solvingTime,this.infos[9]=this.updateTime,this.infos[10]=this.totalTime,this.infos[11]=this.fps,this.infos}}),Object.assign($.prototype,{Vec3:!0,set:function(t,s,e){return this.x=t,this.y=s,this.z=e,this},add:function(t,s){return s!==void 0?this.addVectors(t,s):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addVectors:function(t,s){return this.x=t.x+s.x,this.y=t.y+s.y,this.z=t.z+s.z,this},addEqual:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},sub:function(t,s){return s!==void 0?this.subVectors(t,s):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subVectors:function(t,s){return this.x=t.x-s.x,this.y=t.y-s.y,this.z=t.z-s.z,this},subEqual:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},scale:function(t,s){return this.x=t.x*s,this.y=t.y*s,this.z=t.z*s,this},scaleEqual:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},addScaledVector:function(t,s){return this.x+=t.x*s,this.y+=t.y*s,this.z+=t.z*s,this},subScaledVector:function(t,s){return this.x-=t.x*s,this.y-=t.y*s,this.z-=t.z*s,this},cross:function(t,s){if(s!==void 0)return this.crossVectors(t,s);var e=this.x,n=this.y,o=this.z;return this.x=n*t.z-o*t.y,this.y=o*t.x-e*t.z,this.z=e*t.y-n*t.x,this},crossVectors:function(t,s){var e=t.x,n=t.y,o=t.z,a=s.x,l=s.y,d=s.z;return this.x=n*d-o*l,this.y=o*a-e*d,this.z=e*l-n*a,this},tangent:function(t){var s=t.x,e=t.y,n=t.z;return this.x=e*s-n*n,this.y=-n*e-s*s,this.z=s*n+e*e,this},invert:function(t){return this.x=-t.x,this.y=-t.y,this.z=-t.z,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},addition:function(){return this.x+this.y+this.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return T.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},applyMatrix3:function(t,s){var e=this.x,n=this.y,o=this.z,a=t.elements;return s?(this.x=a[0]*e+a[1]*n+a[2]*o,this.y=a[3]*e+a[4]*n+a[5]*o,this.z=a[6]*e+a[7]*n+a[8]*o):(this.x=a[0]*e+a[3]*n+a[6]*o,this.y=a[1]*e+a[4]*n+a[7]*o,this.z=a[2]*e+a[5]*n+a[8]*o),this},applyQuaternion:function(t){var s=this.x,e=this.y,n=this.z,o=t.x,a=t.y,l=t.z,d=t.w,u=d*s+a*n-l*e,p=d*e+l*s-o*n,c=d*n+o*e-a*s,z=-o*s-a*e-l*n;return this.x=u*d+z*-o+p*-l-c*-a,this.y=p*d+z*-a+c*-o-u*-l,this.z=c*d+z*-l+u*-a-p*-o,this},testZero:function(){return this.x!==0||this.y!==0||this.z!==0},testDiff:function(t){return!this.equals(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},clone:function(){return new this.constructor(this.x,this.y,this.z)},toString:function(){return"Vec3["+this.x.toFixed(4)+", "+this.y.toFixed(4)+", "+this.z.toFixed(4)+"]"},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},divideScalar:function(t){return this.multiplyScalar(1/t)},normalize:function(){return this.divideScalar(this.length())},toArray:function(t,s){s===void 0&&(s=0),t[s]=this.x,t[s+1]=this.y,t[s+2]=this.z},fromArray:function(t,s){return s===void 0&&(s=0),this.x=t[s],this.y=t[s+1],this.z=t[s+2],this}}),Object.assign(ks.prototype,{Quat:!0,set:function(t,s,e,n){return this.x=t,this.y=s,this.z=e,this.w=n,this},addTime:function(t,s){var e=t.x,n=t.y,o=t.z,a=this.w,l=this.x,d=this.y,u=this.z;return s*=.5,this.x+=s*(e*a+n*u-o*d),this.y+=s*(n*a+o*l-e*u),this.z+=s*(o*a+e*d-n*l),this.w+=s*(-e*l-n*d-o*u),this.normalize(),this},multiply:function(t,s){return s!==void 0?this.multiplyQuaternions(t,s):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,s){var e=t.x,n=t.y,o=t.z,a=t.w,l=s.x,d=s.y,u=s.z,p=s.w;return this.x=e*p+a*l+n*u-o*d,this.y=n*p+a*d+o*l-e*u,this.z=o*p+a*u+e*d-n*l,this.w=a*p-e*l-n*d-o*u,this},setFromUnitVectors:function(t,s){var e=new $,n=t.dot(s)+1;return n<T.EPS2?(n=0,T.abs(t.x)>T.abs(t.z)?e.set(-t.y,t.x,0):e.set(0,-t.z,t.y)):e.crossVectors(t,s),this._x=e.x,this._y=e.y,this._z=e.z,this._w=n,this.normalize()},arc:function(t,s){var e=t.x,n=t.y,o=t.z,a=s.x,l=s.y,d=s.z,u=e*a+n*l+o*d;if(u==-1)return a=n*e-o*o,l=-o*n-e*e,d=e*o+n*n,u=1/T.sqrt(a*a+l*l+d*d),this.w=0,this.x=a*u,this.y=l*u,this.z=d*u,this;var p=n*d-o*l,c=o*a-e*d,z=e*l-n*a;return this.w=T.sqrt(.5*(1+u)),u=.5/this.w,this.x=p*u,this.y=c*u,this.z=z*u,this},normalize:function(){var t=this.length();return t===0?this.set(0,0,0,1):(t=1/t,this.x=this.x*t,this.y=this.y*t,this.z=this.z*t,this.w=this.w*t),this},inverse:function(){return this.conjugate().normalize()},invert:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this.conjugate().normalize(),this},conjugate:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},length:function(){return T.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},clone:function(t){return new ks(this.x,this.y,this.z,this.w)},testDiff:function(t){return!this.equals(t)},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},toString:function(){return"Quat["+this.x.toFixed(4)+", ("+this.y.toFixed(4)+", "+this.z.toFixed(4)+", "+this.w.toFixed(4)+")]"},setFromEuler:function(t,s,e){var n=Math.cos(.5*t),o=Math.cos(.5*s),a=Math.cos(.5*e),l=Math.sin(.5*t),d=Math.sin(.5*s),u=Math.sin(.5*e);return this.x=l*o*a+n*d*u,this.y=n*d*a-l*o*u,this.z=n*o*u+l*d*a,this.w=n*o*a-l*d*u,this},setFromAxis:function(t,s){t.normalize(),s*=.5;var e=T.sin(s);return this.x=e*t.x,this.y=e*t.y,this.z=e*t.z,this.w=T.cos(s),this},setFromMat33:function(t){var s,e=t[0]+t[4]+t[8];if(e>0)s=T.sqrt(e+1),this.w=.5/s,s=.5/s,this.x=(t[5]-t[7])*s,this.y=(t[6]-t[2])*s,this.z=(t[1]-t[3])*s;else{var n=[],o=0;t[4]>t[0]&&(o=1),t[8]>t[3*o+o]&&(o=2);var a=(o+1)%3,l=(o+2)%3;s=T.sqrt(t[3*o+o]-t[3*a+a]-t[3*l+l]+1),n[o]=.5*fRoot,s=.5/fRoot,this.w=(t[3*a+l]-t[3*l+a])*s,n[a]=(t[3*a+o]+t[3*o+a])*s,n[l]=(t[3*l+o]+t[3*o+l])*s,this.x=n[1],this.y=n[2],this.z=n[3]}return this},toArray:function(t,s){t[s=s||0]=this.x,t[s+1]=this.y,t[s+2]=this.z,t[s+3]=this.w},fromArray:function(t,s){return s=s||0,this.set(t[s],t[s+1],t[s+2],t[s+3]),this}}),Object.assign(xs.prototype,{Mat33:!0,set:function(t,s,e,n,o,a,l,d,u){var p=this.elements;return p[0]=t,p[1]=s,p[2]=e,p[3]=n,p[4]=o,p[5]=a,p[6]=l,p[7]=d,p[8]=u,this},add:function(t,s){if(s!==void 0)return this.addMatrixs(t,s);var e=this.elements,n=t.elements;return e[0]+=n[0],e[1]+=n[1],e[2]+=n[2],e[3]+=n[3],e[4]+=n[4],e[5]+=n[5],e[6]+=n[6],e[7]+=n[7],e[8]+=n[8],this},addMatrixs:function(t,s){var e=this.elements,n=t.elements,o=s.elements;return e[0]=n[0]+o[0],e[1]=n[1]+o[1],e[2]=n[2]+o[2],e[3]=n[3]+o[3],e[4]=n[4]+o[4],e[5]=n[5]+o[5],e[6]=n[6]+o[6],e[7]=n[7]+o[7],e[8]=n[8]+o[8],this},addEqual:function(t){var s=this.elements,e=t.elements;return s[0]+=e[0],s[1]+=e[1],s[2]+=e[2],s[3]+=e[3],s[4]+=e[4],s[5]+=e[5],s[6]+=e[6],s[7]+=e[7],s[8]+=e[8],this},sub:function(t,s){if(s!==void 0)return this.subMatrixs(t,s);var e=this.elements,n=t.elements;return e[0]-=n[0],e[1]-=n[1],e[2]-=n[2],e[3]-=n[3],e[4]-=n[4],e[5]-=n[5],e[6]-=n[6],e[7]-=n[7],e[8]-=n[8],this},subMatrixs:function(t,s){var e=this.elements,n=t.elements,o=s.elements;return e[0]=n[0]-o[0],e[1]=n[1]-o[1],e[2]=n[2]-o[2],e[3]=n[3]-o[3],e[4]=n[4]-o[4],e[5]=n[5]-o[5],e[6]=n[6]-o[6],e[7]=n[7]-o[7],e[8]=n[8]-o[8],this},subEqual:function(t){var s=this.elements,e=t.elements;return s[0]-=e[0],s[1]-=e[1],s[2]-=e[2],s[3]-=e[3],s[4]-=e[4],s[5]-=e[5],s[6]-=e[6],s[7]-=e[7],s[8]-=e[8],this},scale:function(t,s){var e=this.elements,n=t.elements;return e[0]=n[0]*s,e[1]=n[1]*s,e[2]=n[2]*s,e[3]=n[3]*s,e[4]=n[4]*s,e[5]=n[5]*s,e[6]=n[6]*s,e[7]=n[7]*s,e[8]=n[8]*s,this},scaleEqual:function(t){var s=this.elements;return s[0]*=t,s[1]*=t,s[2]*=t,s[3]*=t,s[4]*=t,s[5]*=t,s[6]*=t,s[7]*=t,s[8]*=t,this},multiplyMatrices:function(t,s,e){e&&(s=s.clone().transpose());var n=this.elements,o=t.elements,a=s.elements,l=o[0],d=o[3],u=o[6],p=o[1],c=o[4],z=o[7],f=o[2],x=o[5],b=o[8],w=a[0],I=a[3],J=a[6],_=a[1],q=a[4],R=a[7],tt=a[2],it=a[5],Z=a[8];return n[0]=l*w+p*I+f*J,n[1]=l*_+p*q+f*R,n[2]=l*tt+p*it+f*Z,n[3]=d*w+c*I+x*J,n[4]=d*_+c*q+x*R,n[5]=d*tt+c*it+x*Z,n[6]=u*w+z*I+b*J,n[7]=u*_+z*q+b*R,n[8]=u*tt+z*it+b*Z,this},transpose:function(t){if(t!==void 0){var s=t.elements;return this.set(s[0],s[3],s[6],s[1],s[4],s[7],s[2],s[5],s[8]),this}var e=this.elements,n=e[1],o=e[2],a=e[5];return e[1]=e[3],e[2]=e[6],e[3]=n,e[5]=e[7],e[6]=o,e[7]=a,this},setQuat:function(t){var s=this.elements,e=t.x,n=t.y,o=t.z,a=t.w,l=e+e,d=n+n,u=o+o,p=e*l,c=e*d,z=e*u,f=n*d,x=n*u,b=o*u,w=a*l,I=a*d,J=a*u;return s[0]=1-(f+b),s[1]=c-J,s[2]=z+I,s[3]=c+J,s[4]=1-(p+b),s[5]=x-w,s[6]=z-I,s[7]=x+w,s[8]=1-(p+f),this},invert:function(t){var s=this.elements,e=t.elements,n=e[0],o=e[3],a=e[6],l=e[1],d=e[4],u=e[7],p=e[2],c=e[5],z=e[8],f=z*d-c*u,x=-z*o+c*a,b=u*o-d*a,w=n*f+l*x+p*b;return w===0?(console.log("can't invert matrix, determinant is 0"),this.identity()):(w=1/w,s[0]=f*w,s[1]=(-z*l+p*u)*w,s[2]=(c*l-p*d)*w,s[3]=x*w,s[4]=(z*n-p*a)*w,s[5]=(-c*n+p*o)*w,s[6]=b*w,s[7]=(-u*n+l*a)*w,s[8]=(d*n-l*o)*w,this)},addOffset:function(t,s){var e=s.x,n=s.y,o=s.z,a=this.elements;a[0]+=t*(n*n+o*o),a[4]+=t*(e*e+o*o),a[8]+=t*(e*e+n*n);var l=t*e*n,d=t*n*o,u=t*o*e;return a[1]-=l,a[3]-=l,a[2]-=d,a[6]-=d,a[5]-=u,a[7]-=u,this},subOffset:function(t,s){var e=s.x,n=s.y,o=s.z,a=this.elements;a[0]-=t*(n*n+o*o),a[4]-=t*(e*e+o*o),a[8]-=t*(e*e+n*n);var l=t*e*n,d=t*n*o,u=t*o*e;return a[1]+=l,a[3]+=l,a[2]+=d,a[6]+=d,a[5]+=u,a[7]+=u,this},multiplyScalar:function(t){var s=this.elements;return s[0]*=t,s[3]*=t,s[6]*=t,s[1]*=t,s[4]*=t,s[7]*=t,s[2]*=t,s[5]*=t,s[8]*=t,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new xs().fromArray(this.elements)},copy:function(t){for(var s=0;s<9;s++)this.elements[s]=t.elements[s];return this},determinant:function(){var t=this.elements,s=t[0],e=t[1],n=t[2],o=t[3],a=t[4],l=t[5],d=t[6],u=t[7],p=t[8];return s*a*p-s*l*u-e*o*p+e*l*d+n*o*u-n*a*d},fromArray:function(t,s){s===void 0&&(s=0);for(var e=0;e<9;e++)this.elements[e]=t[e+s];return this},toArray:function(t,s){t===void 0&&(t=[]),s===void 0&&(s=0);var e=this.elements;return t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3],t[s+4]=e[4],t[s+5]=e[5],t[s+6]=e[6],t[s+7]=e[7],t[s+8]=e[8],t}}),Object.assign(je.prototype,{AABB:!0,set:function(t,s,e,n,o,a){var l=this.elements;return l[0]=t,l[3]=s,l[1]=e,l[4]=n,l[2]=o,l[5]=a,this},intersectTest:function(t){var s=this.elements,e=t.elements;return s[0]>e[3]||s[1]>e[4]||s[2]>e[5]||s[3]<e[0]||s[4]<e[1]||s[5]<e[2]},intersectTestTwo:function(t){var s=this.elements,e=t.elements;return s[0]<e[0]||s[1]<e[1]||s[2]<e[2]||s[3]>e[3]||s[4]>e[4]||s[5]>e[5]},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(t,s){var e=s||0,n=t.elements;return this.set(n[0]-e,n[3]+e,n[1]-e,n[4]+e,n[2]-e,n[5]+e),this},fromArray:function(t){return this.elements.set(t),this},combine:function(t,s){var e=t.elements,n=s.elements,o=this.elements;return o[0]=e[0]<n[0]?e[0]:n[0],o[1]=e[1]<n[1]?e[1]:n[1],o[2]=e[2]<n[2]?e[2]:n[2],o[3]=e[3]>n[3]?e[3]:n[3],o[4]=e[4]>n[4]?e[4]:n[4],o[5]=e[5]>n[5]?e[5]:n[5],this},surfaceArea:function(){var t=this.elements,s=t[3]-t[0],e=t[4]-t[1],n=t[5]-t[2];return 2*(s*(e+n)+e*n)},intersectsWithPoint:function(t,s,e){var n=this.elements;return t>=n[0]&&t<=n[3]&&s>=n[1]&&s<=n[4]&&e>=n[2]&&e<=n[5]},setFromPoints:function(t){this.makeEmpty();for(var s=0;s<t.length;s++)this.expandByPoint(t[s])},makeEmpty:function(){this.set(-1/0,-1/0,-1/0,1/0,1/0,1/0)},expandByPoint:function(t){var s=this.elements;this.set(T.min(s[0],t.x),T.min(s[1],t.y),T.min(s[2],t.z),T.max(s[3],t.x),T.max(s[4],t.y),T.max(s[5],t.z))},expandByScalar:function(t){var s=this.elements;s[0]+=-t,s[1]+=-t,s[2]+=-t,s[3]+=t,s[4]+=t,s[5]+=t}});var Bo=0;function Xs(t){this.type=Ft,this.id=Bo++,this.prev=null,this.next=null,this.proxy=null,this.parent=null,this.contactLink=null,this.numContacts=0,this.position=new $,this.rotation=new xs,this.relativePosition=new $().copy(t.relativePosition),this.relativeRotation=new xs().copy(t.relativeRotation),this.aabb=new je,this.density=t.density,this.friction=t.friction,this.restitution=t.restitution,this.belongsTo=t.belongsTo,this.collidesWith=t.collidesWith}function Be(t,s,e,n){Xs.call(this,t),this.type=Xt,this.width=s,this.height=e,this.depth=n,this.halfWidth=.5*s,this.halfHeight=.5*e,this.halfDepth=.5*n,this.dimentions=new Float32Array(18),this.elements=new Float32Array(24)}function Ee(t,s){Xs.call(this,t),this.type=At,this.radius=s}function Fe(t,s,e){Xs.call(this,t),this.type=Li,this.radius=s,this.height=e,this.halfHeight=.5*e,this.normalDirection=new $,this.halfDirection=new $}function He(t,s){Xs.call(this,t),this.type=Ei,this.normal=new $(0,1,0)}function kn(t,s){Xs.call(this,t),this.type=yi}function Qn(){this.relativePosition=new $,this.relativeRotation=new xs,this.friction=.2,this.restitution=.2,this.density=1,this.belongsTo=1,this.collidesWith=4294967295}function ms(t,s){s=s||!1,this.axis=t,this.angle=0,this.lowerLimit=s?0:1,this.upperLimit=0,this.motorSpeed=0,this.maxMotorForce=0,this.frequency=0,this.dampingRatio=0}function Te(){this.parent=null,this.body1=null,this.body2=null,this.addedToIsland=!1}function to(t){this.prev=null,this.next=null,this.body=null,this.joint=t}function Rs(t){Te.call(this),this.scale=1,this.invScale=1,this.name="",this.id=NaN,this.type=Qs,this.prev=null,this.next=null,this.body1=t.body1,this.body2=t.body2,this.localAnchorPoint1=new $().copy(t.localAnchorPoint1),this.localAnchorPoint2=new $().copy(t.localAnchorPoint2),this.relativeAnchorPoint1=new $,this.relativeAnchorPoint2=new $,this.anchorPoint1=new $,this.anchorPoint2=new $,this.allowCollision=t.allowCollision,this.b1Link=new to(this),this.b2Link=new to(this)}function zn(t){this.m1=NaN,this.m2=NaN,this.ii1=null,this.ii2=null,this.dd=null,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.ax1x=NaN,this.ax1y=NaN,this.ax1z=NaN,this.ay1x=NaN,this.ay1y=NaN,this.ay1z=NaN,this.az1x=NaN,this.az1y=NaN,this.az1z=NaN,this.ax2x=NaN,this.ax2y=NaN,this.ax2z=NaN,this.ay2x=NaN,this.ay2y=NaN,this.ay2z=NaN,this.az2x=NaN,this.az2y=NaN,this.az2z=NaN,this.vel=NaN,this.velx=NaN,this.vely=NaN,this.velz=NaN,this.joint=t,this.r1=t.relativeAnchorPoint1,this.r2=t.relativeAnchorPoint2,this.p1=t.anchorPoint1,this.p2=t.anchorPoint2,this.b1=t.body1,this.b2=t.body2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.impx=0,this.impy=0,this.impz=0}function Ue(t,s,e,n){this.cfm1=NaN,this.cfm2=NaN,this.cfm3=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.ax1=NaN,this.ay1=NaN,this.az1=NaN,this.ax2=NaN,this.ay2=NaN,this.az2=NaN,this.ax3=NaN,this.ay3=NaN,this.az3=NaN,this.a1x1=NaN,this.a1y1=NaN,this.a1z1=NaN,this.a2x1=NaN,this.a2y1=NaN,this.a2z1=NaN,this.a1x2=NaN,this.a1y2=NaN,this.a1z2=NaN,this.a2x2=NaN,this.a2y2=NaN,this.a2z2=NaN,this.a1x3=NaN,this.a1y3=NaN,this.a1z3=NaN,this.a2x3=NaN,this.a2y3=NaN,this.a2z3=NaN,this.lowerLimit1=NaN,this.upperLimit1=NaN,this.limitVelocity1=NaN,this.limitState1=0,this.enableMotor1=!1,this.motorSpeed1=NaN,this.maxMotorForce1=NaN,this.maxMotorImpulse1=NaN,this.lowerLimit2=NaN,this.upperLimit2=NaN,this.limitVelocity2=NaN,this.limitState2=0,this.enableMotor2=!1,this.motorSpeed2=NaN,this.maxMotorForce2=NaN,this.maxMotorImpulse2=NaN,this.lowerLimit3=NaN,this.upperLimit3=NaN,this.limitVelocity3=NaN,this.limitState3=0,this.enableMotor3=!1,this.motorSpeed3=NaN,this.maxMotorForce3=NaN,this.maxMotorImpulse3=NaN,this.k00=NaN,this.k01=NaN,this.k02=NaN,this.k10=NaN,this.k11=NaN,this.k12=NaN,this.k20=NaN,this.k21=NaN,this.k22=NaN,this.kv00=NaN,this.kv11=NaN,this.kv22=NaN,this.dv00=NaN,this.dv11=NaN,this.dv22=NaN,this.d00=NaN,this.d01=NaN,this.d02=NaN,this.d10=NaN,this.d11=NaN,this.d12=NaN,this.d20=NaN,this.d21=NaN,this.d22=NaN,this.limitMotor1=s,this.limitMotor2=e,this.limitMotor3=n,this.b1=t.body1,this.b2=t.body2,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse1=0,this.motorImpulse1=0,this.limitImpulse2=0,this.motorImpulse2=0,this.limitImpulse3=0,this.motorImpulse3=0}function Re(t,s,e){Rs.call(this,t),this.type=Se,this.localAxis1=t.localAxis1.clone().normalize(),this.localAxis2=t.localAxis2.clone().normalize();var n=new xs().setQuat(new ks().setFromUnitVectors(this.localAxis1,this.localAxis2));this.localAngle1=new $().tangent(this.localAxis1).normalize(),this.localAngle2=this.localAngle1.clone().applyMatrix3(n,!0),this.ax1=new $,this.ax2=new $,this.an1=new $,this.an2=new $,this.tmp=new $,this.nor=new $,this.tan=new $,this.bin=new $,this.limitMotor=new ms(this.nor,!1),this.limitMotor.lowerLimit=s,this.limitMotor.upperLimit=e,this.lc=new zn(this),this.r3=new Ue(this,this.limitMotor,new ms(this.tan,!0),new ms(this.bin,!0))}function qe(t){Rs.call(this,t),this.type=de,this.lc=new zn(this)}function io(t,s){this.cfm=NaN,this.m1=NaN,this.m2=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.motorDenom=NaN,this.invMotorDenom=NaN,this.invDenom=NaN,this.ax=NaN,this.ay=NaN,this.az=NaN,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.t1x=NaN,this.t1y=NaN,this.t1z=NaN,this.t2x=NaN,this.t2y=NaN,this.t2z=NaN,this.l1x=NaN,this.l1y=NaN,this.l1z=NaN,this.l2x=NaN,this.l2y=NaN,this.l2z=NaN,this.a1x=NaN,this.a1y=NaN,this.a1z=NaN,this.a2x=NaN,this.a2y=NaN,this.a2z=NaN,this.lowerLimit=NaN,this.upperLimit=NaN,this.limitVelocity=NaN,this.limitState=0,this.enableMotor=!1,this.motorSpeed=NaN,this.maxMotorForce=NaN,this.maxMotorImpulse=NaN,this.limitMotor=s,this.b1=t.body1,this.b2=t.body2,this.p1=t.anchorPoint1,this.p2=t.anchorPoint2,this.r1=t.relativeAnchorPoint1,this.r2=t.relativeAnchorPoint2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse=0,this.motorImpulse=0}function We(t,s,e){Rs.call(this,t),this.type=te,this.nor=new $,this.limitMotor=new ms(this.nor,!0),this.limitMotor.lowerLimit=s,this.limitMotor.upperLimit=e,this.t=new io(this,this.limitMotor)}function so(t,s){this.joint=t,this.targetOrientation=new ks().invert(s),this.relativeOrientation=new ks,this.ii1=null,this.ii2=null,this.dd=null,this.vel=new $,this.imp=new $,this.rn0=new $,this.rn1=new $,this.rn2=new $,this.b1=t.body1,this.b2=t.body2,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia}function Je(t,s,e,n){this.m1=NaN,this.m2=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.ax1=NaN,this.ay1=NaN,this.az1=NaN,this.ax2=NaN,this.ay2=NaN,this.az2=NaN,this.ax3=NaN,this.ay3=NaN,this.az3=NaN,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.t1x1=NaN,this.t1y1=NaN,this.t1z1=NaN,this.t2x1=NaN,this.t2y1=NaN,this.t2z1=NaN,this.l1x1=NaN,this.l1y1=NaN,this.l1z1=NaN,this.l2x1=NaN,this.l2y1=NaN,this.l2z1=NaN,this.a1x1=NaN,this.a1y1=NaN,this.a1z1=NaN,this.a2x1=NaN,this.a2y1=NaN,this.a2z1=NaN,this.t1x2=NaN,this.t1y2=NaN,this.t1z2=NaN,this.t2x2=NaN,this.t2y2=NaN,this.t2z2=NaN,this.l1x2=NaN,this.l1y2=NaN,this.l1z2=NaN,this.l2x2=NaN,this.l2y2=NaN,this.l2z2=NaN,this.a1x2=NaN,this.a1y2=NaN,this.a1z2=NaN,this.a2x2=NaN,this.a2y2=NaN,this.a2z2=NaN,this.t1x3=NaN,this.t1y3=NaN,this.t1z3=NaN,this.t2x3=NaN,this.t2y3=NaN,this.t2z3=NaN,this.l1x3=NaN,this.l1y3=NaN,this.l1z3=NaN,this.l2x3=NaN,this.l2y3=NaN,this.l2z3=NaN,this.a1x3=NaN,this.a1y3=NaN,this.a1z3=NaN,this.a2x3=NaN,this.a2y3=NaN,this.a2z3=NaN,this.lowerLimit1=NaN,this.upperLimit1=NaN,this.limitVelocity1=NaN,this.limitState1=0,this.enableMotor1=!1,this.motorSpeed1=NaN,this.maxMotorForce1=NaN,this.maxMotorImpulse1=NaN,this.lowerLimit2=NaN,this.upperLimit2=NaN,this.limitVelocity2=NaN,this.limitState2=0,this.enableMotor2=!1,this.motorSpeed2=NaN,this.maxMotorForce2=NaN,this.maxMotorImpulse2=NaN,this.lowerLimit3=NaN,this.upperLimit3=NaN,this.limitVelocity3=NaN,this.limitState3=0,this.enableMotor3=!1,this.motorSpeed3=NaN,this.maxMotorForce3=NaN,this.maxMotorImpulse3=NaN,this.k00=NaN,this.k01=NaN,this.k02=NaN,this.k10=NaN,this.k11=NaN,this.k12=NaN,this.k20=NaN,this.k21=NaN,this.k22=NaN,this.kv00=NaN,this.kv11=NaN,this.kv22=NaN,this.dv00=NaN,this.dv11=NaN,this.dv22=NaN,this.d00=NaN,this.d01=NaN,this.d02=NaN,this.d10=NaN,this.d11=NaN,this.d12=NaN,this.d20=NaN,this.d21=NaN,this.d22=NaN,this.limitMotor1=s,this.limitMotor2=e,this.limitMotor3=n,this.b1=t.body1,this.b2=t.body2,this.p1=t.anchorPoint1,this.p2=t.anchorPoint2,this.r1=t.relativeAnchorPoint1,this.r2=t.relativeAnchorPoint2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse1=0,this.motorImpulse1=0,this.limitImpulse2=0,this.motorImpulse2=0,this.limitImpulse3=0,this.motorImpulse3=0,this.cfm1=0,this.cfm2=0,this.cfm3=0,this.weight=-1}function Ze(t,s,e){Rs.call(this,t),this.type=Xn,this.localAxis1=t.localAxis1.clone().normalize(),this.localAxis2=t.localAxis2.clone().normalize(),this.ax1=new $,this.ax2=new $,this.nor=new $,this.tan=new $,this.bin=new $,this.ac=new so(this,new ks().setFromUnitVectors(this.localAxis1,this.localAxis2)),this.limitMotor=new ms(this.nor,!0),this.limitMotor.lowerLimit=s,this.limitMotor.upperLimit=e,this.t3=new Je(this,this.limitMotor,new ms(this.tan,!0),new ms(this.bin,!0))}function Ke(t,s,e){Rs.call(this,t),this.type=Yn,this.localAxis1=t.localAxis1.clone().normalize(),this.localAxis2=t.localAxis2.clone().normalize();var n=new xs().setQuat(new ks().setFromUnitVectors(this.localAxis1,this.localAxis2));this.localAngle1=new $().tangent(this.localAxis1).normalize(),this.localAngle2=this.localAngle1.clone().applyMatrix3(n,!0),this.ax1=new $,this.ax2=new $,this.an1=new $,this.an2=new $,this.tmp=new $,this.nor=new $,this.tan=new $,this.bin=new $,this.rotationalLimitMotor=new ms(this.nor,!1),this.r3=new Ue(this,this.rotationalLimitMotor,new ms(this.tan,!0),new ms(this.bin,!0)),this.translationalLimitMotor=new ms(this.nor,!0),this.translationalLimitMotor.lowerLimit=s,this.translationalLimitMotor.upperLimit=e,this.t3=new Je(this,this.translationalLimitMotor,new ms(this.tan,!0),new ms(this.bin,!0))}function Ge(t){Rs.call(this,t),this.type=Ie,this.localAxis1=t.localAxis1.clone().normalize(),this.localAxis2=t.localAxis2.clone().normalize(),this.localAngle1=new $,this.localAngle2=new $;var s=T.dotVectors(this.localAxis1,this.localAxis2);if(s>-1&&s<1)this.localAngle1.set(this.localAxis2.x-s*this.localAxis1.x,this.localAxis2.y-s*this.localAxis1.y,this.localAxis2.z-s*this.localAxis1.z).normalize(),this.localAngle2.set(this.localAxis1.x-s*this.localAxis2.x,this.localAxis1.y-s*this.localAxis2.y,this.localAxis1.z-s*this.localAxis2.z).normalize();else{var e=new xs().setQuat(new ks().setFromUnitVectors(this.localAxis1,this.localAxis2));this.localAngle1.tangent(this.localAxis1).normalize(),this.localAngle2=this.localAngle1.clone().applyMatrix3(e,!0)}this.ax1=new $,this.ax2=new $,this.an1=new $,this.an2=new $,this.tmp=new $,this.nor=new $,this.tan=new $,this.bin=new $,this.translationalLimitMotor=new ms(this.tan,!0),this.translationalLimitMotor.frequency=8,this.translationalLimitMotor.dampingRatio=1,this.rotationalLimitMotor1=new ms(this.tan,!1),this.rotationalLimitMotor2=new ms(this.bin,!1),this.t3=new Je(this,new ms(this.nor,!0),this.translationalLimitMotor,new ms(this.bin,!0)),this.t3.weight=1,this.r3=new Ue(this,new ms(this.nor,!0),this.rotationalLimitMotor1,this.rotationalLimitMotor2)}function eo(){this.scale=1,this.invScale=1,this.body1=null,this.body2=null,this.localAnchorPoint1=new $,this.localAnchorPoint2=new $,this.localAxis1=new $,this.localAxis2=new $,this.allowCollision=!1}function Eo(){this.mass=0,this.inertia=new xs}function Ye(t){this.prev=null,this.next=null,this.shape=null,this.body=null,this.contact=t}function Xe(){this.lp1X=NaN,this.lp1Y=NaN,this.lp1Z=NaN,this.lp2X=NaN,this.lp2Y=NaN,this.lp2Z=NaN,this.impulse=NaN}function Qe(){this.warmStarted=!1,this.position=new $,this.localPoint1=new $,this.localPoint2=new $,this.normal=new $,this.tangent=new $,this.binormal=new $,this.normalImpulse=0,this.tangentImpulse=0,this.binormalImpulse=0,this.normalDenominator=0,this.tangentDenominator=0,this.binormalDenominator=0,this.penetration=0}function gn(){this.body1=null,this.body2=null,this.numPoints=0,this.points=[new Qe,new Qe,new Qe,new Qe]}function tn(){this.nor=new $,this.tan=new $,this.bin=new $,this.norU1=new $,this.tanU1=new $,this.binU1=new $,this.norU2=new $,this.tanU2=new $,this.binU2=new $,this.norT1=new $,this.tanT1=new $,this.binT1=new $,this.norT2=new $,this.tanT2=new $,this.binT2=new $,this.norTU1=new $,this.tanTU1=new $,this.binTU1=new $,this.norTU2=new $,this.tanTU2=new $,this.binTU2=new $,this.norImp=0,this.tanImp=0,this.binImp=0,this.norDen=0,this.tanDen=0,this.binDen=0,this.norTar=0,this.next=null,this.last=!1}function _n(t){Te.call(this),this.manifold=t,this.restitution=NaN,this.friction=NaN,this.p1=null,this.p2=null,this.lv1=null,this.lv2=null,this.av1=null,this.av2=null,this.i1=null,this.i2=null,this.tmp=new $,this.tmpC1=new $,this.tmpC2=new $,this.tmpP1=new $,this.tmpP2=new $,this.tmplv1=new $,this.tmplv2=new $,this.tmpav1=new $,this.tmpav2=new $,this.m1=NaN,this.m2=NaN,this.num=0,this.ps=t.points,this.cs=new tn,this.cs.next=new tn,this.cs.next.next=new tn,this.cs.next.next.next=new tn}function no(){this.shape1=null,this.shape2=null,this.body1=null,this.body2=null,this.prev=null,this.next=null,this.persisting=!1,this.sleeping=!1,this.detector=null,this.constraint=null,this.touching=!1,this.close=!1,this.dist=T.INF,this.b1Link=new Ye(this),this.b2Link=new Ye(this),this.s1Link=new Ye(this),this.s2Link=new Ye(this),this.manifold=new gn,this.buffer=[new Xe,new Xe,new Xe,new Xe],this.points=this.manifold.points,this.constraint=new _n(this.manifold)}function Ne(t,s){this.position=t||new $,this.orientation=s||new ks,this.scale=1,this.invScale=1,this.mesh=null,this.id=NaN,this.name="",this.prev=null,this.next=null,this.type=ii,this.massInfo=new Eo,this.newPosition=new $,this.controlPos=!1,this.newOrientation=new ks,this.newRotation=new $,this.currentRotation=new $,this.controlRot=!1,this.controlRotInTime=!1,this.quaternion=new ks,this.pos=new $,this.linearVelocity=new $,this.angularVelocity=new $,this.parent=null,this.contactLink=null,this.numContacts=0,this.shapes=null,this.numShapes=0,this.jointLink=null,this.numJoints=0,this.sleepPosition=new $,this.sleepOrientation=new ks,this.isStatic=!1,this.isDynamic=!1,this.isKinematic=!1,this.rotation=new xs,this.mass=0,this.inverseMass=0,this.inverseInertia=new xs,this.localInertia=new xs,this.inverseLocalInertia=new xs,this.tmpInertia=new xs,this.addedToIsland=!1,this.allowSleep=!0,this.sleepTime=0,this.sleeping=!1}function Fo(t,s){this.shape1=t||null,this.shape2=s||null}function we(){this.types=j,this.numPairChecks=0,this.numPairs=0,this.pairs=[]}Object.assign(Xs.prototype,{Shape:!0,calculateMassInfo:function(t){bs("Shape","Inheritance error.")},updateProxy:function(){bs("Shape","Inheritance error.")}}),Be.prototype=Object.assign(Object.create(Xs.prototype),{constructor:Be,calculateMassInfo:function(t){var s=this.width*this.height*this.depth*this.density;t.mass=s,t.inertia.set(s*(this.height*this.height+this.depth*this.depth)*(1/12),0,0,0,s*(this.width*this.width+this.depth*this.depth)*(1/12),0,0,0,s*(this.width*this.width+this.height*this.height)*(1/12))},updateProxy:function(){var t=this.rotation.elements,s=this.dimentions;s[0]=t[0],s[1]=t[3],s[2]=t[6],s[3]=t[1],s[4]=t[4],s[5]=t[7],s[6]=t[2],s[7]=t[5],s[8]=t[8],s[9]=t[0]*this.halfWidth,s[10]=t[3]*this.halfWidth,s[11]=t[6]*this.halfWidth,s[12]=t[1]*this.halfHeight,s[13]=t[4]*this.halfHeight,s[14]=t[7]*this.halfHeight,s[15]=t[2]*this.halfDepth,s[16]=t[5]*this.halfDepth,s[17]=t[8]*this.halfDepth;var e=s[9],n=s[10],o=s[11],a=s[12],l=s[13],d=s[14],u=s[15],p=s[16],c=s[17],z=this.position.x,f=this.position.y,x=this.position.z,b=this.elements;b[0]=z+e+a+u,b[1]=f+n+l+p,b[2]=x+o+d+c,b[3]=z+e+a-u,b[4]=f+n+l-p,b[5]=x+o+d-c,b[6]=z+e-a+u,b[7]=f+n-l+p,b[8]=x+o-d+c,b[9]=z+e-a-u,b[10]=f+n-l-p,b[11]=x+o-d-c,b[12]=z-e+a+u,b[13]=f-n+l+p,b[14]=x-o+d+c,b[15]=z-e+a-u,b[16]=f-n+l-p,b[17]=x-o+d-c,b[18]=z-e-a+u,b[19]=f-n-l+p,b[20]=x-o-d+c,b[21]=z-e-a-u,b[22]=f-n-l-p,b[23]=x-o-d-c;var w=s[9]<0?-s[9]:s[9],I=s[10]<0?-s[10]:s[10],J=s[11]<0?-s[11]:s[11];w=s[12]<0?w-s[12]:w+s[12],I=s[13]<0?I-s[13]:I+s[13],J=s[14]<0?J-s[14]:J+s[14],w=s[15]<0?w-s[15]:w+s[15],I=s[16]<0?I-s[16]:I+s[16],J=s[17]<0?J-s[17]:J+s[17];var _=.005;this.aabb.set(this.position.x-w-_,this.position.x+w+_,this.position.y-I-_,this.position.y+I+_,this.position.z-J-_,this.position.z+J+_),this.proxy!=null&&this.proxy.update()}}),Ee.prototype=Object.assign(Object.create(Xs.prototype),{constructor:Ee,volume:function(){return T.PI*this.radius*1.333333},calculateMassInfo:function(t){var s=this.volume()*this.radius*this.radius*this.density;t.mass=s;var e=s*this.radius*this.radius*.4;t.inertia.set(e,0,0,0,e,0,0,0,e)},updateProxy:function(){var t=.005;this.aabb.set(this.position.x-this.radius-t,this.position.x+this.radius+t,this.position.y-this.radius-t,this.position.y+this.radius+t,this.position.z-this.radius-t,this.position.z+this.radius+t),this.proxy!=null&&this.proxy.update()}}),Fe.prototype=Object.assign(Object.create(Xs.prototype),{constructor:Fe,calculateMassInfo:function(t){var s=this.radius*this.radius,e=T.PI*s*this.height*this.density,n=(.25*s+.0833*this.height*this.height)*e,o=.5*s;t.mass=e,t.inertia.set(n,0,0,0,o,0,0,0,n)},updateProxy:function(){var t,s,e,n,o,a,l,d,u,p,c,z=this.rotation.elements;o=z[1]*z[1],a=z[4]*z[4],l=z[7]*z[7],this.normalDirection.set(z[1],z[4],z[7]),this.halfDirection.scale(this.normalDirection,this.halfHeight),s=1-o,(t=T.sqrt(s*s+o*a+o*l))>0&&(t=this.radius/t),s*=t,e=1-a,(t=T.sqrt(a*o+e*e+a*l))>0&&(t=this.radius/t),e*=t,n=1-l,(t=T.sqrt(l*o+l*a+n*n))>0&&(t=this.radius/t),n*=t,d=this.halfDirection.x<0?-this.halfDirection.x:this.halfDirection.x,u=this.halfDirection.y<0?-this.halfDirection.y:this.halfDirection.y,p=this.halfDirection.z<0?-this.halfDirection.z:this.halfDirection.z,d=s<0?d-s:d+s,u=e<0?u-e:u+e,p=n<0?p-n:p+n,c=.005,this.aabb.set(this.position.x-d-c,this.position.x+d+c,this.position.y-u-c,this.position.y+u+c,this.position.z-p-c,this.position.z+p+c),this.proxy!=null&&this.proxy.update()}}),He.prototype=Object.assign(Object.create(Xs.prototype),{constructor:He,volume:function(){return Number.MAX_VALUE},calculateMassInfo:function(t){t.mass=this.density,t.inertia.set(1,0,0,0,1,0,0,0,1)},updateProxy:function(){var t=.005,s=-T.INF,e=T.INF,n=this.normal;this.aabb.set(n.x===-1?this.position.x-t:s,n.x===1?this.position.x+t:e,n.y===-1?this.position.y-t:s,n.y===1?this.position.y+t:e,n.z===-1?this.position.z-t:s,n.z===1?this.position.z+t:e),this.proxy!=null&&this.proxy.update()}}),kn.prototype=Object.assign(Object.create(Xs.prototype),{constructor:kn,volume:function(){return Number.MAX_VALUE},calculateMassInfo:function(t){t.inertia.set(0,0,0,0,0,0,0,0,0)},updateProxy:function(){this.aabb.set(this.position.x-0,this.position.x+0,this.position.y-0,this.position.y+0,this.position.z-0,this.position.z+0),this.proxy!=null&&this.proxy.update()}}),Object.assign(ms.prototype,{LimitMotor:!0,setLimit:function(t,s){this.lowerLimit=t,this.upperLimit=s},setMotor:function(t,s){this.motorSpeed=t,this.maxMotorForce=s},setSpring:function(t,s){this.frequency=t,this.dampingRatio=s}}),Object.assign(Te.prototype,{Constraint:!0,preSolve:function(t,s){bs("Constraint","Inheritance error.")},solve:function(){bs("Constraint","Inheritance error.")},postSolve:function(){bs("Constraint","Inheritance error.")}}),Rs.prototype=Object.assign(Object.create(Te.prototype),{constructor:Rs,setId:function(t){this.id=i},setParent:function(t){this.parent=t,this.scale=this.parent.scale,this.invScale=this.parent.invScale,this.id=this.parent.numJoints,this.name||(this.name="J"+this.id)},updateAnchorPoints:function(){this.relativeAnchorPoint1.copy(this.localAnchorPoint1).applyMatrix3(this.body1.rotation,!0),this.relativeAnchorPoint2.copy(this.localAnchorPoint2).applyMatrix3(this.body2.rotation,!0),this.anchorPoint1.add(this.relativeAnchorPoint1,this.body1.position),this.anchorPoint2.add(this.relativeAnchorPoint2,this.body2.position)},attach:function(t){this.b1Link.body=this.body2,this.b2Link.body=this.body1,t?(this.body1.jointLink.push(this.b1Link),this.body2.jointLink.push(this.b2Link)):(this.body1.jointLink!=null?(this.b1Link.next=this.body1.jointLink).prev=this.b1Link:this.b1Link.next=null,this.body1.jointLink=this.b1Link,this.body1.numJoints++,this.body2.jointLink!=null?(this.b2Link.next=this.body2.jointLink).prev=this.b2Link:this.b2Link.next=null,this.body2.jointLink=this.b2Link,this.body2.numJoints++)},detach:function(t){if(t)this.body1.jointLink.splice(this.body1.jointLink.indexOf(this.b1Link),1),this.body2.jointLink.splice(this.body2.jointLink.indexOf(this.b2Link),1);else{var s=this.b1Link.prev,e=this.b1Link.next;s!=null&&(s.next=e),e!=null&&(e.prev=s),this.body1.jointLink==this.b1Link&&(this.body1.jointLink=e),this.b1Link.prev=null,this.b1Link.next=null,this.b1Link.body=null,this.body1.numJoints--,s=this.b2Link.prev,e=this.b2Link.next,s!=null&&(s.next=e),e!=null&&(e.prev=s),this.body2.jointLink==this.b2Link&&(this.body2.jointLink=e),this.b2Link.prev=null,this.b2Link.next=null,this.b2Link.body=null,this.body2.numJoints--}this.b1Link.body=null,this.b2Link.body=null},awake:function(){this.body1.awake(),this.body2.awake()},preSolve:function(t,s){},solve:function(){},postSolve:function(){},remove:function(){this.dispose()},dispose:function(){this.parent.removeJoint(this)},getPosition:function(){return[new $().scale(this.anchorPoint1,this.scale),new $().scale(this.anchorPoint2,this.scale)]}}),Object.assign(zn.prototype,{LinearConstraint:!0,preSolve:function(t,s){this.r1x=this.r1.x,this.r1y=this.r1.y,this.r1z=this.r1.z,this.r2x=this.r2.x,this.r2y=this.r2.y,this.r2z=this.r2.z,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass,this.ii1=this.i1.clone(),this.ii2=this.i2.clone();var e=this.ii1.elements,n=this.ii2.elements;this.ax1x=this.r1z*e[1]+-this.r1y*e[2],this.ax1y=this.r1z*e[4]+-this.r1y*e[5],this.ax1z=this.r1z*e[7]+-this.r1y*e[8],this.ay1x=-this.r1z*e[0]+this.r1x*e[2],this.ay1y=-this.r1z*e[3]+this.r1x*e[5],this.ay1z=-this.r1z*e[6]+this.r1x*e[8],this.az1x=this.r1y*e[0]+-this.r1x*e[1],this.az1y=this.r1y*e[3]+-this.r1x*e[4],this.az1z=this.r1y*e[6]+-this.r1x*e[7],this.ax2x=this.r2z*n[1]+-this.r2y*n[2],this.ax2y=this.r2z*n[4]+-this.r2y*n[5],this.ax2z=this.r2z*n[7]+-this.r2y*n[8],this.ay2x=-this.r2z*n[0]+this.r2x*n[2],this.ay2y=-this.r2z*n[3]+this.r2x*n[5],this.ay2z=-this.r2z*n[6]+this.r2x*n[8],this.az2x=this.r2y*n[0]+-this.r2x*n[1],this.az2y=this.r2y*n[3]+-this.r2x*n[4],this.az2z=this.r2y*n[6]+-this.r2x*n[7];var o=this.m1+this.m2,a=new xs().set(o,0,0,0,o,0,0,0,o).elements;a[0]+=e[4]*this.r1z*this.r1z-(e[7]+e[5])*this.r1y*this.r1z+e[8]*this.r1y*this.r1y,a[1]+=(e[6]*this.r1y+e[5]*this.r1x)*this.r1z-e[3]*this.r1z*this.r1z-e[8]*this.r1x*this.r1y,a[2]+=(e[3]*this.r1y-e[4]*this.r1x)*this.r1z-e[6]*this.r1y*this.r1y+e[7]*this.r1x*this.r1y,a[3]+=(e[2]*this.r1y+e[7]*this.r1x)*this.r1z-e[1]*this.r1z*this.r1z-e[8]*this.r1x*this.r1y,a[4]+=e[0]*this.r1z*this.r1z-(e[6]+e[2])*this.r1x*this.r1z+e[8]*this.r1x*this.r1x,a[5]+=(e[1]*this.r1x-e[0]*this.r1y)*this.r1z-e[7]*this.r1x*this.r1x+e[6]*this.r1x*this.r1y,a[6]+=(e[1]*this.r1y-e[4]*this.r1x)*this.r1z-e[2]*this.r1y*this.r1y+e[5]*this.r1x*this.r1y,a[7]+=(e[3]*this.r1x-e[0]*this.r1y)*this.r1z-e[5]*this.r1x*this.r1x+e[2]*this.r1x*this.r1y,a[8]+=e[0]*this.r1y*this.r1y-(e[3]+e[1])*this.r1x*this.r1y+e[4]*this.r1x*this.r1x,a[0]+=n[4]*this.r2z*this.r2z-(n[7]+n[5])*this.r2y*this.r2z+n[8]*this.r2y*this.r2y,a[1]+=(n[6]*this.r2y+n[5]*this.r2x)*this.r2z-n[3]*this.r2z*this.r2z-n[8]*this.r2x*this.r2y,a[2]+=(n[3]*this.r2y-n[4]*this.r2x)*this.r2z-n[6]*this.r2y*this.r2y+n[7]*this.r2x*this.r2y,a[3]+=(n[2]*this.r2y+n[7]*this.r2x)*this.r2z-n[1]*this.r2z*this.r2z-n[8]*this.r2x*this.r2y,a[4]+=n[0]*this.r2z*this.r2z-(n[6]+n[2])*this.r2x*this.r2z+n[8]*this.r2x*this.r2x,a[5]+=(n[1]*this.r2x-n[0]*this.r2y)*this.r2z-n[7]*this.r2x*this.r2x+n[6]*this.r2x*this.r2y,a[6]+=(n[1]*this.r2y-n[4]*this.r2x)*this.r2z-n[2]*this.r2y*this.r2y+n[5]*this.r2x*this.r2y,a[7]+=(n[3]*this.r2x-n[0]*this.r2y)*this.r2z-n[5]*this.r2x*this.r2x+n[2]*this.r2x*this.r2y,a[8]+=n[0]*this.r2y*this.r2y-(n[3]+n[1])*this.r2x*this.r2y+n[4]*this.r2x*this.r2x;var l=1/(a[0]*(a[4]*a[8]-a[7]*a[5])+a[3]*(a[7]*a[2]-a[1]*a[8])+a[6]*(a[1]*a[5]-a[4]*a[2]));this.dd=new xs().set(a[4]*a[8]-a[5]*a[7],a[2]*a[7]-a[1]*a[8],a[1]*a[5]-a[2]*a[4],a[5]*a[6]-a[3]*a[8],a[0]*a[8]-a[2]*a[6],a[2]*a[3]-a[0]*a[5],a[3]*a[7]-a[4]*a[6],a[1]*a[6]-a[0]*a[7],a[0]*a[4]-a[1]*a[3]).scaleEqual(l),this.velx=this.p2.x-this.p1.x,this.vely=this.p2.y-this.p1.y,this.velz=this.p2.z-this.p1.z;var d=T.sqrt(this.velx*this.velx+this.vely*this.vely+this.velz*this.velz);d>.005?(d=(.005-d)/d*s*.05,this.velx*=d,this.vely*=d,this.velz*=d):(this.velx=0,this.vely=0,this.velz=0),this.impx*=.95,this.impy*=.95,this.impz*=.95,this.l1.x+=this.impx*this.m1,this.l1.y+=this.impy*this.m1,this.l1.z+=this.impz*this.m1,this.a1.x+=this.impx*this.ax1x+this.impy*this.ay1x+this.impz*this.az1x,this.a1.y+=this.impx*this.ax1y+this.impy*this.ay1y+this.impz*this.az1y,this.a1.z+=this.impx*this.ax1z+this.impy*this.ay1z+this.impz*this.az1z,this.l2.x-=this.impx*this.m2,this.l2.y-=this.impy*this.m2,this.l2.z-=this.impz*this.m2,this.a2.x-=this.impx*this.ax2x+this.impy*this.ay2x+this.impz*this.az2x,this.a2.y-=this.impx*this.ax2y+this.impy*this.ay2y+this.impz*this.az2y,this.a2.z-=this.impx*this.ax2z+this.impy*this.ay2z+this.impz*this.az2z},solve:function(){var t=this.dd.elements,s=this.l2.x-this.l1.x+this.a2.y*this.r2z-this.a2.z*this.r2y-this.a1.y*this.r1z+this.a1.z*this.r1y-this.velx,e=this.l2.y-this.l1.y+this.a2.z*this.r2x-this.a2.x*this.r2z-this.a1.z*this.r1x+this.a1.x*this.r1z-this.vely,n=this.l2.z-this.l1.z+this.a2.x*this.r2y-this.a2.y*this.r2x-this.a1.x*this.r1y+this.a1.y*this.r1x-this.velz,o=s*t[0]+e*t[1]+n*t[2],a=s*t[3]+e*t[4]+n*t[5],l=s*t[6]+e*t[7]+n*t[8];this.impx+=o,this.impy+=a,this.impz+=l,this.l1.x+=o*this.m1,this.l1.y+=a*this.m1,this.l1.z+=l*this.m1,this.a1.x+=o*this.ax1x+a*this.ay1x+l*this.az1x,this.a1.y+=o*this.ax1y+a*this.ay1y+l*this.az1y,this.a1.z+=o*this.ax1z+a*this.ay1z+l*this.az1z,this.l2.x-=o*this.m2,this.l2.y-=a*this.m2,this.l2.z-=l*this.m2,this.a2.x-=o*this.ax2x+a*this.ay2x+l*this.az2x,this.a2.y-=o*this.ax2y+a*this.ay2y+l*this.az2y,this.a2.z-=o*this.ax2z+a*this.ay2z+l*this.az2z}}),Object.assign(Ue.prototype,{Rotational3Constraint:!0,preSolve:function(t,s){this.ax1=this.limitMotor1.axis.x,this.ay1=this.limitMotor1.axis.y,this.az1=this.limitMotor1.axis.z,this.ax2=this.limitMotor2.axis.x,this.ay2=this.limitMotor2.axis.y,this.az2=this.limitMotor2.axis.z,this.ax3=this.limitMotor3.axis.x,this.ay3=this.limitMotor3.axis.y,this.az3=this.limitMotor3.axis.z,this.lowerLimit1=this.limitMotor1.lowerLimit,this.upperLimit1=this.limitMotor1.upperLimit,this.motorSpeed1=this.limitMotor1.motorSpeed,this.maxMotorForce1=this.limitMotor1.maxMotorForce,this.enableMotor1=this.maxMotorForce1>0,this.lowerLimit2=this.limitMotor2.lowerLimit,this.upperLimit2=this.limitMotor2.upperLimit,this.motorSpeed2=this.limitMotor2.motorSpeed,this.maxMotorForce2=this.limitMotor2.maxMotorForce,this.enableMotor2=this.maxMotorForce2>0,this.lowerLimit3=this.limitMotor3.lowerLimit,this.upperLimit3=this.limitMotor3.upperLimit,this.motorSpeed3=this.limitMotor3.motorSpeed,this.maxMotorForce3=this.limitMotor3.maxMotorForce,this.enableMotor3=this.maxMotorForce3>0;var e=this.i1.elements,n=this.i2.elements;this.i1e00=e[0],this.i1e01=e[1],this.i1e02=e[2],this.i1e10=e[3],this.i1e11=e[4],this.i1e12=e[5],this.i1e20=e[6],this.i1e21=e[7],this.i1e22=e[8],this.i2e00=n[0],this.i2e01=n[1],this.i2e02=n[2],this.i2e10=n[3],this.i2e11=n[4],this.i2e12=n[5],this.i2e20=n[6],this.i2e21=n[7],this.i2e22=n[8];var o=this.limitMotor1.frequency,a=this.limitMotor2.frequency,l=this.limitMotor3.frequency,d=o>0,u=a>0,p=l>0,c=this.lowerLimit1<=this.upperLimit1,z=this.lowerLimit2<=this.upperLimit2,f=this.lowerLimit3<=this.upperLimit3,x=this.limitMotor1.angle;c?(this.lowerLimit1==this.upperLimit1?(this.limitState1!=0&&(this.limitState1=0,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-x):x<this.lowerLimit1?(this.limitState1!=-1&&(this.limitState1=-1,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-x):x>this.upperLimit1?(this.limitState1!=1&&(this.limitState1=1,this.limitImpulse1=0),this.limitVelocity1=this.upperLimit1-x):(this.limitState1=2,this.limitImpulse1=0,this.limitVelocity1=0),d||(this.limitVelocity1>.02?this.limitVelocity1-=.02:this.limitVelocity1<-.02?this.limitVelocity1+=.02:this.limitVelocity1=0)):(this.limitState1=2,this.limitImpulse1=0);var b=this.limitMotor2.angle;z?(this.lowerLimit2==this.upperLimit2?(this.limitState2!=0&&(this.limitState2=0,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-b):b<this.lowerLimit2?(this.limitState2!=-1&&(this.limitState2=-1,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-b):b>this.upperLimit2?(this.limitState2!=1&&(this.limitState2=1,this.limitImpulse2=0),this.limitVelocity2=this.upperLimit2-b):(this.limitState2=2,this.limitImpulse2=0,this.limitVelocity2=0),u||(this.limitVelocity2>.02?this.limitVelocity2-=.02:this.limitVelocity2<-.02?this.limitVelocity2+=.02:this.limitVelocity2=0)):(this.limitState2=2,this.limitImpulse2=0);var w=this.limitMotor3.angle;if(f?(this.lowerLimit3==this.upperLimit3?(this.limitState3!=0&&(this.limitState3=0,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-w):w<this.lowerLimit3?(this.limitState3!=-1&&(this.limitState3=-1,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-w):w>this.upperLimit3?(this.limitState3!=1&&(this.limitState3=1,this.limitImpulse3=0),this.limitVelocity3=this.upperLimit3-w):(this.limitState3=2,this.limitImpulse3=0,this.limitVelocity3=0),p||(this.limitVelocity3>.02?this.limitVelocity3-=.02:this.limitVelocity3<-.02?this.limitVelocity3+=.02:this.limitVelocity3=0)):(this.limitState3=2,this.limitImpulse3=0),this.enableMotor1&&(this.limitState1!=0||d)?this.maxMotorImpulse1=this.maxMotorForce1*t:(this.motorImpulse1=0,this.maxMotorImpulse1=0),this.enableMotor2&&(this.limitState2!=0||u)?this.maxMotorImpulse2=this.maxMotorForce2*t:(this.motorImpulse2=0,this.maxMotorImpulse2=0),this.enableMotor3&&(this.limitState3!=0||p)?this.maxMotorImpulse3=this.maxMotorForce3*t:(this.motorImpulse3=0,this.maxMotorImpulse3=0),this.a1x1=this.ax1*this.i1e00+this.ay1*this.i1e01+this.az1*this.i1e02,this.a1y1=this.ax1*this.i1e10+this.ay1*this.i1e11+this.az1*this.i1e12,this.a1z1=this.ax1*this.i1e20+this.ay1*this.i1e21+this.az1*this.i1e22,this.a2x1=this.ax1*this.i2e00+this.ay1*this.i2e01+this.az1*this.i2e02,this.a2y1=this.ax1*this.i2e10+this.ay1*this.i2e11+this.az1*this.i2e12,this.a2z1=this.ax1*this.i2e20+this.ay1*this.i2e21+this.az1*this.i2e22,this.a1x2=this.ax2*this.i1e00+this.ay2*this.i1e01+this.az2*this.i1e02,this.a1y2=this.ax2*this.i1e10+this.ay2*this.i1e11+this.az2*this.i1e12,this.a1z2=this.ax2*this.i1e20+this.ay2*this.i1e21+this.az2*this.i1e22,this.a2x2=this.ax2*this.i2e00+this.ay2*this.i2e01+this.az2*this.i2e02,this.a2y2=this.ax2*this.i2e10+this.ay2*this.i2e11+this.az2*this.i2e12,this.a2z2=this.ax2*this.i2e20+this.ay2*this.i2e21+this.az2*this.i2e22,this.a1x3=this.ax3*this.i1e00+this.ay3*this.i1e01+this.az3*this.i1e02,this.a1y3=this.ax3*this.i1e10+this.ay3*this.i1e11+this.az3*this.i1e12,this.a1z3=this.ax3*this.i1e20+this.ay3*this.i1e21+this.az3*this.i1e22,this.a2x3=this.ax3*this.i2e00+this.ay3*this.i2e01+this.az3*this.i2e02,this.a2y3=this.ax3*this.i2e10+this.ay3*this.i2e11+this.az3*this.i2e12,this.a2z3=this.ax3*this.i2e20+this.ay3*this.i2e21+this.az3*this.i2e22,this.k00=this.ax1*(this.a1x1+this.a2x1)+this.ay1*(this.a1y1+this.a2y1)+this.az1*(this.a1z1+this.a2z1),this.k01=this.ax1*(this.a1x2+this.a2x2)+this.ay1*(this.a1y2+this.a2y2)+this.az1*(this.a1z2+this.a2z2),this.k02=this.ax1*(this.a1x3+this.a2x3)+this.ay1*(this.a1y3+this.a2y3)+this.az1*(this.a1z3+this.a2z3),this.k10=this.ax2*(this.a1x1+this.a2x1)+this.ay2*(this.a1y1+this.a2y1)+this.az2*(this.a1z1+this.a2z1),this.k11=this.ax2*(this.a1x2+this.a2x2)+this.ay2*(this.a1y2+this.a2y2)+this.az2*(this.a1z2+this.a2z2),this.k12=this.ax2*(this.a1x3+this.a2x3)+this.ay2*(this.a1y3+this.a2y3)+this.az2*(this.a1z3+this.a2z3),this.k20=this.ax3*(this.a1x1+this.a2x1)+this.ay3*(this.a1y1+this.a2y1)+this.az3*(this.a1z1+this.a2z1),this.k21=this.ax3*(this.a1x2+this.a2x2)+this.ay3*(this.a1y2+this.a2y2)+this.az3*(this.a1z2+this.a2z2),this.k22=this.ax3*(this.a1x3+this.a2x3)+this.ay3*(this.a1y3+this.a2y3)+this.az3*(this.a1z3+this.a2z3),this.kv00=this.k00,this.kv11=this.k11,this.kv22=this.k22,this.dv00=1/this.kv00,this.dv11=1/this.kv11,this.dv22=1/this.kv22,d&&this.limitState1!=2){var I=6.2831853*o,J=I*I*t,_=s/(J+2*this.limitMotor1.dampingRatio*I);this.cfm1=this.kv00*_,this.limitVelocity1*=J*_}else this.cfm1=0,this.limitVelocity1*=.05*s;u&&this.limitState2!=2?(_=s/((J=(I=6.2831853*a)*I*t)+2*this.limitMotor2.dampingRatio*I),this.cfm2=this.kv11*_,this.limitVelocity2*=J*_):(this.cfm2=0,this.limitVelocity2*=.05*s),p&&this.limitState3!=2?(_=s/((J=(I=6.2831853*l)*I*t)+2*this.limitMotor3.dampingRatio*I),this.cfm3=this.kv22*_,this.limitVelocity3*=J*_):(this.cfm3=0,this.limitVelocity3*=.05*s),this.k00+=this.cfm1,this.k11+=this.cfm2,this.k22+=this.cfm3;var q=1/(this.k00*(this.k11*this.k22-this.k21*this.k12)+this.k10*(this.k21*this.k02-this.k01*this.k22)+this.k20*(this.k01*this.k12-this.k11*this.k02));this.d00=(this.k11*this.k22-this.k12*this.k21)*q,this.d01=(this.k02*this.k21-this.k01*this.k22)*q,this.d02=(this.k01*this.k12-this.k02*this.k11)*q,this.d10=(this.k12*this.k20-this.k10*this.k22)*q,this.d11=(this.k00*this.k22-this.k02*this.k20)*q,this.d12=(this.k02*this.k10-this.k00*this.k12)*q,this.d20=(this.k10*this.k21-this.k11*this.k20)*q,this.d21=(this.k01*this.k20-this.k00*this.k21)*q,this.d22=(this.k00*this.k11-this.k01*this.k10)*q,this.limitImpulse1*=.95,this.motorImpulse1*=.95,this.limitImpulse2*=.95,this.motorImpulse2*=.95,this.limitImpulse3*=.95,this.motorImpulse3*=.95;var R=this.limitImpulse1+this.motorImpulse1,tt=this.limitImpulse2+this.motorImpulse2,it=this.limitImpulse3+this.motorImpulse3;this.a1.x+=R*this.a1x1+tt*this.a1x2+it*this.a1x3,this.a1.y+=R*this.a1y1+tt*this.a1y2+it*this.a1y3,this.a1.z+=R*this.a1z1+tt*this.a1z2+it*this.a1z3,this.a2.x-=R*this.a2x1+tt*this.a2x2+it*this.a2x3,this.a2.y-=R*this.a2y1+tt*this.a2y2+it*this.a2y3,this.a2.z-=R*this.a2z1+tt*this.a2z2+it*this.a2z3},solve_:function(){var t=this.a2.x-this.a1.x,s=this.a2.y-this.a1.y,e=this.a2.z-this.a1.z;this.limitVelocity3=30;var n=t*this.ax1+s*this.ay1+e*this.az1-this.limitVelocity1,o=t*this.ax2+s*this.ay2+e*this.az2-this.limitVelocity2,a=t*this.ax3+s*this.ay3+e*this.az3-this.limitVelocity3,l=n*this.d00+o*this.d01+a*this.d02,d=n*this.d10+o*this.d11+a*this.d12,u=n*this.d20+o*this.d21+a*this.d22;this.limitImpulse1+=l,this.limitImpulse2+=d,this.limitImpulse3+=u,this.a1.x+=l*this.a1x1+d*this.a1x2+u*this.a1x3,this.a1.y+=l*this.a1y1+d*this.a1y2+u*this.a1y3,this.a1.z+=l*this.a1z1+d*this.a1z2+u*this.a1z3,this.a2.x-=l*this.a2x1+d*this.a2x2+u*this.a2x3,this.a2.y-=l*this.a2y1+d*this.a2y2+u*this.a2y3,this.a2.z-=l*this.a2z1+d*this.a2z2+u*this.a2z3},solve:function(){var t=this.a2.x-this.a1.x,s=this.a2.y-this.a1.y,e=this.a2.z-this.a1.z,n=t*this.ax1+s*this.ay1+e*this.az1,o=t*this.ax2+s*this.ay2+e*this.az2,a=t*this.ax3+s*this.ay3+e*this.az3,l=this.motorImpulse1,d=this.motorImpulse2,u=this.motorImpulse3,p=0,c=0,z=0;this.enableMotor1&&(p=(n-this.motorSpeed1)*this.dv00,this.motorImpulse1+=p,this.motorImpulse1>this.maxMotorImpulse1?this.motorImpulse1=this.maxMotorImpulse1:this.motorImpulse1<-this.maxMotorImpulse1&&(this.motorImpulse1=-this.maxMotorImpulse1),p=this.motorImpulse1-l),this.enableMotor2&&(c=(o-this.motorSpeed2)*this.dv11,this.motorImpulse2+=c,this.motorImpulse2>this.maxMotorImpulse2?this.motorImpulse2=this.maxMotorImpulse2:this.motorImpulse2<-this.maxMotorImpulse2&&(this.motorImpulse2=-this.maxMotorImpulse2),c=this.motorImpulse2-d),this.enableMotor3&&(z=(a-this.motorSpeed3)*this.dv22,this.motorImpulse3+=z,this.motorImpulse3>this.maxMotorImpulse3?this.motorImpulse3=this.maxMotorImpulse3:this.motorImpulse3<-this.maxMotorImpulse3&&(this.motorImpulse3=-this.maxMotorImpulse3),z=this.motorImpulse3-u),n+=p*this.kv00+c*this.k01+z*this.k02,o+=p*this.k10+c*this.kv11+z*this.k12,a+=p*this.k20+c*this.k21+z*this.kv22,n-=this.limitVelocity1+this.limitImpulse1*this.cfm1,o-=this.limitVelocity2+this.limitImpulse2*this.cfm2,a-=this.limitVelocity3+this.limitImpulse3*this.cfm3;var f=this.limitImpulse1,x=this.limitImpulse2,b=this.limitImpulse3,w=n*this.d00+o*this.d01+a*this.d02,I=n*this.d10+o*this.d11+a*this.d12,J=n*this.d20+o*this.d21+a*this.d22;this.limitImpulse1+=w,this.limitImpulse2+=I,this.limitImpulse3+=J;var _,q=0;switch((this.limitState1==2||this.limitImpulse1*this.limitState1<0)&&(o+=(w=-f)*this.k10,a+=w*this.k20,q|=1),(this.limitState2==2||this.limitImpulse2*this.limitState2<0)&&(n+=(I=-x)*this.k01,a+=I*this.k21,q|=2),(this.limitState3==2||this.limitImpulse3*this.limitState3<0)&&(n+=(J=-b)*this.k02,o+=J*this.k12,q|=4),q){case 1:_=1/(this.k11*this.k22-this.k12*this.k21),I=(this.k22*o+-this.k12*a)*_,J=(-this.k21*o+this.k11*a)*_;break;case 2:_=1/(this.k00*this.k22-this.k02*this.k20),w=(this.k22*n+-this.k02*a)*_,J=(-this.k20*n+this.k00*a)*_;break;case 3:J=a/this.k22;break;case 4:_=1/(this.k00*this.k11-this.k01*this.k10),w=(this.k11*n+-this.k01*o)*_,I=(-this.k10*n+this.k00*o)*_;break;case 5:I=o/this.k11;break;case 6:w=n/this.k00}this.limitImpulse1=w+f,this.limitImpulse2=I+x,this.limitImpulse3=J+b;var R=p+w,tt=c+I,it=z+J;this.a1.x+=R*this.a1x1+tt*this.a1x2+it*this.a1x3,this.a1.y+=R*this.a1y1+tt*this.a1y2+it*this.a1y3,this.a1.z+=R*this.a1z1+tt*this.a1z2+it*this.a1z3,this.a2.x-=R*this.a2x1+tt*this.a2x2+it*this.a2x3,this.a2.y-=R*this.a2y1+tt*this.a2y2+it*this.a2y3,this.a2.z-=R*this.a2z1+tt*this.a2z2+it*this.a2z3,t=this.a2.x-this.a1.x,s=this.a2.y-this.a1.y,e=this.a2.z-this.a1.z,o=t*this.ax2+s*this.ay2+e*this.az2}}),Re.prototype=Object.assign(Object.create(Rs.prototype),{constructor:Re,preSolve:function(t,s){this.updateAnchorPoints(),this.ax1.copy(this.localAxis1).applyMatrix3(this.body1.rotation,!0),this.ax2.copy(this.localAxis2).applyMatrix3(this.body2.rotation,!0),this.an1.copy(this.localAngle1).applyMatrix3(this.body1.rotation,!0),this.an2.copy(this.localAngle2).applyMatrix3(this.body2.rotation,!0),this.nor.set(this.ax1.x*this.body2.inverseMass+this.ax2.x*this.body1.inverseMass,this.ax1.y*this.body2.inverseMass+this.ax2.y*this.body1.inverseMass,this.ax1.z*this.body2.inverseMass+this.ax2.z*this.body1.inverseMass).normalize(),this.tan.tangent(this.nor).normalize(),this.bin.crossVectors(this.nor,this.tan);var e=T.acosClamp(T.dotVectors(this.an1,this.an2));this.tmp.crossVectors(this.an1,this.an2),T.dotVectors(this.nor,this.tmp)<0?this.limitMotor.angle=-e:this.limitMotor.angle=e,this.tmp.crossVectors(this.ax1,this.ax2),this.r3.limitMotor2.angle=T.dotVectors(this.tan,this.tmp),this.r3.limitMotor3.angle=T.dotVectors(this.bin,this.tmp),this.r3.preSolve(t,s),this.lc.preSolve(t,s)},solve:function(){this.r3.solve(),this.lc.solve()},postSolve:function(){}}),qe.prototype=Object.assign(Object.create(Rs.prototype),{constructor:qe,preSolve:function(t,s){this.updateAnchorPoints(),this.lc.preSolve(t,s)},solve:function(){this.lc.solve()},postSolve:function(){}}),Object.assign(io.prototype,{TranslationalConstraint:!0,preSolve:function(t,s){this.ax=this.limitMotor.axis.x,this.ay=this.limitMotor.axis.y,this.az=this.limitMotor.axis.z,this.lowerLimit=this.limitMotor.lowerLimit,this.upperLimit=this.limitMotor.upperLimit,this.motorSpeed=this.limitMotor.motorSpeed,this.maxMotorForce=this.limitMotor.maxMotorForce,this.enableMotor=this.maxMotorForce>0,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass;var e=this.i1.elements,n=this.i2.elements;this.i1e00=e[0],this.i1e01=e[1],this.i1e02=e[2],this.i1e10=e[3],this.i1e11=e[4],this.i1e12=e[5],this.i1e20=e[6],this.i1e21=e[7],this.i1e22=e[8],this.i2e00=n[0],this.i2e01=n[1],this.i2e02=n[2],this.i2e10=n[3],this.i2e11=n[4],this.i2e12=n[5],this.i2e20=n[6],this.i2e21=n[7],this.i2e22=n[8];var o=this.p2.x-this.p1.x,a=this.p2.y-this.p1.y,l=this.p2.z-this.p1.z,d=o*this.ax+a*this.ay+l*this.az,u=this.limitMotor.frequency,p=u>0;(p&&d>20||d<-20)&&(p=!1),this.lowerLimit<=this.upperLimit?(this.lowerLimit==this.upperLimit?(this.limitState!=0&&(this.limitState=0,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-d,p||(d=this.lowerLimit)):d<this.lowerLimit?(this.limitState!=-1&&(this.limitState=-1,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-d,p||(d=this.lowerLimit)):d>this.upperLimit?(this.limitState!=1&&(this.limitState=1,this.limitImpulse=0),this.limitVelocity=this.upperLimit-d,p||(d=this.upperLimit)):(this.limitState=2,this.limitImpulse=0,this.limitVelocity=0),p||(this.limitVelocity>.005?this.limitVelocity-=.005:this.limitVelocity<-.005?this.limitVelocity+=.005:this.limitVelocity=0)):(this.limitState=2,this.limitImpulse=0),this.enableMotor&&(this.limitState!=0||p)?this.maxMotorImpulse=this.maxMotorForce*t:(this.motorImpulse=0,this.maxMotorImpulse=0);var c=d*this.ax,z=d*this.ay,f=d*this.az,x=this.m1/(this.m1+this.m2),b=1-x;if(this.r1x=this.r1.x+c*x,this.r1y=this.r1.y+z*x,this.r1z=this.r1.z+f*x,this.r2x=this.r2.x-c*b,this.r2y=this.r2.y-z*b,this.r2z=this.r2.z-f*b,this.t1x=this.r1y*this.az-this.r1z*this.ay,this.t1y=this.r1z*this.ax-this.r1x*this.az,this.t1z=this.r1x*this.ay-this.r1y*this.ax,this.t2x=this.r2y*this.az-this.r2z*this.ay,this.t2y=this.r2z*this.ax-this.r2x*this.az,this.t2z=this.r2x*this.ay-this.r2y*this.ax,this.l1x=this.ax*this.m1,this.l1y=this.ay*this.m1,this.l1z=this.az*this.m1,this.l2x=this.ax*this.m2,this.l2y=this.ay*this.m2,this.l2z=this.az*this.m2,this.a1x=this.t1x*this.i1e00+this.t1y*this.i1e01+this.t1z*this.i1e02,this.a1y=this.t1x*this.i1e10+this.t1y*this.i1e11+this.t1z*this.i1e12,this.a1z=this.t1x*this.i1e20+this.t1y*this.i1e21+this.t1z*this.i1e22,this.a2x=this.t2x*this.i2e00+this.t2y*this.i2e01+this.t2z*this.i2e02,this.a2y=this.t2x*this.i2e10+this.t2y*this.i2e11+this.t2z*this.i2e12,this.a2z=this.t2x*this.i2e20+this.t2y*this.i2e21+this.t2z*this.i2e22,this.motorDenom=this.m1+this.m2+this.ax*(this.a1y*this.r1z-this.a1z*this.r1y+this.a2y*this.r2z-this.a2z*this.r2y)+this.ay*(this.a1z*this.r1x-this.a1x*this.r1z+this.a2z*this.r2x-this.a2x*this.r2z)+this.az*(this.a1x*this.r1y-this.a1y*this.r1x+this.a2x*this.r2y-this.a2y*this.r2x),this.invMotorDenom=1/this.motorDenom,p&&this.limitState!=2){var w=6.2831853*u,I=w*w*t,J=s/(I+2*this.limitMotor.dampingRatio*w);this.cfm=this.motorDenom*J,this.limitVelocity*=I*J}else this.cfm=0,this.limitVelocity*=.05*s;this.invDenom=1/(this.motorDenom+this.cfm);var _=this.limitImpulse+this.motorImpulse;this.l1.x+=_*this.l1x,this.l1.y+=_*this.l1y,this.l1.z+=_*this.l1z,this.a1.x+=_*this.a1x,this.a1.y+=_*this.a1y,this.a1.z+=_*this.a1z,this.l2.x-=_*this.l2x,this.l2.y-=_*this.l2y,this.l2.z-=_*this.l2z,this.a2.x-=_*this.a2x,this.a2.y-=_*this.a2y,this.a2.z-=_*this.a2z},solve:function(){var t,s,e=this.ax*(this.l2.x-this.l1.x)+this.ay*(this.l2.y-this.l1.y)+this.az*(this.l2.z-this.l1.z)+this.t2x*this.a2.x-this.t1x*this.a1.x+this.t2y*this.a2.y-this.t1y*this.a1.y+this.t2z*this.a2.z-this.t1z*this.a1.z;if(this.enableMotor){t=(e-this.motorSpeed)*this.invMotorDenom;var n=this.motorImpulse;this.motorImpulse+=t,this.motorImpulse>this.maxMotorImpulse?this.motorImpulse=this.maxMotorImpulse:this.motorImpulse<-this.maxMotorImpulse&&(this.motorImpulse=-this.maxMotorImpulse),e-=(t=this.motorImpulse-n)*this.motorDenom}else t=0;if(this.limitState!=2){s=(e-this.limitVelocity-this.limitImpulse*this.cfm)*this.invDenom;var o=this.limitImpulse;this.limitImpulse+=s,this.limitImpulse*this.limitState<0&&(this.limitImpulse=0),s=this.limitImpulse-o}else s=0;var a=s+t;this.l1.x+=a*this.l1x,this.l1.y+=a*this.l1y,this.l1.z+=a*this.l1z,this.a1.x+=a*this.a1x,this.a1.y+=a*this.a1y,this.a1.z+=a*this.a1z,this.l2.x-=a*this.l2x,this.l2.y-=a*this.l2y,this.l2.z-=a*this.l2z,this.a2.x-=a*this.a2x,this.a2.y-=a*this.a2y,this.a2.z-=a*this.a2z}}),We.prototype=Object.assign(Object.create(Rs.prototype),{constructor:We,preSolve:function(t,s){this.updateAnchorPoints(),this.nor.sub(this.anchorPoint2,this.anchorPoint1).normalize(),this.t.preSolve(t,s)},solve:function(){this.t.solve()},postSolve:function(){}}),Object.assign(so.prototype,{AngularConstraint:!0,preSolve:function(t,s){var e,n,o;this.ii1=this.i1.clone(),this.ii2=this.i2.clone(),e=1/((o=new xs().add(this.ii1,this.ii2).elements)[0]*(o[4]*o[8]-o[7]*o[5])+o[3]*(o[7]*o[2]-o[1]*o[8])+o[6]*(o[1]*o[5]-o[4]*o[2])),this.dd=new xs().set(o[4]*o[8]-o[5]*o[7],o[2]*o[7]-o[1]*o[8],o[1]*o[5]-o[2]*o[4],o[5]*o[6]-o[3]*o[8],o[0]*o[8]-o[2]*o[6],o[2]*o[3]-o[0]*o[5],o[3]*o[7]-o[4]*o[6],o[1]*o[6]-o[0]*o[7],o[0]*o[4]-o[1]*o[3]).multiplyScalar(e),this.relativeOrientation.invert(this.b1.orientation).multiply(this.targetOrientation).multiply(this.b2.orientation),e=2*this.relativeOrientation.w,this.vel.copy(this.relativeOrientation).multiplyScalar(e),(n=this.vel.length())>.02?(n=(.02-n)/n*s*.05,this.vel.multiplyScalar(n)):this.vel.set(0,0,0),this.rn1.copy(this.imp).applyMatrix3(this.ii1,!0),this.rn2.copy(this.imp).applyMatrix3(this.ii2,!0),this.a1.add(this.rn1),this.a2.sub(this.rn2)},solve:function(){var t=this.a2.clone().sub(this.a1).sub(this.vel);this.rn0.copy(t).applyMatrix3(this.dd,!0),this.rn1.copy(this.rn0).applyMatrix3(this.ii1,!0),this.rn2.copy(this.rn0).applyMatrix3(this.ii2,!0),this.imp.add(this.rn0),this.a1.add(this.rn1),this.a2.sub(this.rn2)}}),Object.assign(Je.prototype,{Translational3Constraint:!0,preSolve:function(t,s){this.ax1=this.limitMotor1.axis.x,this.ay1=this.limitMotor1.axis.y,this.az1=this.limitMotor1.axis.z,this.ax2=this.limitMotor2.axis.x,this.ay2=this.limitMotor2.axis.y,this.az2=this.limitMotor2.axis.z,this.ax3=this.limitMotor3.axis.x,this.ay3=this.limitMotor3.axis.y,this.az3=this.limitMotor3.axis.z,this.lowerLimit1=this.limitMotor1.lowerLimit,this.upperLimit1=this.limitMotor1.upperLimit,this.motorSpeed1=this.limitMotor1.motorSpeed,this.maxMotorForce1=this.limitMotor1.maxMotorForce,this.enableMotor1=this.maxMotorForce1>0,this.lowerLimit2=this.limitMotor2.lowerLimit,this.upperLimit2=this.limitMotor2.upperLimit,this.motorSpeed2=this.limitMotor2.motorSpeed,this.maxMotorForce2=this.limitMotor2.maxMotorForce,this.enableMotor2=this.maxMotorForce2>0,this.lowerLimit3=this.limitMotor3.lowerLimit,this.upperLimit3=this.limitMotor3.upperLimit,this.motorSpeed3=this.limitMotor3.motorSpeed,this.maxMotorForce3=this.limitMotor3.maxMotorForce,this.enableMotor3=this.maxMotorForce3>0,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass;var e=this.i1.elements,n=this.i2.elements;this.i1e00=e[0],this.i1e01=e[1],this.i1e02=e[2],this.i1e10=e[3],this.i1e11=e[4],this.i1e12=e[5],this.i1e20=e[6],this.i1e21=e[7],this.i1e22=e[8],this.i2e00=n[0],this.i2e01=n[1],this.i2e02=n[2],this.i2e10=n[3],this.i2e11=n[4],this.i2e12=n[5],this.i2e20=n[6],this.i2e21=n[7],this.i2e22=n[8];var o=this.p2.x-this.p1.x,a=this.p2.y-this.p1.y,l=this.p2.z-this.p1.z,d=o*this.ax1+a*this.ay1+l*this.az1,u=o*this.ax2+a*this.ay2+l*this.az2,p=o*this.ax3+a*this.ay3+l*this.az3,c=this.limitMotor1.frequency,z=this.limitMotor2.frequency,f=this.limitMotor3.frequency,x=c>0,b=z>0,w=f>0,I=this.lowerLimit1<=this.upperLimit1,J=this.lowerLimit2<=this.upperLimit2,_=this.lowerLimit3<=this.upperLimit3;(x&&d>20||d<-20)&&(x=!1),(b&&u>20||u<-20)&&(b=!1),(w&&p>20||p<-20)&&(w=!1),I?(this.lowerLimit1==this.upperLimit1?(this.limitState1!=0&&(this.limitState1=0,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-d,x||(d=this.lowerLimit1)):d<this.lowerLimit1?(this.limitState1!=-1&&(this.limitState1=-1,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-d,x||(d=this.lowerLimit1)):d>this.upperLimit1?(this.limitState1!=1&&(this.limitState1=1,this.limitImpulse1=0),this.limitVelocity1=this.upperLimit1-d,x||(d=this.upperLimit1)):(this.limitState1=2,this.limitImpulse1=0,this.limitVelocity1=0),x||(this.limitVelocity1>.005?this.limitVelocity1-=.005:this.limitVelocity1<-.005?this.limitVelocity1+=.005:this.limitVelocity1=0)):(this.limitState1=2,this.limitImpulse1=0),J?(this.lowerLimit2==this.upperLimit2?(this.limitState2!=0&&(this.limitState2=0,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-u,b||(u=this.lowerLimit2)):u<this.lowerLimit2?(this.limitState2!=-1&&(this.limitState2=-1,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-u,b||(u=this.lowerLimit2)):u>this.upperLimit2?(this.limitState2!=1&&(this.limitState2=1,this.limitImpulse2=0),this.limitVelocity2=this.upperLimit2-u,b||(u=this.upperLimit2)):(this.limitState2=2,this.limitImpulse2=0,this.limitVelocity2=0),b||(this.limitVelocity2>.005?this.limitVelocity2-=.005:this.limitVelocity2<-.005?this.limitVelocity2+=.005:this.limitVelocity2=0)):(this.limitState2=2,this.limitImpulse2=0),_?(this.lowerLimit3==this.upperLimit3?(this.limitState3!=0&&(this.limitState3=0,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-p,w||(p=this.lowerLimit3)):p<this.lowerLimit3?(this.limitState3!=-1&&(this.limitState3=-1,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-p,w||(p=this.lowerLimit3)):p>this.upperLimit3?(this.limitState3!=1&&(this.limitState3=1,this.limitImpulse3=0),this.limitVelocity3=this.upperLimit3-p,w||(p=this.upperLimit3)):(this.limitState3=2,this.limitImpulse3=0,this.limitVelocity3=0),w||(this.limitVelocity3>.005?this.limitVelocity3-=.005:this.limitVelocity3<-.005?this.limitVelocity3+=.005:this.limitVelocity3=0)):(this.limitState3=2,this.limitImpulse3=0),this.enableMotor1&&(this.limitState1!=0||x)?this.maxMotorImpulse1=this.maxMotorForce1*t:(this.motorImpulse1=0,this.maxMotorImpulse1=0),this.enableMotor2&&(this.limitState2!=0||b)?this.maxMotorImpulse2=this.maxMotorForce2*t:(this.motorImpulse2=0,this.maxMotorImpulse2=0),this.enableMotor3&&(this.limitState3!=0||w)?this.maxMotorImpulse3=this.maxMotorForce3*t:(this.motorImpulse3=0,this.maxMotorImpulse3=0);var q=d*this.ax1+u*this.ax2+p*this.ax2,R=d*this.ay1+u*this.ay2+p*this.ay2,tt=d*this.az1+u*this.az2+p*this.az2,it=this.m2/(this.m1+this.m2);this.weight>=0&&(it=this.weight);var Z=1-it;this.r1x=this.r1.x+q*it,this.r1y=this.r1.y+R*it,this.r1z=this.r1.z+tt*it,this.r2x=this.r2.x-q*Z,this.r2y=this.r2.y-R*Z,this.r2z=this.r2.z-tt*Z,this.t1x1=this.r1y*this.az1-this.r1z*this.ay1,this.t1y1=this.r1z*this.ax1-this.r1x*this.az1,this.t1z1=this.r1x*this.ay1-this.r1y*this.ax1,this.t2x1=this.r2y*this.az1-this.r2z*this.ay1,this.t2y1=this.r2z*this.ax1-this.r2x*this.az1,this.t2z1=this.r2x*this.ay1-this.r2y*this.ax1,this.l1x1=this.ax1*this.m1,this.l1y1=this.ay1*this.m1,this.l1z1=this.az1*this.m1,this.l2x1=this.ax1*this.m2,this.l2y1=this.ay1*this.m2,this.l2z1=this.az1*this.m2,this.a1x1=this.t1x1*this.i1e00+this.t1y1*this.i1e01+this.t1z1*this.i1e02,this.a1y1=this.t1x1*this.i1e10+this.t1y1*this.i1e11+this.t1z1*this.i1e12,this.a1z1=this.t1x1*this.i1e20+this.t1y1*this.i1e21+this.t1z1*this.i1e22,this.a2x1=this.t2x1*this.i2e00+this.t2y1*this.i2e01+this.t2z1*this.i2e02,this.a2y1=this.t2x1*this.i2e10+this.t2y1*this.i2e11+this.t2z1*this.i2e12,this.a2z1=this.t2x1*this.i2e20+this.t2y1*this.i2e21+this.t2z1*this.i2e22,this.t1x2=this.r1y*this.az2-this.r1z*this.ay2,this.t1y2=this.r1z*this.ax2-this.r1x*this.az2,this.t1z2=this.r1x*this.ay2-this.r1y*this.ax2,this.t2x2=this.r2y*this.az2-this.r2z*this.ay2,this.t2y2=this.r2z*this.ax2-this.r2x*this.az2,this.t2z2=this.r2x*this.ay2-this.r2y*this.ax2,this.l1x2=this.ax2*this.m1,this.l1y2=this.ay2*this.m1,this.l1z2=this.az2*this.m1,this.l2x2=this.ax2*this.m2,this.l2y2=this.ay2*this.m2,this.l2z2=this.az2*this.m2,this.a1x2=this.t1x2*this.i1e00+this.t1y2*this.i1e01+this.t1z2*this.i1e02,this.a1y2=this.t1x2*this.i1e10+this.t1y2*this.i1e11+this.t1z2*this.i1e12,this.a1z2=this.t1x2*this.i1e20+this.t1y2*this.i1e21+this.t1z2*this.i1e22,this.a2x2=this.t2x2*this.i2e00+this.t2y2*this.i2e01+this.t2z2*this.i2e02,this.a2y2=this.t2x2*this.i2e10+this.t2y2*this.i2e11+this.t2z2*this.i2e12,this.a2z2=this.t2x2*this.i2e20+this.t2y2*this.i2e21+this.t2z2*this.i2e22,this.t1x3=this.r1y*this.az3-this.r1z*this.ay3,this.t1y3=this.r1z*this.ax3-this.r1x*this.az3,this.t1z3=this.r1x*this.ay3-this.r1y*this.ax3,this.t2x3=this.r2y*this.az3-this.r2z*this.ay3,this.t2y3=this.r2z*this.ax3-this.r2x*this.az3,this.t2z3=this.r2x*this.ay3-this.r2y*this.ax3,this.l1x3=this.ax3*this.m1,this.l1y3=this.ay3*this.m1,this.l1z3=this.az3*this.m1,this.l2x3=this.ax3*this.m2,this.l2y3=this.ay3*this.m2,this.l2z3=this.az3*this.m2,this.a1x3=this.t1x3*this.i1e00+this.t1y3*this.i1e01+this.t1z3*this.i1e02,this.a1y3=this.t1x3*this.i1e10+this.t1y3*this.i1e11+this.t1z3*this.i1e12,this.a1z3=this.t1x3*this.i1e20+this.t1y3*this.i1e21+this.t1z3*this.i1e22,this.a2x3=this.t2x3*this.i2e00+this.t2y3*this.i2e01+this.t2z3*this.i2e02,this.a2y3=this.t2x3*this.i2e10+this.t2y3*this.i2e11+this.t2z3*this.i2e12,this.a2z3=this.t2x3*this.i2e20+this.t2y3*this.i2e21+this.t2z3*this.i2e22;var pt=this.m1+this.m2;if(this.k00=(this.ax1*this.ax1+this.ay1*this.ay1+this.az1*this.az1)*pt,this.k01=(this.ax1*this.ax2+this.ay1*this.ay2+this.az1*this.az2)*pt,this.k02=(this.ax1*this.ax3+this.ay1*this.ay3+this.az1*this.az3)*pt,this.k10=(this.ax2*this.ax1+this.ay2*this.ay1+this.az2*this.az1)*pt,this.k11=(this.ax2*this.ax2+this.ay2*this.ay2+this.az2*this.az2)*pt,this.k12=(this.ax2*this.ax3+this.ay2*this.ay3+this.az2*this.az3)*pt,this.k20=(this.ax3*this.ax1+this.ay3*this.ay1+this.az3*this.az1)*pt,this.k21=(this.ax3*this.ax2+this.ay3*this.ay2+this.az3*this.az2)*pt,this.k22=(this.ax3*this.ax3+this.ay3*this.ay3+this.az3*this.az3)*pt,this.k00+=this.t1x1*this.a1x1+this.t1y1*this.a1y1+this.t1z1*this.a1z1,this.k01+=this.t1x1*this.a1x2+this.t1y1*this.a1y2+this.t1z1*this.a1z2,this.k02+=this.t1x1*this.a1x3+this.t1y1*this.a1y3+this.t1z1*this.a1z3,this.k10+=this.t1x2*this.a1x1+this.t1y2*this.a1y1+this.t1z2*this.a1z1,this.k11+=this.t1x2*this.a1x2+this.t1y2*this.a1y2+this.t1z2*this.a1z2,this.k12+=this.t1x2*this.a1x3+this.t1y2*this.a1y3+this.t1z2*this.a1z3,this.k20+=this.t1x3*this.a1x1+this.t1y3*this.a1y1+this.t1z3*this.a1z1,this.k21+=this.t1x3*this.a1x2+this.t1y3*this.a1y2+this.t1z3*this.a1z2,this.k22+=this.t1x3*this.a1x3+this.t1y3*this.a1y3+this.t1z3*this.a1z3,this.k00+=this.t2x1*this.a2x1+this.t2y1*this.a2y1+this.t2z1*this.a2z1,this.k01+=this.t2x1*this.a2x2+this.t2y1*this.a2y2+this.t2z1*this.a2z2,this.k02+=this.t2x1*this.a2x3+this.t2y1*this.a2y3+this.t2z1*this.a2z3,this.k10+=this.t2x2*this.a2x1+this.t2y2*this.a2y1+this.t2z2*this.a2z1,this.k11+=this.t2x2*this.a2x2+this.t2y2*this.a2y2+this.t2z2*this.a2z2,this.k12+=this.t2x2*this.a2x3+this.t2y2*this.a2y3+this.t2z2*this.a2z3,this.k20+=this.t2x3*this.a2x1+this.t2y3*this.a2y1+this.t2z3*this.a2z1,this.k21+=this.t2x3*this.a2x2+this.t2y3*this.a2y2+this.t2z3*this.a2z2,this.k22+=this.t2x3*this.a2x3+this.t2y3*this.a2y3+this.t2z3*this.a2z3,this.kv00=this.k00,this.kv11=this.k11,this.kv22=this.k22,this.dv00=1/this.kv00,this.dv11=1/this.kv11,this.dv22=1/this.kv22,x&&this.limitState1!=2){var B=6.2831853*c,Y=B*B*t,st=s/(Y+2*this.limitMotor1.dampingRatio*B);this.cfm1=this.kv00*st,this.limitVelocity1*=Y*st}else this.cfm1=0,this.limitVelocity1*=.05*s;b&&this.limitState2!=2?(st=s/((Y=(B=6.2831853*z)*B*t)+2*this.limitMotor2.dampingRatio*B),this.cfm2=this.kv11*st,this.limitVelocity2*=Y*st):(this.cfm2=0,this.limitVelocity2*=.05*s),w&&this.limitState3!=2?(st=s/((Y=(B=6.2831853*f)*B*t)+2*this.limitMotor3.dampingRatio*B),this.cfm3=this.kv22*st,this.limitVelocity3*=Y*st):(this.cfm3=0,this.limitVelocity3*=.05*s),this.k00+=this.cfm1,this.k11+=this.cfm2,this.k22+=this.cfm3;var H=1/(this.k00*(this.k11*this.k22-this.k21*this.k12)+this.k10*(this.k21*this.k02-this.k01*this.k22)+this.k20*(this.k01*this.k12-this.k11*this.k02));this.d00=(this.k11*this.k22-this.k12*this.k21)*H,this.d01=(this.k02*this.k21-this.k01*this.k22)*H,this.d02=(this.k01*this.k12-this.k02*this.k11)*H,this.d10=(this.k12*this.k20-this.k10*this.k22)*H,this.d11=(this.k00*this.k22-this.k02*this.k20)*H,this.d12=(this.k02*this.k10-this.k00*this.k12)*H,this.d20=(this.k10*this.k21-this.k11*this.k20)*H,this.d21=(this.k01*this.k20-this.k00*this.k21)*H,this.d22=(this.k00*this.k11-this.k01*this.k10)*H;var X=this.limitImpulse1+this.motorImpulse1,et=this.limitImpulse2+this.motorImpulse2,Mt=this.limitImpulse3+this.motorImpulse3;this.l1.x+=X*this.l1x1+et*this.l1x2+Mt*this.l1x3,this.l1.y+=X*this.l1y1+et*this.l1y2+Mt*this.l1y3,this.l1.z+=X*this.l1z1+et*this.l1z2+Mt*this.l1z3,this.a1.x+=X*this.a1x1+et*this.a1x2+Mt*this.a1x3,this.a1.y+=X*this.a1y1+et*this.a1y2+Mt*this.a1y3,this.a1.z+=X*this.a1z1+et*this.a1z2+Mt*this.a1z3,this.l2.x-=X*this.l2x1+et*this.l2x2+Mt*this.l2x3,this.l2.y-=X*this.l2y1+et*this.l2y2+Mt*this.l2y3,this.l2.z-=X*this.l2z1+et*this.l2z2+Mt*this.l2z3,this.a2.x-=X*this.a2x1+et*this.a2x2+Mt*this.a2x3,this.a2.y-=X*this.a2y1+et*this.a2y2+Mt*this.a2y3,this.a2.z-=X*this.a2z1+et*this.a2z2+Mt*this.a2z3},solve:function(){var t=this.l2.x-this.l1.x+this.a2.y*this.r2z-this.a2.z*this.r2y-this.a1.y*this.r1z+this.a1.z*this.r1y,s=this.l2.y-this.l1.y+this.a2.z*this.r2x-this.a2.x*this.r2z-this.a1.z*this.r1x+this.a1.x*this.r1z,e=this.l2.z-this.l1.z+this.a2.x*this.r2y-this.a2.y*this.r2x-this.a1.x*this.r1y+this.a1.y*this.r1x,n=t*this.ax1+s*this.ay1+e*this.az1,o=t*this.ax2+s*this.ay2+e*this.az2,a=t*this.ax3+s*this.ay3+e*this.az3,l=this.motorImpulse1,d=this.motorImpulse2,u=this.motorImpulse3,p=0,c=0,z=0;this.enableMotor1&&(p=(n-this.motorSpeed1)*this.dv00,this.motorImpulse1+=p,this.motorImpulse1>this.maxMotorImpulse1?this.motorImpulse1=this.maxMotorImpulse1:this.motorImpulse1<-this.maxMotorImpulse1&&(this.motorImpulse1=-this.maxMotorImpulse1),p=this.motorImpulse1-l),this.enableMotor2&&(c=(o-this.motorSpeed2)*this.dv11,this.motorImpulse2+=c,this.motorImpulse2>this.maxMotorImpulse2?this.motorImpulse2=this.maxMotorImpulse2:this.motorImpulse2<-this.maxMotorImpulse2&&(this.motorImpulse2=-this.maxMotorImpulse2),c=this.motorImpulse2-d),this.enableMotor3&&(z=(a-this.motorSpeed3)*this.dv22,this.motorImpulse3+=z,this.motorImpulse3>this.maxMotorImpulse3?this.motorImpulse3=this.maxMotorImpulse3:this.motorImpulse3<-this.maxMotorImpulse3&&(this.motorImpulse3=-this.maxMotorImpulse3),z=this.motorImpulse3-u),n+=p*this.kv00+c*this.k01+z*this.k02,o+=p*this.k10+c*this.kv11+z*this.k12,a+=p*this.k20+c*this.k21+z*this.kv22,n-=this.limitVelocity1+this.limitImpulse1*this.cfm1,o-=this.limitVelocity2+this.limitImpulse2*this.cfm2,a-=this.limitVelocity3+this.limitImpulse3*this.cfm3;var f=this.limitImpulse1,x=this.limitImpulse2,b=this.limitImpulse3,w=n*this.d00+o*this.d01+a*this.d02,I=n*this.d10+o*this.d11+a*this.d12,J=n*this.d20+o*this.d21+a*this.d22;this.limitImpulse1+=w,this.limitImpulse2+=I,this.limitImpulse3+=J;var _,q=0;switch((this.limitState1==2||this.limitImpulse1*this.limitState1<0)&&(o+=(w=-f)*this.k10,a+=w*this.k20,q|=1),(this.limitState2==2||this.limitImpulse2*this.limitState2<0)&&(n+=(I=-x)*this.k01,a+=I*this.k21,q|=2),(this.limitState3==2||this.limitImpulse3*this.limitState3<0)&&(n+=(J=-b)*this.k02,o+=J*this.k12,q|=4),q){case 1:_=1/(this.k11*this.k22-this.k12*this.k21),I=(this.k22*o+-this.k12*a)*_,J=(-this.k21*o+this.k11*a)*_;break;case 2:_=1/(this.k00*this.k22-this.k02*this.k20),w=(this.k22*n+-this.k02*a)*_,J=(-this.k20*n+this.k00*a)*_;break;case 3:J=a/this.k22;break;case 4:_=1/(this.k00*this.k11-this.k01*this.k10),w=(this.k11*n+-this.k01*o)*_,I=(-this.k10*n+this.k00*o)*_;break;case 5:I=o/this.k11;break;case 6:w=n/this.k00}this.limitImpulse1=f+w,this.limitImpulse2=x+I,this.limitImpulse3=b+J;var R=p+w,tt=c+I,it=z+J;this.l1.x+=R*this.l1x1+tt*this.l1x2+it*this.l1x3,this.l1.y+=R*this.l1y1+tt*this.l1y2+it*this.l1y3,this.l1.z+=R*this.l1z1+tt*this.l1z2+it*this.l1z3,this.a1.x+=R*this.a1x1+tt*this.a1x2+it*this.a1x3,this.a1.y+=R*this.a1y1+tt*this.a1y2+it*this.a1y3,this.a1.z+=R*this.a1z1+tt*this.a1z2+it*this.a1z3,this.l2.x-=R*this.l2x1+tt*this.l2x2+it*this.l2x3,this.l2.y-=R*this.l2y1+tt*this.l2y2+it*this.l2y3,this.l2.z-=R*this.l2z1+tt*this.l2z2+it*this.l2z3,this.a2.x-=R*this.a2x1+tt*this.a2x2+it*this.a2x3,this.a2.y-=R*this.a2y1+tt*this.a2y2+it*this.a2y3,this.a2.z-=R*this.a2z1+tt*this.a2z2+it*this.a2z3}}),Ze.prototype=Object.assign(Object.create(Rs.prototype),{constructor:Ze,preSolve:function(t,s){this.updateAnchorPoints(),this.ax1.copy(this.localAxis1).applyMatrix3(this.body1.rotation,!0),this.ax2.copy(this.localAxis2).applyMatrix3(this.body2.rotation,!0),this.nor.set(this.ax1.x*this.body2.inverseMass+this.ax2.x*this.body1.inverseMass,this.ax1.y*this.body2.inverseMass+this.ax2.y*this.body1.inverseMass,this.ax1.z*this.body2.inverseMass+this.ax2.z*this.body1.inverseMass).normalize(),this.tan.tangent(this.nor).normalize(),this.bin.crossVectors(this.nor,this.tan),this.ac.preSolve(t,s),this.t3.preSolve(t,s)},solve:function(){this.ac.solve(),this.t3.solve()},postSolve:function(){}}),Ke.prototype=Object.assign(Object.create(Rs.prototype),{constructor:Ke,preSolve:function(t,s){this.updateAnchorPoints(),this.ax1.copy(this.localAxis1).applyMatrix3(this.body1.rotation,!0),this.an1.copy(this.localAngle1).applyMatrix3(this.body1.rotation,!0),this.ax2.copy(this.localAxis2).applyMatrix3(this.body2.rotation,!0),this.an2.copy(this.localAngle2).applyMatrix3(this.body2.rotation,!0),this.nor.set(this.ax1.x*this.body2.inverseMass+this.ax2.x*this.body1.inverseMass,this.ax1.y*this.body2.inverseMass+this.ax2.y*this.body1.inverseMass,this.ax1.z*this.body2.inverseMass+this.ax2.z*this.body1.inverseMass).normalize(),this.tan.tangent(this.nor).normalize(),this.bin.crossVectors(this.nor,this.tan),this.tmp.crossVectors(this.an1,this.an2);var e=T.acosClamp(T.dotVectors(this.an1,this.an2));T.dotVectors(this.nor,this.tmp)<0?this.rotationalLimitMotor.angle=-e:this.rotationalLimitMotor.angle=e,this.tmp.crossVectors(this.ax1,this.ax2),this.r3.limitMotor2.angle=T.dotVectors(this.tan,this.tmp),this.r3.limitMotor3.angle=T.dotVectors(this.bin,this.tmp),this.r3.preSolve(t,s),this.t3.preSolve(t,s)},solve:function(){this.r3.solve(),this.t3.solve()},postSolve:function(){}}),Ge.prototype=Object.assign(Object.create(Rs.prototype),{constructor:Ge,preSolve:function(t,s){this.updateAnchorPoints(),this.ax1.copy(this.localAxis1).applyMatrix3(this.body1.rotation,!0),this.an1.copy(this.localAngle1).applyMatrix3(this.body1.rotation,!0),this.ax2.copy(this.localAxis2).applyMatrix3(this.body2.rotation,!0),this.an2.copy(this.localAngle2).applyMatrix3(this.body2.rotation,!0),this.r3.limitMotor1.angle=T.dotVectors(this.ax1,this.ax2);var e=T.dotVectors(this.an1,this.ax2);T.dotVectors(this.ax1,this.tmp.crossVectors(this.an1,this.ax2))<0?this.rotationalLimitMotor1.angle=-e:this.rotationalLimitMotor1.angle=e,e=T.dotVectors(this.an2,this.ax1),T.dotVectors(this.ax2,this.tmp.crossVectors(this.an2,this.ax1))<0?this.rotationalLimitMotor2.angle=-e:this.rotationalLimitMotor2.angle=e,this.nor.crossVectors(this.ax1,this.ax2).normalize(),this.tan.crossVectors(this.nor,this.ax2).normalize(),this.bin.crossVectors(this.nor,this.ax1).normalize(),this.r3.preSolve(t,s),this.t3.preSolve(t,s)},solve:function(){this.r3.solve(),this.t3.solve()},postSolve:function(){}}),gn.prototype={constructor:gn,reset:function(t,s){this.body1=t.parent,this.body2=s.parent,this.numPoints=0},addPointVec:function(t,s,e,n){var o=this.points[this.numPoints++];o.position.copy(t),o.localPoint1.sub(t,this.body1.position).applyMatrix3(this.body1.rotation),o.localPoint2.sub(t,this.body2.position).applyMatrix3(this.body2.rotation),o.normal.copy(s),n&&o.normal.negate(),o.normalImpulse=0,o.penetration=e,o.warmStarted=!1},addPoint:function(t,s,e,n,o,a,l,d){var u=this.points[this.numPoints++];u.position.set(t,s,e),u.localPoint1.sub(u.position,this.body1.position).applyMatrix3(this.body1.rotation),u.localPoint2.sub(u.position,this.body2.position).applyMatrix3(this.body2.rotation),u.normalImpulse=0,u.normal.set(n,o,a),d&&u.normal.negate(),u.penetration=l,u.warmStarted=!1}},_n.prototype=Object.assign(Object.create(Te.prototype),{constructor:_n,attach:function(){this.p1=this.body1.position,this.p2=this.body2.position,this.lv1=this.body1.linearVelocity,this.av1=this.body1.angularVelocity,this.lv2=this.body2.linearVelocity,this.av2=this.body2.angularVelocity,this.i1=this.body1.inverseInertia,this.i2=this.body2.inverseInertia},detach:function(){this.p1=null,this.p2=null,this.lv1=null,this.lv2=null,this.av1=null,this.av2=null,this.i1=null,this.i2=null},preSolve:function(t,s){this.m1=this.body1.inverseMass,this.m2=this.body2.inverseMass;var e=this.m1+this.m2;this.num=this.manifold.numPoints;for(var n,o,a,l,d,u,p,c=this.cs,z=0;z<this.num;z++)n=this.ps[z],this.tmpP1.sub(n.position,this.p1),this.tmpP2.sub(n.position,this.p2),this.tmpC1.crossVectors(this.av1,this.tmpP1),this.tmpC2.crossVectors(this.av2,this.tmpP2),c.norImp=n.normalImpulse,c.tanImp=n.tangentImpulse,c.binImp=n.binormalImpulse,c.nor.copy(n.normal),this.tmp.set(this.lv2.x+this.tmpC2.x-(this.lv1.x+this.tmpC1.x),this.lv2.y+this.tmpC2.y-(this.lv1.y+this.tmpC1.y),this.lv2.z+this.tmpC2.z-(this.lv1.z+this.tmpC1.z)),o=T.dotVectors(c.nor,this.tmp),c.tan.set(this.tmp.x-o*c.nor.x,this.tmp.y-o*c.nor.y,this.tmp.z-o*c.nor.z),T.dotVectors(c.tan,c.tan)<=.04&&c.tan.tangent(c.nor),c.tan.normalize(),c.bin.crossVectors(c.nor,c.tan),c.norU1.scale(c.nor,this.m1),c.norU2.scale(c.nor,this.m2),c.tanU1.scale(c.tan,this.m1),c.tanU2.scale(c.tan,this.m2),c.binU1.scale(c.bin,this.m1),c.binU2.scale(c.bin,this.m2),c.norT1.crossVectors(this.tmpP1,c.nor),c.tanT1.crossVectors(this.tmpP1,c.tan),c.binT1.crossVectors(this.tmpP1,c.bin),c.norT2.crossVectors(this.tmpP2,c.nor),c.tanT2.crossVectors(this.tmpP2,c.tan),c.binT2.crossVectors(this.tmpP2,c.bin),u=this.i1,p=this.i2,c.norTU1.copy(c.norT1).applyMatrix3(u,!0),c.tanTU1.copy(c.tanT1).applyMatrix3(u,!0),c.binTU1.copy(c.binT1).applyMatrix3(u,!0),c.norTU2.copy(c.norT2).applyMatrix3(p,!0),c.tanTU2.copy(c.tanT2).applyMatrix3(p,!0),c.binTU2.copy(c.binT2).applyMatrix3(p,!0),this.tmpC1.crossVectors(c.norTU1,this.tmpP1),this.tmpC2.crossVectors(c.norTU2,this.tmpP2),this.tmp.add(this.tmpC1,this.tmpC2),c.norDen=1/(e+T.dotVectors(c.nor,this.tmp)),this.tmpC1.crossVectors(c.tanTU1,this.tmpP1),this.tmpC2.crossVectors(c.tanTU2,this.tmpP2),this.tmp.add(this.tmpC1,this.tmpC2),c.tanDen=1/(e+T.dotVectors(c.tan,this.tmp)),this.tmpC1.crossVectors(c.binTU1,this.tmpP1),this.tmpC2.crossVectors(c.binTU2,this.tmpP2),this.tmp.add(this.tmpC1,this.tmpC2),c.binDen=1/(e+T.dotVectors(c.bin,this.tmp)),n.warmStarted?(a=n.normalImpulse,this.lv1.addScaledVector(c.norU1,a),this.av1.addScaledVector(c.norTU1,a),this.lv2.subScaledVector(c.norU2,a),this.av2.subScaledVector(c.norTU2,a),c.norImp=a,c.tanImp=0,c.binImp=0,o=0):(c.norImp=0,c.tanImp=0,c.binImp=0),o>-1&&(o=0),(l=this.restitution*-o)<(d=-(n.penetration+.005)*s*.05)&&(l=d),c.norTar=l,c.last=z==this.num-1,c=c.next},solve:function(){var t,s,e,n,o,a,l,d,u;this.tmplv1.copy(this.lv1),this.tmplv2.copy(this.lv2),this.tmpav1.copy(this.av1),this.tmpav2.copy(this.av2);for(var p=this.cs;o=p.norImp,a=p.tanImp,l=p.binImp,d=-o*this.friction,this.tmp.sub(this.tmplv2,this.tmplv1),t=a,e=l,(u=(a+=s=(T.dotVectors(this.tmp,p.tan)+T.dotVectors(this.tmpav2,p.tanT2)-T.dotVectors(this.tmpav1,p.tanT1))*p.tanDen)*a+(l+=n=(T.dotVectors(this.tmp,p.bin)+T.dotVectors(this.tmpav2,p.binT2)-T.dotVectors(this.tmpav1,p.binT1))*p.binDen)*l)>d*d&&(a*=u=d/T.sqrt(u),l*=u),s=a-t,n=l-e,this.tmp.set(p.tanU1.x*s+p.binU1.x*n,p.tanU1.y*s+p.binU1.y*n,p.tanU1.z*s+p.binU1.z*n),this.tmplv1.addEqual(this.tmp),this.tmp.set(p.tanTU1.x*s+p.binTU1.x*n,p.tanTU1.y*s+p.binTU1.y*n,p.tanTU1.z*s+p.binTU1.z*n),this.tmpav1.addEqual(this.tmp),this.tmp.set(p.tanU2.x*s+p.binU2.x*n,p.tanU2.y*s+p.binU2.y*n,p.tanU2.z*s+p.binU2.z*n),this.tmplv2.subEqual(this.tmp),this.tmp.set(p.tanTU2.x*s+p.binTU2.x*n,p.tanTU2.y*s+p.binTU2.y*n,p.tanTU2.z*s+p.binTU2.z*n),this.tmpav2.subEqual(this.tmp),this.tmp.sub(this.tmplv2,this.tmplv1),t=o,(o+=s=(T.dotVectors(this.tmp,p.nor)+T.dotVectors(this.tmpav2,p.norT2)-T.dotVectors(this.tmpav1,p.norT1)-p.norTar)*p.norDen)>0&&(o=0),s=o-t,this.tmplv1.addScaledVector(p.norU1,s),this.tmpav1.addScaledVector(p.norTU1,s),this.tmplv2.subScaledVector(p.norU2,s),this.tmpav2.subScaledVector(p.norTU2,s),p.norImp=o,p.tanImp=a,p.binImp=l,!p.last;)p=p.next;this.lv1.copy(this.tmplv1),this.lv2.copy(this.tmplv2),this.av1.copy(this.tmpav1),this.av2.copy(this.tmpav2)},postSolve:function(){for(var t,s=this.cs,e=this.num;e--;)(t=this.ps[e]).normal.copy(s.nor),t.tangent.copy(s.tan),t.binormal.copy(s.bin),t.normalImpulse=s.norImp,t.tangentImpulse=s.tanImp,t.binormalImpulse=s.binImp,t.normalDenominator=s.norDen,t.tangentDenominator=s.tanDen,t.binormalDenominator=s.binDen,s=s.next}}),Object.assign(no.prototype,{Contact:!0,mixRestitution:function(t,s){return T.sqrt(t*s)},mixFriction:function(t,s){return T.sqrt(t*s)},updateManifold:function(){this.constraint.restitution=this.mixRestitution(this.shape1.restitution,this.shape2.restitution),this.constraint.friction=this.mixFriction(this.shape1.friction,this.shape2.friction);for(var t=this.manifold.numPoints,s=t;s--;){var e=this.buffer[s],n=this.points[s];e.lp1X=n.localPoint1.x,e.lp1Y=n.localPoint1.y,e.lp1Z=n.localPoint1.z,e.lp2X=n.localPoint2.x,e.lp2Y=n.localPoint2.y,e.lp2Z=n.localPoint2.z,e.impulse=n.normalImpulse}this.manifold.numPoints=0,this.detector.detectCollision(this.shape1,this.shape2,this.manifold);var o=this.manifold.numPoints;if(o==0)return this.touching=!1,this.close=!1,void(this.dist=T.INF);for((this.touching||this.dist<.001)&&(this.close=!0),this.touching=!0,s=o;s--;){for(var a=(n=this.points[s]).localPoint1.x,l=n.localPoint1.y,d=n.localPoint1.z,u=n.localPoint2.x,p=n.localPoint2.y,c=n.localPoint2.z,z=-1,f=4e-4,x=t;x--;){var b=(e=this.buffer[x]).lp1X-a,w=e.lp1Y-l,I=e.lp1Z-d,J=b*b+w*w+I*I,_=(b=e.lp2X-u)*b+(w=e.lp2Y-p)*w+(I=e.lp2Z-c)*I;J<_?J<f&&(f=J,z=x):_<f&&(f=_,z=x),f<this.dist&&(this.dist=f)}if(z!=-1){var q=this.buffer[z];this.buffer[z]=this.buffer[--t],this.buffer[t]=q,n.normalImpulse=q.impulse,n.warmStarted=!0}else n.normalImpulse=0,n.warmStarted=!1}},attach:function(t,s){this.shape1=t,this.shape2=s,this.body1=t.parent,this.body2=s.parent,this.manifold.body1=this.body1,this.manifold.body2=this.body2,this.constraint.body1=this.body1,this.constraint.body2=this.body2,this.constraint.attach(),this.s1Link.shape=s,this.s1Link.body=this.body2,this.s2Link.shape=t,this.s2Link.body=this.body1,t.contactLink!=null?(this.s1Link.next=t.contactLink).prev=this.s1Link:this.s1Link.next=null,t.contactLink=this.s1Link,t.numContacts++,s.contactLink!=null?(this.s2Link.next=s.contactLink).prev=this.s2Link:this.s2Link.next=null,s.contactLink=this.s2Link,s.numContacts++,this.b1Link.shape=s,this.b1Link.body=this.body2,this.b2Link.shape=t,this.b2Link.body=this.body1,this.body1.contactLink!=null?(this.b1Link.next=this.body1.contactLink).prev=this.b1Link:this.b1Link.next=null,this.body1.contactLink=this.b1Link,this.body1.numContacts++,this.body2.contactLink!=null?(this.b2Link.next=this.body2.contactLink).prev=this.b2Link:this.b2Link.next=null,this.body2.contactLink=this.b2Link,this.body2.numContacts++,this.prev=null,this.next=null,this.persisting=!0,this.sleeping=this.body1.sleeping&&this.body2.sleeping,this.manifold.numPoints=0},detach:function(){var t=this.s1Link.prev,s=this.s1Link.next;t!==null&&(t.next=s),s!==null&&(s.prev=t),this.shape1.contactLink==this.s1Link&&(this.shape1.contactLink=s),this.s1Link.prev=null,this.s1Link.next=null,this.s1Link.shape=null,this.s1Link.body=null,this.shape1.numContacts--,t=this.s2Link.prev,s=this.s2Link.next,t!==null&&(t.next=s),s!==null&&(s.prev=t),this.shape2.contactLink==this.s2Link&&(this.shape2.contactLink=s),this.s2Link.prev=null,this.s2Link.next=null,this.s2Link.shape=null,this.s2Link.body=null,this.shape2.numContacts--,t=this.b1Link.prev,s=this.b1Link.next,t!==null&&(t.next=s),s!==null&&(s.prev=t),this.body1.contactLink==this.b1Link&&(this.body1.contactLink=s),this.b1Link.prev=null,this.b1Link.next=null,this.b1Link.shape=null,this.b1Link.body=null,this.body1.numContacts--,t=this.b2Link.prev,s=this.b2Link.next,t!==null&&(t.next=s),s!==null&&(s.prev=t),this.body2.contactLink==this.b2Link&&(this.body2.contactLink=s),this.b2Link.prev=null,this.b2Link.next=null,this.b2Link.shape=null,this.b2Link.body=null,this.body2.numContacts--,this.manifold.body1=null,this.manifold.body2=null,this.constraint.body1=null,this.constraint.body2=null,this.constraint.detach(),this.shape1=null,this.shape2=null,this.body1=null,this.body2=null}}),Object.assign(Ne.prototype,{setParent:function(t){this.parent=t,this.scale=this.parent.scale,this.invScale=this.parent.invScale,this.id=this.parent.numRigidBodies,this.name||(this.name=this.id),this.updateMesh()},addShape:function(t){t.parent&&bs("RigidBody","It is not possible that you add a shape which already has an associated body."),this.shapes!=null&&((this.shapes.prev=t).next=this.shapes),this.shapes=t,t.parent=this,this.parent&&this.parent.addShape(t),this.numShapes++},removeShape:function(t){var s=t;if(s.parent==this){var e=s.prev,n=s.next;e!=null&&(e.next=n),n!=null&&(n.prev=e),this.shapes==s&&(this.shapes=n),s.prev=null,s.next=null,s.parent=null,this.parent&&this.parent.removeShape(s),this.numShapes--}},remove:function(){this.dispose()},dispose:function(){this.parent.removeRigidBody(this)},checkContact:function(t){this.parent.checkContact(this.name,t)},setupMass:function(t,s){var e=s===void 0||s;this.type=t||2,this.isDynamic=this.type===1,this.isStatic=this.type===2,this.mass=0,this.localInertia.set(0,0,0,0,0,0,0,0,0);for(var n=new xs,o=new $,a=this.shapes;a!==null;a=a.next){a.calculateMassInfo(this.massInfo);var l=this.massInfo.mass;o.addScaledVector(a.relativePosition,l),this.mass+=l,this.rotateInertia(a.relativeRotation,this.massInfo.inertia,n),this.localInertia.add(n),this.localInertia.addOffset(l,a.relativePosition)}if(this.inverseMass=1/this.mass,o.scaleEqual(this.inverseMass),e){for(this.position.add(o),a=this.shapes;a!==null;a=a.next)a.relativePosition.subEqual(o);this.localInertia.subOffset(this.mass,o)}this.inverseLocalInertia.invert(this.localInertia),this.type===2&&(this.inverseMass=0,this.inverseLocalInertia.set(0,0,0,0,0,0,0,0,0)),this.syncShapes(),this.awake()},awake:function(){if(this.allowSleep&&this.sleeping){this.sleeping=!1,this.sleepTime=0;for(var t=this.contactLink;t!=null;)t.body.sleepTime=0,t.body.sleeping=!1,t=t.next;for(var s=this.jointLink;s!=null;)s.body.sleepTime=0,s.body.sleeping=!1,s=s.next;for(var e=this.shapes;e!=null;e=e.next)e.updateProxy()}},sleep:function(){if(this.allowSleep&&!this.sleeping){this.linearVelocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.sleepPosition.copy(this.position),this.sleepOrientation.copy(this.orientation),this.sleepTime=0,this.sleeping=!0;for(var t=this.shapes;t!=null;t=t.next)t.updateProxy()}},testWakeUp:function(){(this.linearVelocity.testZero()||this.angularVelocity.testZero()||this.position.testDiff(this.sleepPosition)||this.orientation.testDiff(this.sleepOrientation))&&this.awake()},isLonely:function(){return this.numJoints==0&&this.numContacts==0},updatePosition:function(t){switch(this.type){case 2:this.linearVelocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.controlPos&&(this.position.copy(this.newPosition),this.controlPos=!1),this.controlRot&&(this.orientation.copy(this.newOrientation),this.controlRot=!1);break;case 1:this.isKinematic&&(this.linearVelocity.set(0,0,0),this.angularVelocity.set(0,0,0)),this.controlPos&&(this.linearVelocity.subVectors(this.newPosition,this.position).multiplyScalar(1/t),this.controlPos=!1),this.controlRot&&(this.angularVelocity.copy(this.getAxis()),this.orientation.copy(this.newOrientation),this.controlRot=!1),this.position.addScaledVector(this.linearVelocity,t),this.orientation.addTime(this.angularVelocity,t),this.updateMesh();break;default:bs("RigidBody","Invalid type.")}this.syncShapes(),this.updateMesh()},getAxis:function(){return new $(0,1,0).applyMatrix3(this.inverseLocalInertia,!0).normalize()},rotateInertia:function(t,s,e){this.tmpInertia.multiplyMatrices(t,s),e.multiplyMatrices(this.tmpInertia,t,!0)},syncShapes:function(){this.rotation.setQuat(this.orientation),this.rotateInertia(this.rotation,this.inverseLocalInertia,this.inverseInertia);for(var t=this.shapes;t!=null;t=t.next)t.position.copy(t.relativePosition).applyMatrix3(this.rotation,!0).add(this.position),t.rotation.multiplyMatrices(this.rotation,t.relativeRotation),t.updateProxy()},applyImpulse:function(t,s){this.linearVelocity.addScaledVector(s,this.inverseMass);var e=new $().copy(t).sub(this.position).cross(s).applyMatrix3(this.inverseInertia,!0);this.angularVelocity.add(e)},setPosition:function(t){this.newPosition.copy(t).multiplyScalar(this.invScale),this.controlPos=!0,this.isKinematic||(this.isKinematic=!0)},setQuaternion:function(t){this.newOrientation.set(t.x,t.y,t.z,t.w),this.controlRot=!0,this.isKinematic||(this.isKinematic=!0)},setRotation:function(t){this.newOrientation=new ks().setFromEuler(t.x*T.degtorad,t.y*T.degtorad,t.z*T.degtorad),this.controlRot=!0},resetPosition:function(t,s,e){this.linearVelocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.position.set(t,s,e).multiplyScalar(this.invScale),this.awake()},resetQuaternion:function(t){this.angularVelocity.set(0,0,0),this.orientation=new ks(t.x,t.y,t.z,t.w),this.awake()},resetRotation:function(t,s,e){this.angularVelocity.set(0,0,0),this.orientation=new ks().setFromEuler(t*T.degtorad,s*T.degtorad,e*T.degtorad),this.awake()},getPosition:function(){return this.pos},getQuaternion:function(){return this.quaternion},connectMesh:function(t){this.mesh=t,this.updateMesh()},updateMesh:function(){this.pos.scale(this.position,this.scale),this.quaternion.copy(this.orientation),this.mesh!==null&&(this.mesh.position.copy(this.getPosition()),this.mesh.quaternion.copy(this.getQuaternion()))}}),Object.assign(we.prototype,{BroadPhase:!0,createProxy:function(t){bs("BroadPhase","Inheritance error.")},addProxy:function(t){bs("BroadPhase","Inheritance error.")},removeProxy:function(t){bs("BroadPhase","Inheritance error.")},isAvailablePair:function(t,s){var e,n=t.parent,o=s.parent;if(n==o||!n.isDynamic&&!o.isDynamic||!(t.belongsTo&s.collidesWith)||!(s.belongsTo&t.collidesWith))return!1;for(e=n.numJoints<o.numJoints?n.jointLink:o.jointLink;e!==null;){var a=e.joint;if(!a.allowCollision&&(a.body1==n&&a.body2==o||a.body1==o&&a.body2==n))return!1;e=e.next}return!0},detectPairs:function(){this.pairs=[],this.numPairs=0,this.numPairChecks=0,this.collectPairs()},collectPairs:function(){},addPair:function(t,s){var e=new Fo(t,s);this.pairs.push(e),this.numPairs++}});var Ho=0;function Le(t){this.shape=t,this.aabb=t.aabb}function Nn(t){Le.call(this,t),this.id=Ho++}function wn(){we.call(this),this.types=W,this.proxies=[]}function Me(){this.numElements=0,this.bufferSize=256,this.elements=[],this.elements.length=this.bufferSize,this.stack=new Float32Array(64)}function $e(t,s){this.proxy=t,this.pair=null,this.min1=null,this.max1=null,this.min2=null,this.max2=null,this.max=s,this.value=0}function Ln(t,s){Le.call(this,s),this.belongsTo=0,this.max=[],this.min=[],this.sap=t,this.min[0]=new $e(this,!1),this.max[0]=new $e(this,!0),this.min[1]=new $e(this,!1),this.max[1]=new $e(this,!0),this.min[2]=new $e(this,!1),this.max[2]=new $e(this,!0),this.max[0].pair=this.min[0],this.max[1].pair=this.min[1],this.max[2].pair=this.min[2],this.min[0].min1=this.min[1],this.min[0].max1=this.max[1],this.min[0].min2=this.min[2],this.min[0].max2=this.max[2],this.min[1].min1=this.min[0],this.min[1].max1=this.max[0],this.min[1].min2=this.min[2],this.min[1].max2=this.max[2],this.min[2].min1=this.min[0],this.min[2].max1=this.max[0],this.min[2].min2=this.min[1],this.min[2].max2=this.max[1]}function Mn(){we.call(this),this.types=F,this.numElementsD=0,this.numElementsS=0,this.axesD=[new Me,new Me,new Me],this.axesS=[new Me,new Me,new Me],this.index1=0,this.index2=1}function oo(){this.child1=null,this.child2=null,this.parent=null,this.proxy=null,this.height=0,this.aabb=new je}function ao(){this.root=null,this.freeNodes=[],this.freeNodes.length=16384,this.numFreeNodes=0,this.aabb=new je}function Vn(t){Le.call(this,t),this.leaf=new oo,this.leaf.proxy=this}function Pn(){we.call(this),this.types=_t,this.tree=new ao,this.stack=[],this.leaves=[],this.numLeaves=0}function gs(){this.flip=!1}function Sn(){gs.call(this),this.clipVertices1=new Float32Array(24),this.clipVertices2=new Float32Array(24),this.used=new Float32Array(8),this.INF=1/0}function sn(t){gs.call(this),this.flip=t}function In(){gs.call(this)}function en(t){gs.call(this),this.flip=t}function nn(t){gs.call(this),this.flip=t}function $n(){gs.call(this)}function on(t){gs.call(this),this.flip=t,this.n=new $,this.p=new $}function an(t){gs.call(this),this.flip=t,this.n=new $,this.p=new $,this.dix=new $,this.diy=new $,this.diz=new $,this.cc=new $,this.cc2=new $}function ho(t){switch(t instanceof Object||(t={}),this.scale=t.worldscale||1,this.invScale=1/this.scale,this.timeStep=t.timestep||.01666,this.timerate=1e3*this.timeStep,this.timer=null,this.preLoop=null,this.postLoop=null,this.numIterations=t.iterations||8,t.broadphase||2){case 1:this.broadPhase=new wn;break;case 2:default:this.broadPhase=new Mn;break;case 3:this.broadPhase=new Pn}this.Btypes=["None","BruteForce","Sweep & Prune","Bounding Volume Tree"],this.broadPhaseType=this.Btypes[t.broadphase||2],this.performance=null,this.isStat=t.info!==void 0&&t.info,this.isStat&&(this.performance=new bn(this)),this.enableRandomizer=t.random===void 0||t.random,this.rigidBodies=null,this.numRigidBodies=0,this.contacts=null,this.unusedContacts=null,this.numContacts=0,this.numContactPoints=0,this.joints=null,this.numJoints=0,this.numIslands=0,this.gravity=new $(0,-9.8,0),t.gravity!==void 0&&this.gravity.fromArray(t.gravity),this.detectors=[],this.detectors.length=5;for(var s=5;s--;)this.detectors[s]=[],this.detectors[s].length=5;this.detectors[At][At]=new $n,this.detectors[At][Xt]=new en(!1),this.detectors[Xt][At]=new en(!0),this.detectors[Xt][Xt]=new Sn,this.detectors[Li][Li]=new In,this.detectors[Li][Xt]=new sn(!0),this.detectors[Xt][Li]=new sn(!1),this.detectors[Li][At]=new nn(!0),this.detectors[At][Li]=new nn(!1),this.detectors[Ei][At]=new on(!0),this.detectors[At][Ei]=new on(!1),this.detectors[Ei][Xt]=new an(!0),this.detectors[Xt][Ei]=new an(!1),this.randX=65535,this.randA=98765,this.randB=123456789,this.islandRigidBodies=[],this.islandStack=[],this.islandConstraints=[]}Object.assign(Le.prototype,{Proxy:!0,update:function(){bs("Proxy","Inheritance error.")}}),Nn.prototype=Object.assign(Object.create(Le.prototype),{constructor:Nn,update:function(){}}),wn.prototype=Object.assign(Object.create(we.prototype),{constructor:wn,createProxy:function(t){return new Nn(t)},addProxy:function(t){this.proxies.push(t)},removeProxy:function(t){var s=this.proxies.indexOf(t);s>-1&&this.proxies.splice(s,1)},collectPairs:function(){var t,s,e,n=0,o=this.proxies,a=o.length;for(this.numPairChecks=a*(a-1)>>1;n<a;)for(s=o[n++],t=n+1;t<a;)e=o[t++],!s.aabb.intersectTest(e.aabb)&&this.isAvailablePair(s.shape,e.shape)&&this.addPair(s.shape,e.shape)}}),Object.assign(Me.prototype,{SAPAxis:!0,addElements:function(t,s){if(this.numElements+2>=this.bufferSize){this.bufferSize*=2;for(var e=[],n=this.numElements;n--;)e[n]=this.elements[n]}this.elements[this.numElements++]=t,this.elements[this.numElements++]=s},removeElements:function(t,s){for(var e=-1,n=-1,o=0,a=this.numElements;o<a;o++){var l=this.elements[o];if(l==t||l==s){if(e!=-1){n=o;break}e=o}}for(o=e+1,a=n;o<a;o++)this.elements[o-1]=this.elements[o];for(o=n+1,a=this.numElements;o<a;o++)this.elements[o-2]=this.elements[o];this.elements[--this.numElements]=null,this.elements[--this.numElements]=null},sort:function(){for(var t=0,s=1;this.numElements>>s;)s++;s=s*this.numElements>>2,t=0;for(var e=!1,n=this.elements,o=1,a=this.numElements;o<a;o++){var l=n[o],d=l.value,u=n[o-1];if(u.value>d){var p=o;do{if(n[p]=u,--p==0)break;u=n[p-1]}while(u.value>d);if(n[p]=l,(t+=o-p)>s){e=!0;break}}}if(e){t=2;var c=this.stack;for(c[0]=0,c[1]=this.numElements-1;t>0;){var z=c[--t],f=c[--t],x=z-f;if(x>16){var b=f+T.floor(.5*x);for(l=n[b],n[b]=n[z],n[z]=l,d=l.value,o=f-1,p=z;;){var w,I;do w=n[++o];while(w.value<d);do I=n[--p];while(d<I.value&&p!=f);if(o>=p)break;n[o]=I,n[p]=w}n[z]=n[o],n[o]=l,o-f>z-o?(c[t++]=f,c[t++]=o-1,c[t++]=o+1,c[t++]=z):(c[t++]=o+1,c[t++]=z,c[t++]=f,c[t++]=o-1)}else for(o=f+1;o<=z;o++)if(d=(l=n[o]).value,(u=n[o-1]).value>d){p=o;do{if(n[p]=u,--p==0)break;u=n[p-1]}while(u.value>d);n[p]=l}}}},calculateTestCount:function(){for(var t=1,s=0,e=1,n=this.numElements;e<n;e++)this.elements[e].max?t--:(s+=t,t++);return s}}),Ln.prototype=Object.assign(Object.create(Le.prototype),{constructor:Ln,isDynamic:function(){var t=this.shape.parent;return t.isDynamic&&!t.sleeping},update:function(){var t=this.aabb.elements;this.min[0].value=t[0],this.min[1].value=t[1],this.min[2].value=t[2],this.max[0].value=t[3],this.max[1].value=t[4],this.max[2].value=t[5],(this.belongsTo==1&&!this.isDynamic()||this.belongsTo==2&&this.isDynamic())&&(this.sap.removeProxy(this),this.sap.addProxy(this))}}),Mn.prototype=Object.assign(Object.create(we.prototype),{constructor:Mn,createProxy:function(t){return new Ln(this,t)},addProxy:function(t){var s=t;s.isDynamic()?(this.axesD[0].addElements(s.min[0],s.max[0]),this.axesD[1].addElements(s.min[1],s.max[1]),this.axesD[2].addElements(s.min[2],s.max[2]),s.belongsTo=1,this.numElementsD+=2):(this.axesS[0].addElements(s.min[0],s.max[0]),this.axesS[1].addElements(s.min[1],s.max[1]),this.axesS[2].addElements(s.min[2],s.max[2]),s.belongsTo=2,this.numElementsS+=2)},removeProxy:function(t){var s=t;if(s.belongsTo!=0){switch(s.belongsTo){case 1:this.axesD[0].removeElements(s.min[0],s.max[0]),this.axesD[1].removeElements(s.min[1],s.max[1]),this.axesD[2].removeElements(s.min[2],s.max[2]),this.numElementsD-=2;break;case 2:this.axesS[0].removeElements(s.min[0],s.max[0]),this.axesS[1].removeElements(s.min[1],s.max[1]),this.axesS[2].removeElements(s.min[2],s.max[2]),this.numElementsS-=2}s.belongsTo=0}},collectPairs:function(){if(this.numElementsD!=0){var t,s,e,n,o=this.axesD[this.index1],a=this.axesD[this.index2];o.sort(),a.sort(),o.calculateTestCount()<=a.calculateTestCount()?((a=this.axesS[this.index1]).sort(),t=o.elements,s=a.elements):((o=this.axesS[this.index2]).sort(),t=a.elements,s=o.elements,this.index1^=this.index2,this.index2^=this.index1,this.index1^=this.index2);for(var l=0,d=0;l<this.numElementsD;){var u,p;if(d==this.numElementsS)u=t[l],p=!0,l++;else{var c=t[l],z=s[d];c.value<z.value?(u=c,p=!0,l++):(u=z,p=!1,d++)}if(u.max){var f=u.pair;if(p){if(f==e){e=e.pair;continue}u=e}else{if(f==n){n=n.pair;continue}u=n}for(;u;){if((_=u.pair)==f){u.pair=_.pair;break}u=_}}else{for(var x=u.proxy.shape,b=u.min1.value,w=u.max1.value,I=u.min2.value,J=u.max2.value,_=e;_!=null;_=_.pair){var q=_.proxy.shape;this.numPairChecks++,b>_.max1.value||w<_.min1.value||I>_.max2.value||J<_.min2.value||!this.isAvailablePair(x,q)||this.addPair(x,q)}if(p){for(_=n;_!=null;_=_.pair)q=_.proxy.shape,this.numPairChecks++,b>_.max1.value||w<_.min1.value||I>_.max2.value||J<_.min2.value||!this.isAvailablePair(x,q)||this.addPair(x,q);u.pair=e,e=u}else u.pair=n,n=u}}this.index2=3^(this.index1|this.index2)}}}),Object.assign(ao.prototype,{DBVT:!0,moveLeaf:function(t){this.deleteLeaf(t),this.insertLeaf(t)},insertLeaf:function(t){if(this.root!=null){for(var s,e,n=t.aabb,o=this.root;o.proxy==null;){var a=o.child1,l=o.child2,d=o.aabb,u=a.aabb,p=l.aabb;s=d.surfaceArea(),this.aabb.combine(n,d);var c=2*(e=this.aabb.surfaceArea()),z=2*(e-s),f=z;this.aabb.combine(n,u),a.proxy!=null?f+=this.aabb.surfaceArea():f+=this.aabb.surfaceArea()-u.surfaceArea();var x=z;if(this.aabb.combine(n,p),l.proxy!=null?x+=this.aabb.surfaceArea():x+=this.aabb.surfaceArea()-p.surfaceArea(),f<x){if(c<f)break;o=a}else{if(c<x)break;o=l}}var b,w=o.parent;(b=this.numFreeNodes>0?this.freeNodes[--this.numFreeNodes]:new oo).parent=w,b.child1=t,b.child2=o,b.aabb.combine(t.aabb,o.aabb),b.height=o.height+1,o.parent=b,t.parent=b,o==this.root?this.root=b:w.child1==o?w.child1=b:w.child2=b;do b=this.balance(b),this.fix(b),b=b.parent;while(b!=null)}else this.root=t},getBalance:function(t){return t.proxy!=null?0:t.child1.height-t.child2.height},deleteLeaf:function(t){if(t!=this.root){var s,e=t.parent;if(s=e.child1==t?e.child2:e.child1,e==this.root)return this.root=s,void(s.parent=null);var n=e.parent;s.parent=n,n.child1==e?n.child1=s:n.child2=s,this.numFreeNodes<16384&&(this.freeNodes[this.numFreeNodes++]=e);do n=this.balance(n),this.fix(n),n=n.parent;while(n!=null)}else this.root=null},balance:function(t){var s=t.height;if(s<2)return t;var e,n=t.parent,o=t.child1,a=t.child2,l=o.height,d=a.height,u=l-d;if(u>1){var p=o.child1,c=o.child2,z=p.height,f=c.height;return z>f?(o.child2=t,t.parent=o,t.child1=c,c.parent=t,t.aabb.combine(c.aabb,a.aabb),e=f-d,t.height=f-(e&e>>31)+1,o.aabb.combine(p.aabb,t.aabb),e=z-s,o.height=z-(e&e>>31)+1):(o.child1=t,t.parent=o,t.child1=p,p.parent=t,t.aabb.combine(p.aabb,a.aabb),e=z-d,t.height=z-(e&e>>31)+1,o.aabb.combine(t.aabb,c.aabb),e=s-f,o.height=s-(e&e>>31)+1),n!=null?n.child1==t?n.child1=o:n.child2=o:this.root=o,o.parent=n,o}if(u<-1){var x=a.child1,b=a.child2,w=x.height,I=b.height;return w>I?(a.child2=t,t.parent=a,t.child2=b,b.parent=t,t.aabb.combine(o.aabb,b.aabb),e=l-I,t.height=l-(e&e>>31)+1,a.aabb.combine(x.aabb,t.aabb),e=w-s,a.height=w-(e&e>>31)+1):(a.child1=t,t.parent=a,t.child2=x,x.parent=t,t.aabb.combine(o.aabb,x.aabb),e=l-w,t.height=l-(e&e>>31)+1,a.aabb.combine(t.aabb,b.aabb),e=s-I,a.height=s-(e&e>>31)+1),n!=null?n.child1==t?n.child1=a:n.child2=a:this.root=a,a.parent=n,a}return t},fix:function(t){var s=t.child1,e=t.child2;t.aabb.combine(s.aabb,e.aabb),t.height=s.height<e.height?e.height+1:s.height+1}}),Vn.prototype=Object.assign(Object.create(Le.prototype),{constructor:Vn,update:function(){}}),Pn.prototype=Object.assign(Object.create(we.prototype),{constructor:Pn,createProxy:function(t){return new Vn(t)},addProxy:function(t){this.tree.insertLeaf(t.leaf),this.leaves.push(t.leaf),this.numLeaves++},removeProxy:function(t){this.tree.deleteLeaf(t.leaf);var s=this.leaves.indexOf(t.leaf);s>-1&&(this.leaves.splice(s,1),this.numLeaves--)},collectPairs:function(){if(!(this.numLeaves<2))for(var t,s=this.numLeaves;s--;)(t=this.leaves[s]).proxy.aabb.intersectTestTwo(t.aabb)&&(t.aabb.copy(t.proxy.aabb,.1),this.tree.deleteLeaf(t),this.tree.insertLeaf(t),this.collide(t,this.tree.root))},collide:function(t,s){var e,n,o,a,l,d,u=2;for(this.stack[0]=t,this.stack[1]=s;u>0;)if(o=this.stack[--u],a=this.stack[--u],l=o.proxy!=null,d=a.proxy!=null,this.numPairChecks++,l&&d){if((e=o.proxy.shape)==(n=a.proxy.shape)||e.aabb.intersectTest(n.aabb)||!this.isAvailablePair(e,n))continue;this.addPair(e,n)}else{if(o.aabb.intersectTest(a.aabb))continue;d||!l&&o.aabb.surfaceArea()>a.aabb.surfaceArea()?(this.stack[u++]=o.child1,this.stack[u++]=a,this.stack[u++]=o.child2,this.stack[u++]=a):(this.stack[u++]=o,this.stack[u++]=a.child1,this.stack[u++]=o,this.stack[u++]=a.child2)}}}),Object.assign(gs.prototype,{CollisionDetector:!0,detectCollision:function(t,s,e){bs("CollisionDetector","Inheritance error.")}}),Sn.prototype=Object.assign(Object.create(gs.prototype),{constructor:Sn,detectCollision:function(t,s,e){var n,o;t.id<s.id?(n=t,o=s):(n=s,o=t);var a,l,d,u,p,c,z,f,x,b,w,I,J,_,q,R,tt,it,Z,pt,B,Y,st,H,X,et,Mt,_i,Ni,pi,P,Ht,g,k,G,V=n.elements,S=o.elements,It=n.dimentions,$t=o.dimentions,ct=n.position,ut=o.position,O=ct.x,nt=ct.y,dt=ct.z,ps=ut.x,wi=ut.y,Fi=ut.z,vi=ps-O,fi=wi-nt,kt=Fi-dt,lt=n.halfWidth,E=n.halfHeight,Q=n.halfDepth,yt=o.halfWidth,gi=o.halfHeight,qt=o.halfDepth,Vt=It[0],Ot=It[1],Dt=It[2],ht=It[3],ot=It[4],at=It[5],Wt=It[6],jt=It[7],Bt=It[8],oi=It[9],si=It[10],Tt=It[11],zt=It[12],Ct=It[13],Ii=It[14],Zt=It[15],xt=It[16],vt=It[17],mt=$t[0],ft=$t[1],Ut=$t[2],Rt=$t[3],Gt=$t[4],ui=$t[5],xi=$t[6],bi=$t[7],ki=$t[8],se=$t[9],Wi=$t[10],is=$t[11],ss=$t[12],Kt=$t[13],ds=$t[14],ys=$t[15],vs=$t[16],ni=$t[17],Qt=Ot*Ut-Dt*ft,$i=Dt*mt-Vt*Ut,ti=Vt*ft-Ot*mt,as=Ot*ui-Dt*Gt,hs=Dt*Rt-Vt*ui,rs=Vt*Gt-Ot*Rt,ls=Ot*ki-Dt*bi,cs=Dt*xi-Vt*ki,us=Vt*bi-Ot*xi,Oi=ot*Ut-at*ft,Di=at*mt-ht*Ut,Ji=ht*ft-ot*mt,_s=ot*ui-at*Gt,Ns=at*Rt-ht*ui,ws=ht*Gt-ot*Rt,Ls=ot*ki-at*bi,Ms=at*xi-ht*ki,Vs=ht*bi-ot*xi,Ps=jt*Ut-Bt*ft,Ss=Bt*mt-Wt*Ut,Is=Wt*ft-jt*mt,$s=jt*ui-Bt*Gt,Ts=Bt*Rt-Wt*ui,Cs=Wt*Gt-jt*Rt,rt=jt*ki-Bt*bi,ke=Bt*xi-Wt*ki,ze=Wt*bi-jt*xi,ro=!1,lo=!1,co=!1,uo=!1,mo=!1,po=!1,yo=!1,vo=!1,fo=!1;if((a=(P=Vt*vi+Ot*fi+Dt*kt)>0)||(P=-P),(g=Vt*mt+Ot*ft+Dt*Ut)<0&&(g=-g),(k=Vt*Rt+Ot*Gt+Dt*ui)<0&&(k=-k),(G=Vt*xi+Ot*bi+Dt*ki)<0&&(G=-G),!((R=P-(Ht=lt)-(g*yt+k*gi+G*qt))>0||((l=(P=ht*vi+ot*fi+at*kt)>0)||(P=-P),(g=ht*mt+ot*ft+at*Ut)<0&&(g=-g),(k=ht*Rt+ot*Gt+at*ui)<0&&(k=-k),(G=ht*xi+ot*bi+at*ki)<0&&(G=-G),(tt=P-(Ht=E)-(g*yt+k*gi+G*qt))>0||((d=(P=Wt*vi+jt*fi+Bt*kt)>0)||(P=-P),(g=Wt*mt+jt*ft+Bt*Ut)<0&&(g=-g),(k=Wt*Rt+jt*Gt+Bt*ui)<0&&(k=-k),(G=Wt*xi+jt*bi+Bt*ki)<0&&(G=-G),(it=P-(Ht=Q)-(g*yt+k*gi+G*qt))>0||((u=(P=mt*vi+ft*fi+Ut*kt)>0)||(P=-P),(g=mt*Vt+ft*Ot+Ut*Dt)<0&&(g=-g),(k=mt*ht+ft*ot+Ut*at)<0&&(k=-k),(G=mt*Wt+ft*jt+Ut*Bt)<0&&(G=-G),(Z=1*(P-(Ht=g*lt+k*E+G*Q)-yt))>0||((p=(P=Rt*vi+Gt*fi+ui*kt)>0)||(P=-P),(g=Rt*Vt+Gt*Ot+ui*Dt)<0&&(g=-g),(k=Rt*ht+Gt*ot+ui*at)<0&&(k=-k),(G=Rt*Wt+Gt*jt+ui*Bt)<0&&(G=-G),(pt=1*(P-(Ht=g*lt+k*E+G*Q)-gi))>0||((c=(P=xi*vi+bi*fi+ki*kt)>0)||(P=-P),(g=xi*Vt+bi*Ot+ki*Dt)<0&&(g=-g),(k=xi*ht+bi*ot+ki*at)<0&&(k=-k),(G=xi*Wt+bi*jt+ki*Bt)<0&&(G=-G),(B=1*(P-(Ht=g*lt+k*E+G*Q)-qt))>0))))))){if((P=Qt*Qt+$i*$i+ti*ti)>1e-5){if((z=(P=(Qt*=P=1/T.sqrt(P))*vi+($i*=P)*fi+(ti*=P)*kt)>0)||(P=-P),(g=Qt*ht+$i*ot+ti*at)<0&&(g=-g),(k=Qt*Wt+$i*jt+ti*Bt)<0&&(k=-k),Ht=g*E+k*Q,(g=Qt*Rt+$i*Gt+ti*ui)<0&&(g=-g),(k=Qt*xi+$i*bi+ti*ki)<0&&(k=-k),(Y=P-Ht-(g*gi+k*qt))>0)return}else z=!1,Y=0,ro=!0;if((P=as*as+hs*hs+rs*rs)>1e-5){if((f=(P=(as*=P=1/T.sqrt(P))*vi+(hs*=P)*fi+(rs*=P)*kt)>0)||(P=-P),(g=as*ht+hs*ot+rs*at)<0&&(g=-g),(k=as*Wt+hs*jt+rs*Bt)<0&&(k=-k),Ht=g*E+k*Q,(g=as*mt+hs*ft+rs*Ut)<0&&(g=-g),(k=as*xi+hs*bi+rs*ki)<0&&(k=-k),(st=P-Ht-(g*yt+k*qt))>0)return}else f=!1,st=0,lo=!0;if((P=ls*ls+cs*cs+us*us)>1e-5){if((x=(P=(ls*=P=1/T.sqrt(P))*vi+(cs*=P)*fi+(us*=P)*kt)>0)||(P=-P),(g=ls*ht+cs*ot+us*at)<0&&(g=-g),(k=ls*Wt+cs*jt+us*Bt)<0&&(k=-k),Ht=g*E+k*Q,(g=ls*mt+cs*ft+us*Ut)<0&&(g=-g),(k=ls*Rt+cs*Gt+us*ui)<0&&(k=-k),(H=P-Ht-(g*yt+k*gi))>0)return}else x=!1,H=0,co=!0;if((P=Oi*Oi+Di*Di+Ji*Ji)>1e-5){if((b=(P=(Oi*=P=1/T.sqrt(P))*vi+(Di*=P)*fi+(Ji*=P)*kt)>0)||(P=-P),(g=Oi*Vt+Di*Ot+Ji*Dt)<0&&(g=-g),(k=Oi*Wt+Di*jt+Ji*Bt)<0&&(k=-k),Ht=g*lt+k*Q,(g=Oi*Rt+Di*Gt+Ji*ui)<0&&(g=-g),(k=Oi*xi+Di*bi+Ji*ki)<0&&(k=-k),(X=P-Ht-(g*gi+k*qt))>0)return}else b=!1,X=0,uo=!0;if((P=_s*_s+Ns*Ns+ws*ws)>1e-5){if((w=(P=(_s*=P=1/T.sqrt(P))*vi+(Ns*=P)*fi+(ws*=P)*kt)>0)||(P=-P),(g=_s*Vt+Ns*Ot+ws*Dt)<0&&(g=-g),(k=_s*Wt+Ns*jt+ws*Bt)<0&&(k=-k),Ht=g*lt+k*Q,(g=_s*mt+Ns*ft+ws*Ut)<0&&(g=-g),(k=_s*xi+Ns*bi+ws*ki)<0&&(k=-k),(et=P-Ht-(g*yt+k*qt))>0)return}else w=!1,et=0,mo=!0;if((P=Ls*Ls+Ms*Ms+Vs*Vs)>1e-5){if((I=(P=(Ls*=P=1/T.sqrt(P))*vi+(Ms*=P)*fi+(Vs*=P)*kt)>0)||(P=-P),(g=Ls*Vt+Ms*Ot+Vs*Dt)<0&&(g=-g),(k=Ls*Wt+Ms*jt+Vs*Bt)<0&&(k=-k),Ht=g*lt+k*Q,(g=Ls*mt+Ms*ft+Vs*Ut)<0&&(g=-g),(k=Ls*Rt+Ms*Gt+Vs*ui)<0&&(k=-k),(Mt=P-Ht-(g*yt+k*gi))>0)return}else I=!1,Mt=0,po=!0;if((P=Ps*Ps+Ss*Ss+Is*Is)>1e-5){if((J=(P=(Ps*=P=1/T.sqrt(P))*vi+(Ss*=P)*fi+(Is*=P)*kt)>0)||(P=-P),(g=Ps*Vt+Ss*Ot+Is*Dt)<0&&(g=-g),(k=Ps*ht+Ss*ot+Is*at)<0&&(k=-k),Ht=g*lt+k*E,(g=Ps*Rt+Ss*Gt+Is*ui)<0&&(g=-g),(k=Ps*xi+Ss*bi+Is*ki)<0&&(k=-k),(_i=P-Ht-(g*gi+k*qt))>0)return}else J=!1,_i=0,yo=!0;if((P=$s*$s+Ts*Ts+Cs*Cs)>1e-5){if((_=(P=($s*=P=1/T.sqrt(P))*vi+(Ts*=P)*fi+(Cs*=P)*kt)>0)||(P=-P),(g=$s*Vt+Ts*Ot+Cs*Dt)<0&&(g=-g),(k=$s*ht+Ts*ot+Cs*at)<0&&(k=-k),Ht=g*lt+k*E,(g=$s*mt+Ts*ft+Cs*Ut)<0&&(g=-g),(k=$s*xi+Ts*bi+Cs*ki)<0&&(k=-k),(Ni=P-Ht-(g*yt+k*qt))>0)return}else _=!1,Ni=0,vo=!0;if((P=rt*rt+ke*ke+ze*ze)>1e-5){if((q=(P=(rt*=P=1/T.sqrt(P))*vi+(ke*=P)*fi+(ze*=P)*kt)>0)||(P=-P),(g=rt*Vt+ke*Ot+ze*Dt)<0&&(g=-g),(k=rt*ht+ke*ot+ze*at)<0&&(k=-k),Ht=g*lt+k*E,(g=rt*mt+ke*ft+ze*Ut)<0&&(g=-g),(k=rt*Rt+ke*Gt+ze*ui)<0&&(k=-k),(pi=P-Ht-(g*yt+k*gi))>0)return}else q=!1,pi=0,fo=!0;var zs=R,Bi=R,Mi=0,fs=a;tt>Bi&&(zs=tt,Bi=tt,Mi=1,fs=l),it>Bi&&(zs=it,Bi=it,Mi=2,fs=d),Z>Bi&&(zs=Z,Bi=Z,Mi=3,fs=u),pt>Bi&&(zs=pt,Bi=pt,Mi=4,fs=p),B>Bi&&(zs=B,Bi=B,Mi=5,fs=c),Y-.01>Bi&&!ro&&(zs=Y,Bi=Y-.01,Mi=6,fs=z),st-.01>Bi&&!lo&&(zs=st,Bi=st-.01,Mi=7,fs=f),H-.01>Bi&&!co&&(zs=H,Bi=H-.01,Mi=8,fs=x),X-.01>Bi&&!uo&&(zs=X,Bi=X-.01,Mi=9,fs=b),et-.01>Bi&&!mo&&(zs=et,Bi=et-.01,Mi=10,fs=w),Mt-.01>Bi&&!po&&(zs=Mt,Bi=Mt-.01,Mi=11,fs=I),_i-.01>Bi&&!yo&&(zs=_i,Bi=_i-.01,Mi=12,fs=J),Ni-.01>Bi&&!vo&&(zs=Ni,Bi=Ni-.01,Mi=13,fs=_),pi-.01>Bi&&!fo&&(zs=pi,Mi=14,fs=q);var Nt=0,wt=0,Lt=0,Zi=0,Ki=0,Gi=0,es=0,ns=0,os=0,Hi=0,Ui=0,Ri=0,ee=0,ne=0,oe=0,ae=0,he=0,re=0,Ce=!1;if(Mi==0?(fs?(Hi=O+oi,Ui=nt+si,Ri=dt+Tt,Nt=Vt,wt=Ot,Lt=Dt):(Hi=O-oi,Ui=nt-si,Ri=dt-Tt,Nt=-Vt,wt=-Ot,Lt=-Dt),ee=zt,ne=Ct,oe=Ii,Zi=-ht,Ki=-ot,Gi=-at,ae=Zt,he=xt,re=vt,es=-Wt,ns=-jt,os=-Bt):Mi==1?(fs?(Hi=O+zt,Ui=nt+Ct,Ri=dt+Ii,Nt=ht,wt=ot,Lt=at):(Hi=O-zt,Ui=nt-Ct,Ri=dt-Ii,Nt=-ht,wt=-ot,Lt=-at),ee=oi,ne=si,oe=Tt,Zi=-Vt,Ki=-Ot,Gi=-Dt,ae=Zt,he=xt,re=vt,es=-Wt,ns=-jt,os=-Bt):Mi==2?(fs?(Hi=O+Zt,Ui=nt+xt,Ri=dt+vt,Nt=Wt,wt=jt,Lt=Bt):(Hi=O-Zt,Ui=nt-xt,Ri=dt-vt,Nt=-Wt,wt=-jt,Lt=-Bt),ee=oi,ne=si,oe=Tt,Zi=-Vt,Ki=-Ot,Gi=-Dt,ae=zt,he=Ct,re=Ii,es=-ht,ns=-ot,os=-at):Mi==3?(Ce=!0,fs?(Hi=ps-se,Ui=wi-Wi,Ri=Fi-is,Nt=-mt,wt=-ft,Lt=-Ut):(Hi=ps+se,Ui=wi+Wi,Ri=Fi+is,Nt=mt,wt=ft,Lt=Ut),ee=ss,ne=Kt,oe=ds,Zi=-Rt,Ki=-Gt,Gi=-ui,ae=ys,he=vs,re=ni,es=-xi,ns=-bi,os=-ki):Mi==4?(Ce=!0,fs?(Hi=ps-ss,Ui=wi-Kt,Ri=Fi-ds,Nt=-Rt,wt=-Gt,Lt=-ui):(Hi=ps+ss,Ui=wi+Kt,Ri=Fi+ds,Nt=Rt,wt=Gt,Lt=ui),ee=se,ne=Wi,oe=is,Zi=-mt,Ki=-ft,Gi=-Ut,ae=ys,he=vs,re=ni,es=-xi,ns=-bi,os=-ki):Mi==5?(Ce=!0,fs?(Hi=ps-ys,Ui=wi-vs,Ri=Fi-ni,Nt=-xi,wt=-bi,Lt=-ki):(Hi=ps+ys,Ui=wi+vs,Ri=Fi+ni,Nt=xi,wt=bi,Lt=ki),ee=se,ne=Wi,oe=is,Zi=-mt,Ki=-ft,Gi=-Ut,ae=ss,he=Kt,re=ds,es=-Rt,ns=-Gt,os=-ui):Mi==6?(Nt=Qt,wt=$i,Lt=ti,Zi=Vt,Ki=Ot,Gi=Dt,es=mt,ns=ft,os=Ut):Mi==7?(Nt=as,wt=hs,Lt=rs,Zi=Vt,Ki=Ot,Gi=Dt,es=Rt,ns=Gt,os=ui):Mi==8?(Nt=ls,wt=cs,Lt=us,Zi=Vt,Ki=Ot,Gi=Dt,es=xi,ns=bi,os=ki):Mi==9?(Nt=Oi,wt=Di,Lt=Ji,Zi=ht,Ki=ot,Gi=at,es=mt,ns=ft,os=Ut):Mi==10?(Nt=_s,wt=Ns,Lt=ws,Zi=ht,Ki=ot,Gi=at,es=Rt,ns=Gt,os=ui):Mi==11?(Nt=Ls,wt=Ms,Lt=Vs,Zi=ht,Ki=ot,Gi=at,es=xi,ns=bi,os=ki):Mi==12?(Nt=Ps,wt=Ss,Lt=Is,Zi=Wt,Ki=jt,Gi=Bt,es=mt,ns=ft,os=Ut):Mi==13?(Nt=$s,wt=Ts,Lt=Cs,Zi=Wt,Ki=jt,Gi=Bt,es=Rt,ns=Gt,os=ui):Mi==14&&(Nt=rt,wt=ke,Lt=ze,Zi=Wt,Ki=jt,Gi=Bt,es=xi,ns=bi,os=ki),Mi>5){var ji,Vi,Ti,Ci,Ai,le,ce,ue,ye,ve,fe;fs||(Nt=-Nt,wt=-wt,Lt=-Lt),Vi=Nt*(le=V[0])+wt*(ce=V[1])+Lt*(ue=V[2]),(ji=Nt*(Ti=V[3])+wt*(Ci=V[4])+Lt*(Ai=V[5]))>Vi&&(Vi=ji,le=Ti,ce=Ci,ue=Ai),(ji=Nt*(Ti=V[6])+wt*(Ci=V[7])+Lt*(Ai=V[8]))>Vi&&(Vi=ji,le=Ti,ce=Ci,ue=Ai),(ji=Nt*(Ti=V[9])+wt*(Ci=V[10])+Lt*(Ai=V[11]))>Vi&&(Vi=ji,le=Ti,ce=Ci,ue=Ai),(ji=Nt*(Ti=V[12])+wt*(Ci=V[13])+Lt*(Ai=V[14]))>Vi&&(Vi=ji,le=Ti,ce=Ci,ue=Ai),(ji=Nt*(Ti=V[15])+wt*(Ci=V[16])+Lt*(Ai=V[17]))>Vi&&(Vi=ji,le=Ti,ce=Ci,ue=Ai),(ji=Nt*(Ti=V[18])+wt*(Ci=V[19])+Lt*(Ai=V[20]))>Vi&&(Vi=ji,le=Ti,ce=Ci,ue=Ai),(ji=Nt*(Ti=V[21])+wt*(Ci=V[22])+Lt*(Ai=V[23]))>Vi&&(Vi=ji,le=Ti,ce=Ci,ue=Ai),Vi=Nt*(ye=S[0])+wt*(ve=S[1])+Lt*(fe=S[2]),(ji=Nt*(Ti=S[3])+wt*(Ci=S[4])+Lt*(Ai=S[5]))<Vi&&(Vi=ji,ye=Ti,ve=Ci,fe=Ai),(ji=Nt*(Ti=S[6])+wt*(Ci=S[7])+Lt*(Ai=S[8]))<Vi&&(Vi=ji,ye=Ti,ve=Ci,fe=Ai),(ji=Nt*(Ti=S[9])+wt*(Ci=S[10])+Lt*(Ai=S[11]))<Vi&&(Vi=ji,ye=Ti,ve=Ci,fe=Ai),(ji=Nt*(Ti=S[12])+wt*(Ci=S[13])+Lt*(Ai=S[14]))<Vi&&(Vi=ji,ye=Ti,ve=Ci,fe=Ai),(ji=Nt*(Ti=S[15])+wt*(Ci=S[16])+Lt*(Ai=S[17]))<Vi&&(Vi=ji,ye=Ti,ve=Ci,fe=Ai),(ji=Nt*(Ti=S[18])+wt*(Ci=S[19])+Lt*(Ai=S[20]))<Vi&&(Vi=ji,ye=Ti,ve=Ci,fe=Ai),(ji=Nt*(Ti=S[21])+wt*(Ci=S[22])+Lt*(Ai=S[23]))<Vi&&(Vi=ji,ye=Ti,ve=Ci,fe=Ai);var mi=((Ti=ye-le)*(Zi-es*(g=Zi*es+Ki*ns+Gi*os))+(Ci=ve-ce)*(Ki-ns*g)+(Ai=fe-ue)*(Gi-os*g))/(1-g*g);e.addPoint(le+Zi*mi+Nt*zs*.5,ce+Ki*mi+wt*zs*.5,ue+Gi*mi+Lt*zs*.5,Nt,wt,Lt,zs,!1)}else{var Ds,js,Bs,Es,Fs,Hs,qs,Ws,Js,Zs,Ks,Gs,Ys,ei,C,ai,hi,ri,Yi,Xi,Qi,Pi=1,Yt=0,ts=0;Ce?((Yt=Vt*Nt+Ot*wt+Dt*Lt)<Pi&&(Pi=Yt,ts=0),-Yt<Pi&&(Pi=-Yt,ts=1),(Yt=ht*Nt+ot*wt+at*Lt)<Pi&&(Pi=Yt,ts=2),-Yt<Pi&&(Pi=-Yt,ts=3),(Yt=Wt*Nt+jt*wt+Bt*Lt)<Pi&&(Pi=Yt,ts=4),-Yt<Pi&&(Pi=-Yt,ts=5),ts==0?(Ds=V[0],js=V[1],Bs=V[2],Es=V[6],Fs=V[7],Hs=V[8],qs=V[9],Ws=V[10],Js=V[11],Zs=V[3],Ks=V[4],Gs=V[5]):ts==1?(Ds=V[15],js=V[16],Bs=V[17],Es=V[21],Fs=V[22],Hs=V[23],qs=V[18],Ws=V[19],Js=V[20],Zs=V[12],Ks=V[13],Gs=V[14]):ts==2?(Ds=V[12],js=V[13],Bs=V[14],Es=V[0],Fs=V[1],Hs=V[2],qs=V[3],Ws=V[4],Js=V[5],Zs=V[15],Ks=V[16],Gs=V[17]):ts==3?(Ds=V[21],js=V[22],Bs=V[23],Es=V[9],Fs=V[10],Hs=V[11],qs=V[6],Ws=V[7],Js=V[8],Zs=V[18],Ks=V[19],Gs=V[20]):ts==4?(Ds=V[12],js=V[13],Bs=V[14],Es=V[18],Fs=V[19],Hs=V[20],qs=V[6],Ws=V[7],Js=V[8],Zs=V[0],Ks=V[1],Gs=V[2]):ts==5&&(Ds=V[3],js=V[4],Bs=V[5],Es=S[9],Fs=S[10],Hs=S[11],qs=V[21],Ws=V[22],Js=V[23],Zs=V[15],Ks=V[16],Gs=V[17])):((Yt=mt*Nt+ft*wt+Ut*Lt)<Pi&&(Pi=Yt,ts=0),-Yt<Pi&&(Pi=-Yt,ts=1),(Yt=Rt*Nt+Gt*wt+ui*Lt)<Pi&&(Pi=Yt,ts=2),-Yt<Pi&&(Pi=-Yt,ts=3),(Yt=xi*Nt+bi*wt+ki*Lt)<Pi&&(Pi=Yt,ts=4),-Yt<Pi&&(Pi=-Yt,ts=5),ts==0?(Ds=S[0],js=S[1],Bs=S[2],Es=S[6],Fs=S[7],Hs=S[8],qs=S[9],Ws=S[10],Js=S[11],Zs=S[3],Ks=S[4],Gs=S[5]):ts==1?(Ds=S[15],js=S[16],Bs=S[17],Es=S[21],Fs=S[22],Hs=S[23],qs=S[18],Ws=S[19],Js=S[20],Zs=S[12],Ks=S[13],Gs=S[14]):ts==2?(Ds=S[12],js=S[13],Bs=S[14],Es=S[0],Fs=S[1],Hs=S[2],qs=S[3],Ws=S[4],Js=S[5],Zs=S[15],Ks=S[16],Gs=S[17]):ts==3?(Ds=S[21],js=S[22],Bs=S[23],Es=S[9],Fs=S[10],Hs=S[11],qs=S[6],Ws=S[7],Js=S[8],Zs=S[18],Ks=S[19],Gs=S[20]):ts==4?(Ds=S[12],js=S[13],Bs=S[14],Es=S[18],Fs=S[19],Hs=S[20],qs=S[6],Ws=S[7],Js=S[8],Zs=S[0],Ks=S[1],Gs=S[2]):ts==5&&(Ds=S[3],js=S[4],Bs=S[5],Es=S[9],Fs=S[10],Hs=S[11],qs=S[21],Ws=S[22],Js=S[23],Zs=S[15],Ks=S[16],Gs=S[17])),this.clipVertices1[0]=Ds,this.clipVertices1[1]=js,this.clipVertices1[2]=Bs,this.clipVertices1[3]=Es,this.clipVertices1[4]=Fs,this.clipVertices1[5]=Hs,this.clipVertices1[6]=qs,this.clipVertices1[7]=Ws,this.clipVertices1[8]=Js,this.clipVertices1[9]=Zs,this.clipVertices1[10]=Ks,this.clipVertices1[11]=Gs,ei=0,g=((ai=this.clipVertices1[9])-Hi-ee)*Zi+((hi=this.clipVertices1[10])-Ui-ne)*Ki+((ri=this.clipVertices1[11])-Ri-oe)*Gi;for(var zi=0;zi<4;zi++)C=3*zi,k=((Yi=this.clipVertices1[C])-Hi-ee)*Zi+((Xi=this.clipVertices1[C+1])-Ui-ne)*Ki+((Qi=this.clipVertices1[C+2])-Ri-oe)*Gi,g>0?k>0?(C=3*ei,ei++,this.clipVertices2[C]=Yi,this.clipVertices2[C+1]=Xi,this.clipVertices2[C+2]=Qi):(C=3*ei,ei++,mi=g/(g-k),this.clipVertices2[C]=ai+(Yi-ai)*mi,this.clipVertices2[C+1]=hi+(Xi-hi)*mi,this.clipVertices2[C+2]=ri+(Qi-ri)*mi):k>0&&(C=3*ei,ei++,mi=g/(g-k),this.clipVertices2[C]=ai+(Yi-ai)*mi,this.clipVertices2[C+1]=hi+(Xi-hi)*mi,this.clipVertices2[C+2]=ri+(Qi-ri)*mi,C=3*ei,ei++,this.clipVertices2[C]=Yi,this.clipVertices2[C+1]=Xi,this.clipVertices2[C+2]=Qi),ai=Yi,hi=Xi,ri=Qi,g=k;if((Ys=ei)!=0){for(ei=0,C=3*(Ys-1),g=((ai=this.clipVertices2[C])-Hi-ae)*es+((hi=this.clipVertices2[C+1])-Ui-he)*ns+((ri=this.clipVertices2[C+2])-Ri-re)*os,zi=0;zi<Ys;zi++)C=3*zi,k=((Yi=this.clipVertices2[C])-Hi-ae)*es+((Xi=this.clipVertices2[C+1])-Ui-he)*ns+((Qi=this.clipVertices2[C+2])-Ri-re)*os,g>0?k>0?(C=3*ei,ei++,this.clipVertices1[C]=Yi,this.clipVertices1[C+1]=Xi,this.clipVertices1[C+2]=Qi):(C=3*ei,ei++,mi=g/(g-k),this.clipVertices1[C]=ai+(Yi-ai)*mi,this.clipVertices1[C+1]=hi+(Xi-hi)*mi,this.clipVertices1[C+2]=ri+(Qi-ri)*mi):k>0&&(C=3*ei,ei++,mi=g/(g-k),this.clipVertices1[C]=ai+(Yi-ai)*mi,this.clipVertices1[C+1]=hi+(Xi-hi)*mi,this.clipVertices1[C+2]=ri+(Qi-ri)*mi,C=3*ei,ei++,this.clipVertices1[C]=Yi,this.clipVertices1[C+1]=Xi,this.clipVertices1[C+2]=Qi),ai=Yi,hi=Xi,ri=Qi,g=k;if((Ys=ei)!=0){for(ei=0,C=3*(Ys-1),g=((ai=this.clipVertices1[C])-Hi+ee)*-Zi+((hi=this.clipVertices1[C+1])-Ui+ne)*-Ki+((ri=this.clipVertices1[C+2])-Ri+oe)*-Gi,zi=0;zi<Ys;zi++)C=3*zi,k=((Yi=this.clipVertices1[C])-Hi+ee)*-Zi+((Xi=this.clipVertices1[C+1])-Ui+ne)*-Ki+((Qi=this.clipVertices1[C+2])-Ri+oe)*-Gi,g>0?k>0?(C=3*ei,ei++,this.clipVertices2[C]=Yi,this.clipVertices2[C+1]=Xi,this.clipVertices2[C+2]=Qi):(C=3*ei,ei++,mi=g/(g-k),this.clipVertices2[C]=ai+(Yi-ai)*mi,this.clipVertices2[C+1]=hi+(Xi-hi)*mi,this.clipVertices2[C+2]=ri+(Qi-ri)*mi):k>0&&(C=3*ei,ei++,mi=g/(g-k),this.clipVertices2[C]=ai+(Yi-ai)*mi,this.clipVertices2[C+1]=hi+(Xi-hi)*mi,this.clipVertices2[C+2]=ri+(Qi-ri)*mi,C=3*ei,ei++,this.clipVertices2[C]=Yi,this.clipVertices2[C+1]=Xi,this.clipVertices2[C+2]=Qi),ai=Yi,hi=Xi,ri=Qi,g=k;if((Ys=ei)!=0){for(ei=0,C=3*(Ys-1),g=((ai=this.clipVertices2[C])-Hi+ae)*-es+((hi=this.clipVertices2[C+1])-Ui+he)*-ns+((ri=this.clipVertices2[C+2])-Ri+re)*-os,zi=0;zi<Ys;zi++)C=3*zi,k=((Yi=this.clipVertices2[C])-Hi+ae)*-es+((Xi=this.clipVertices2[C+1])-Ui+he)*-ns+((Qi=this.clipVertices2[C+2])-Ri+re)*-os,g>0?k>0?(C=3*ei,ei++,this.clipVertices1[C]=Yi,this.clipVertices1[C+1]=Xi,this.clipVertices1[C+2]=Qi):(C=3*ei,ei++,mi=g/(g-k),this.clipVertices1[C]=ai+(Yi-ai)*mi,this.clipVertices1[C+1]=hi+(Xi-hi)*mi,this.clipVertices1[C+2]=ri+(Qi-ri)*mi):k>0&&(C=3*ei,ei++,mi=g/(g-k),this.clipVertices1[C]=ai+(Yi-ai)*mi,this.clipVertices1[C+1]=hi+(Xi-hi)*mi,this.clipVertices1[C+2]=ri+(Qi-ri)*mi,C=3*ei,ei++,this.clipVertices1[C]=Yi,this.clipVertices1[C+1]=Xi,this.clipVertices1[C+2]=Qi),ai=Yi,hi=Xi,ri=Qi,g=k;if(Ce){var Uo=n;n=o,o=Uo}if((Ys=ei)!=0){var Ae=n!=t;if(Ys>4){Zi=Ds-(ai=.25*(Ds+Es+qs+Zs)),Ki=js-(hi=.25*(js+Fs+Ws+Ks)),Gi=Bs-(ri=.25*(Bs+Hs+Js+Gs)),es=Es-ai,ns=Fs-hi,os=Hs-ri;var Tn=0,xo=0,Cn=0,bo=0,Oe=-this.INF;for(Pi=this.INF,zi=0;zi<Ys;zi++)this.used[zi]=!1,C=3*zi,(Yt=(ai=this.clipVertices1[C])*Zi+(hi=this.clipVertices1[C+1])*Ki+(ri=this.clipVertices1[C+2])*Gi)<Pi&&(Pi=Yt,Tn=zi),Yt>Oe&&(Oe=Yt,Cn=zi);for(this.used[Tn]=!0,this.used[Cn]=!0,Oe=-this.INF,Pi=this.INF,zi=0;zi<Ys;zi++)this.used[zi]||(C=3*zi,(Yt=(ai=this.clipVertices1[C])*es+(hi=this.clipVertices1[C+1])*ns+(ri=this.clipVertices1[C+2])*os)<Pi&&(Pi=Yt,xo=zi),Yt>Oe&&(Oe=Yt,bo=zi));C=3*Tn,(Yt=((ai=this.clipVertices1[C])-Hi)*Nt+((hi=this.clipVertices1[C+1])-Ui)*wt+((ri=this.clipVertices1[C+2])-Ri)*Lt)<0&&e.addPoint(ai,hi,ri,Nt,wt,Lt,Yt,Ae),C=3*xo,(Yt=((ai=this.clipVertices1[C])-Hi)*Nt+((hi=this.clipVertices1[C+1])-Ui)*wt+((ri=this.clipVertices1[C+2])-Ri)*Lt)<0&&e.addPoint(ai,hi,ri,Nt,wt,Lt,Yt,Ae),C=3*Cn,(Yt=((ai=this.clipVertices1[C])-Hi)*Nt+((hi=this.clipVertices1[C+1])-Ui)*wt+((ri=this.clipVertices1[C+2])-Ri)*Lt)<0&&e.addPoint(ai,hi,ri,Nt,wt,Lt,Yt,Ae),C=3*bo,(Yt=((ai=this.clipVertices1[C])-Hi)*Nt+((hi=this.clipVertices1[C+1])-Ui)*wt+((ri=this.clipVertices1[C+2])-Ri)*Lt)<0&&e.addPoint(ai,hi,ri,Nt,wt,Lt,Yt,Ae)}else for(zi=0;zi<Ys;zi++)C=3*zi,(Yt=((ai=this.clipVertices1[C])-Hi)*Nt+((hi=this.clipVertices1[C+1])-Ui)*wt+((ri=this.clipVertices1[C+2])-Ri)*Lt)<0&&e.addPoint(ai,hi,ri,Nt,wt,Lt,Yt,Ae)}}}}}}}}),sn.prototype=Object.assign(Object.create(gs.prototype),{constructor:sn,getSep:function(t,s,e,n,o){var a,l,d,u,p,c,z,f,x,b,w,I,J,_=new $,q=t.position.x,R=t.position.y,tt=t.position.z,it=s.position.x,Z=s.position.y,pt=s.position.z,B=it-q,Y=Z-R,st=pt-tt;B*B+Y*Y+st*st==0&&(Y=.001);var H=-B,X=-Y,et=-st;this.supportPointB(t,-H,-X,-et,_);var Mt=_.x,_i=_.y,Ni=_.z;this.supportPointC(s,H,X,et,_);var pi=_.x,P=_.y,Ht=_.z,g=pi-Mt,k=P-_i,G=Ht-Ni;if(g*H+k*X+G*et<=0)return!1;if((H=k*st-G*Y)*H+(X=G*B-g*st)*X+(et=g*Y-k*B)*et==0)return e.set(g-B,k-Y,G-st).normalize(),n.set(.5*(Mt+pi),.5*(_i+P),.5*(Ni+Ht)),!0;this.supportPointB(t,-H,-X,-et,_);var V=_.x,S=_.y,It=_.z;this.supportPointC(s,H,X,et,_);var $t=_.x,ct=_.y,ut=_.z,O=$t-V,nt=ct-S,dt=ut-It;if(O*H+nt*X+dt*et<=0)return!1;(H=(l=k-Y)*(c=dt-st)-(d=G-st)*(p=nt-Y))*B+(X=d*(u=O-B)-(a=g-B)*c)*Y+(et=a*p-l*u)*st>0&&(a=g,l=k,d=G,g=O,k=nt,G=dt,O=a,nt=l,dt=d,a=Mt,l=_i,d=Ni,Mt=V,_i=S,Ni=It,V=a,S=l,It=d,a=pi,l=P,d=Ht,pi=$t,P=ct,Ht=ut,$t=a,ct=l,ut=d,H=-H,X=-X,et=-et);for(var ps=0;;){if(++ps>100)return!1;this.supportPointB(t,-H,-X,-et,_);var wi=_.x,Fi=_.y,vi=_.z;this.supportPointC(s,H,X,et,_);var fi=_.x,kt=_.y,lt=_.z,E=fi-wi,Q=kt-Fi,yt=lt-vi;if(E*H+Q*X+yt*et<=0)return!1;if((k*yt-G*Q)*B+(G*E-g*yt)*Y+(g*Q-k*E)*st<0)O=E,nt=Q,dt=yt,V=wi,S=Fi,It=vi,$t=fi,ct=kt,ut=lt,H=(l=k-Y)*(c=yt-st)-(d=G-st)*(p=Q-Y),X=d*(u=E-B)-(a=g-B)*c,et=a*p-l*u;else if((Q*dt-yt*nt)*B+(yt*O-E*dt)*Y+(E*nt-Q*O)*st<0)g=E,k=Q,G=yt,Mt=wi,_i=Fi,Ni=vi,pi=fi,P=kt,Ht=lt,H=(l=Q-Y)*(c=dt-st)-(d=yt-st)*(p=nt-Y),X=d*(u=O-B)-(a=E-B)*c,et=a*p-l*u;else for(var gi=!1;;){if(H=(l=nt-k)*(c=yt-G)-(d=dt-G)*(p=Q-k),X=d*(u=E-g)-(a=O-g)*c,et=a*p-l*u,(H*=z=1/T.sqrt(H*H+X*X+et*et))*g+(X*=z)*k+(et*=z)*G>=0&&!gi){var qt=(k*dt-G*nt)*E+(G*O-g*dt)*Q+(g*nt-k*O)*yt,Vt=(Q*dt-yt*nt)*B+(yt*O-E*dt)*Y+(E*nt-Q*O)*st,Ot=(Y*G-st*k)*E+(st*g-B*G)*Q+(B*k-Y*g)*yt,Dt=(nt*G-dt*k)*B+(dt*g-O*G)*Y+(O*k-nt*g)*st,ht=qt+Vt+Ot+Dt;ht<=0&&(qt=0,ht=(Vt=(nt*yt-dt*Q)*H+(dt*E-O*yt)*X+(O*Q-nt*E)*et)+(Ot=(Q*dt-yt*nt)*H+(yt*O-E*dt)*X+(E*nt-Q*O)*et)+(Dt=(k*dt-G*nt)*H+(G*O-g*dt)*X+(g*nt-k*O)*et));var ot=1/ht;f=(q*qt+Mt*Vt+V*Ot+wi*Dt)*ot,x=(R*qt+_i*Vt+S*Ot+Fi*Dt)*ot,b=(tt*qt+Ni*Vt+It*Ot+vi*Dt)*ot,w=(it*qt+pi*Vt+$t*Ot+fi*Dt)*ot,I=(Z*qt+P*Vt+ct*Ot+kt*Dt)*ot,J=(pt*qt+Ht*Vt+ut*Ot+lt*Dt)*ot,gi=!0}this.supportPointB(t,-H,-X,-et,_);var at=_.x,Wt=_.y,jt=_.z;this.supportPointC(s,H,X,et,_);var Bt=_.x,oi=_.y,si=_.z,Tt=Bt-at,zt=oi-Wt,Ct=si-jt,Ii=-(Tt*H+zt*X+Ct*et);if((Tt-E)*H+(zt-Q)*X+(Ct-yt)*et<=.01||Ii>=0)return!!gi&&(e.set(-H,-X,-et),n.set(.5*(f+w),.5*(x+I),.5*(b+J)),o.x=Ii,!0);(zt*G-Ct*k)*B+(Ct*g-Tt*G)*Y+(Tt*k-zt*g)*st<0?(zt*dt-Ct*nt)*B+(Ct*O-Tt*dt)*Y+(Tt*nt-zt*O)*st<0?(g=Tt,k=zt,G=Ct,Mt=at,_i=Wt,Ni=jt,pi=Bt,P=oi,Ht=si):(E=Tt,Q=zt,yt=Ct,wi=at,Fi=Wt,vi=jt,fi=Bt,kt=oi,lt=si):(zt*yt-Ct*Q)*B+(Ct*E-Tt*yt)*Y+(Tt*Q-zt*E)*st<0?(O=Tt,nt=zt,dt=Ct,V=at,S=Wt,It=jt,$t=Bt,ct=oi,ut=si):(g=Tt,k=zt,G=Ct,Mt=at,_i=Wt,Ni=jt,pi=Bt,P=oi,Ht=si)}}},supportPointB:function(t,s,e,n,o){var a,l,d,u=t.rotation.elements,p=u[0]*s+u[3]*e+u[6]*n,c=u[1]*s+u[4]*e+u[7]*n,z=u[2]*s+u[5]*e+u[8]*n,f=t.halfWidth,x=t.halfHeight,b=t.halfDepth;a=p<0?-f:f,l=c<0?-x:x,d=z<0?-b:b,p=u[0]*a+u[1]*l+u[2]*d+t.position.x,c=u[3]*a+u[4]*l+u[5]*d+t.position.y,z=u[6]*a+u[7]*l+u[8]*d+t.position.z,o.set(p,c,z)},supportPointC:function(t,s,e,n,o){var a,l,d,u=t.rotation.elements,p=u[0]*s+u[3]*e+u[6]*n,c=u[1]*s+u[4]*e+u[7]*n,z=u[2]*s+u[5]*e+u[8]*n,f=p,x=z,b=f*f+x*x,w=t.radius,I=t.halfHeight;b==0?c<0?(a=w,l=-I,d=0):(a=w,l=I,d=0):(b=t.radius/T.sqrt(b),c<0?(a=f*b,l=-I,d=x*b):(a=f*b,l=I,d=x*b)),p=u[0]*a+u[1]*l+u[2]*d+t.position.x,c=u[3]*a+u[4]*l+u[5]*d+t.position.y,z=u[6]*a+u[7]*l+u[8]*d+t.position.z,o.set(p,c,z)},detectCollision:function(t,s,e){var n,o;this.flip?(n=s,o=t):(n=t,o=s);var a=new $,l=new $,d=new $;if(this.getSep(n,o,a,l,d)){var u=n.position.x,p=n.position.y,c=n.position.z,z=o.position.x,f=o.position.y,x=o.position.z,b=n.halfWidth,w=n.halfHeight,I=n.halfDepth,J=o.halfHeight,_=o.radius,q=n.dimentions,R=q[0],tt=q[1],it=q[2],Z=q[3],pt=q[4],B=q[5],Y=q[6],st=q[7],H=q[8],X=q[9],et=q[10],Mt=q[11],_i=q[12],Ni=q[13],pi=q[14],P=q[15],Ht=q[16],g=q[17],k=o.normalDirection.x,G=o.normalDirection.y,V=o.normalDirection.z,S=o.halfDirection.x,It=o.halfDirection.y,$t=o.halfDirection.z,ct=a.x,ut=a.y,O=a.z,nt=ct*R+ut*tt+O*it,dt=ct*Z+ut*pt+O*B,ps=ct*Y+ut*st+O*H,wi=ct*k+ut*G+O*V,Fi=nt>0,vi=dt>0,fi=ps>0,kt=wi>0;Fi||(nt=-nt),vi||(dt=-dt),fi||(ps=-ps),kt||(wi=-wi);var lt,E,Q,yt,gi,qt,Vt,Ot,Dt,ht,ot,at,Wt,jt,Bt,oi,si,Tt,zt,Ct,Ii,Zt,xt,vt,mt,ft,Ut,Rt,Gt,ui,xi,bi,ki,se,Wi,is,ss,Kt,ds,ys,vs,ni,Qt,$i,ti,as,hs,rs,ls,cs,us,Oi,Di,Ji=0;if(wi>.999?Ji=nt>.999?nt>wi?1:4:dt>.999?dt>wi?2:4:ps>.999&&ps>wi?3:4:nt>.999?Ji=1:dt>.999?Ji=2:ps>.999&&(Ji=3),Ji==0)e.addPoint(l.x,l.y,l.z,ct,ut,O,d.x,this.flip);else if(Ji==4){var _s,Ns,ws,Ls,Ms,Vs,Ps,Ss,Is,$s,Ts,Cs;kt?(yt=z-S,gi=f-It,qt=x-$t,ct=-k,ut=-G,O=-V):(yt=z+S,gi=f+It,qt=x+$t,ct=k,ut=G,O=V),Ji=0,(Qt=R*ct+tt*ut+it*O)<(Ct=1)&&(Ct=Qt,Ji=0),-Qt<Ct&&(Ct=-Qt,Ji=1),(Qt=Z*ct+pt*ut+B*O)<Ct&&(Ct=Qt,Ji=2),-Qt<Ct&&(Ct=-Qt,Ji=3),(Qt=Y*ct+st*ut+H*O)<Ct&&(Ct=Qt,Ji=4),-Qt<Ct&&(Ct=-Qt,Ji=5);var rt=n.elements;switch(Ji){case 0:_s=rt[0],Ns=rt[1],ws=rt[2],Ls=rt[6],Ms=rt[7],Vs=rt[8],Ps=rt[9],Ss=rt[10],Is=rt[11],$s=rt[3],Ts=rt[4],Cs=rt[5];break;case 1:_s=rt[15],Ns=rt[16],ws=rt[17],Ls=rt[21],Ms=rt[22],Vs=rt[23],Ps=rt[18],Ss=rt[19],Is=rt[20],$s=rt[12],Ts=rt[13],Cs=rt[14];break;case 2:_s=rt[12],Ns=rt[13],ws=rt[14],Ls=rt[0],Ms=rt[1],Vs=rt[2],Ps=rt[3],Ss=rt[4],Is=rt[5],$s=rt[15],Ts=rt[16],Cs=rt[17];break;case 3:_s=rt[21],Ns=rt[22],ws=rt[23],Ls=rt[9],Ms=rt[10],Vs=rt[11],Ps=rt[6],Ss=rt[7],Is=rt[8],$s=rt[18],Ts=rt[19],Cs=rt[20];break;case 4:_s=rt[12],Ns=rt[13],ws=rt[14],Ls=rt[18],Ms=rt[19],Vs=rt[20],Ps=rt[6],Ss=rt[7],Is=rt[8],$s=rt[0],Ts=rt[1],Cs=rt[2];break;case 5:_s=rt[3],Ns=rt[4],ws=rt[5],Ls=rt[9],Ms=rt[10],Vs=rt[11],Ps=rt[21],Ss=rt[22],Is=rt[23],$s=rt[15],Ts=rt[16],Cs=rt[17]}(zt=ct*(_s-yt)+ut*(Ns-gi)+O*(ws-qt))<=0&&e.addPoint(_s,Ns,ws,-ct,-ut,-O,zt,this.flip),(zt=ct*(Ls-yt)+ut*(Ms-gi)+O*(Vs-qt))<=0&&e.addPoint(Ls,Ms,Vs,-ct,-ut,-O,zt,this.flip),(zt=ct*(Ps-yt)+ut*(Ss-gi)+O*(Is-qt))<=0&&e.addPoint(Ps,Ss,Is,-ct,-ut,-O,zt,this.flip),(zt=ct*($s-yt)+ut*(Ts-gi)+O*(Cs-qt))<=0&&e.addPoint($s,Ts,Cs,-ct,-ut,-O,zt,this.flip)}else{switch(Ji){case 1:Fi?(lt=u+X,E=p+et,Q=c+Mt,ct=R,ut=tt,O=it):(lt=u-X,E=p-et,Q=c-Mt,ct=-R,ut=-tt,O=-it),as=Z,hs=pt,rs=B,Oi=w,ls=Y,cs=st,us=H,Di=I;break;case 2:vi?(lt=u+_i,E=p+Ni,Q=c+pi,ct=Z,ut=pt,O=B):(lt=u-_i,E=p-Ni,Q=c-pi,ct=-Z,ut=-pt,O=-B),as=R,hs=tt,rs=it,Oi=b,ls=Y,cs=st,us=H,Di=I;break;case 3:fi?(lt=u+P,E=p+Ht,Q=c+g,ct=Y,ut=st,O=H):(lt=u-P,E=p-Ht,Q=c-g,ct=-Y,ut=-st,O=-H),as=R,hs=tt,rs=it,Oi=b,ls=Z,cs=pt,us=B,Di=w}if(yt=z+(Ii=(Ct=ct*k+ut*G+O*V)<0?J:-J)*k,gi=f+Ii*G,qt=x+Ii*V,wi>=.999999?(Zt=-ut,xt=O,vt=ct):(Zt=ct,xt=ut,vt=O),ft=(Ii=Zt*k+xt*G+vt*V)*k-Zt,Ut=Ii*G-xt,Rt=Ii*V-vt,(Ii=T.sqrt(ft*ft+Ut*Ut+Rt*Rt))==0)return;if(Zt=yt+(ft*=Ii=_/Ii),xt=gi+(Ut*=Ii),vt=qt+(Rt*=Ii),Ct<-.96||Ct>.96)Vt=k*k*1.5-.5,Ot=k*G*1.5-.866025403*V,Dt=k*V*1.5+.866025403*G,ht=G*k*1.5+.866025403*V,ot=G*G*1.5-.5,at=G*V*1.5-.866025403*k,Wt=V*k*1.5-.866025403*G,jt=V*G*1.5+.866025403*k,Bt=V*V*1.5-.5,(Kt=as*(Zt=(oi=Zt)-(zt=ct*(oi-lt)+ut*((si=xt)-E)+O*((Tt=vt)-Q))*ct-lt)+hs*(xt=si-zt*ut-E)+rs*(vt=Tt-zt*O-Q))<-Oi?Kt=-Oi:Kt>Oi&&(Kt=Oi),(ni=ls*Zt+cs*xt+us*vt)<-Di?ni=-Di:ni>Di&&(ni=Di),oi=lt+(Zt=Kt*as+ni*ls),si=E+(xt=Kt*hs+ni*cs),Tt=Q+(vt=Kt*rs+ni*us),e.addPoint(oi,si,Tt,ct,ut,O,zt,this.flip),si=ft*ht+Ut*ot+Rt*at,Tt=ft*Wt+Ut*jt+Rt*Bt,(zt=ct*((oi=(ft=oi=ft*Vt+Ut*Ot+Rt*Dt)+yt)-lt)+ut*((si=(Ut=si)+gi)-E)+O*((Tt=(Rt=Tt)+qt)-Q))<=0&&((Kt=as*(Zt=oi-zt*ct-lt)+hs*(xt=si-zt*ut-E)+rs*(vt=Tt-zt*O-Q))<-Oi?Kt=-Oi:Kt>Oi&&(Kt=Oi),(ni=ls*Zt+cs*xt+us*vt)<-Di?ni=-Di:ni>Di&&(ni=Di),oi=lt+(Zt=Kt*as+ni*ls),si=E+(xt=Kt*hs+ni*cs),Tt=Q+(vt=Kt*rs+ni*us),e.addPoint(oi,si,Tt,ct,ut,O,zt,this.flip)),si=ft*ht+Ut*ot+Rt*at,Tt=ft*Wt+Ut*jt+Rt*Bt,(zt=ct*((oi=(ft=oi=ft*Vt+Ut*Ot+Rt*Dt)+yt)-lt)+ut*((si=(Ut=si)+gi)-E)+O*((Tt=(Rt=Tt)+qt)-Q))<=0&&((Kt=as*(Zt=oi-zt*ct-lt)+hs*(xt=si-zt*ut-E)+rs*(vt=Tt-zt*O-Q))<-Oi?Kt=-Oi:Kt>Oi&&(Kt=Oi),(ni=ls*Zt+cs*xt+us*vt)<-Di?ni=-Di:ni>Di&&(ni=Di),oi=lt+(Zt=Kt*as+ni*ls),si=E+(xt=Kt*hs+ni*cs),Tt=Q+(vt=Kt*rs+ni*us),e.addPoint(oi,si,Tt,ct,ut,O,zt,this.flip));else{if(Wi=Zt,Ct>0?(ds=Zt+2*S,ys=xt+2*It,vs=vt+2*$t):(ds=Zt-2*S,ys=xt-2*It,vs=vt-2*$t),Zt=(ds-=(ni=ct*(ds-lt)+ut*(ys-E)+O*(vs-Q))*ct)-(Wi-=(Kt=ct*(Wi-lt)+ut*((is=xt)-E)+O*((ss=vt)-Q))*ct),xt=(ys-=ni*ut)-(is-=Kt*ut),vt=(vs-=ni*O)-(ss-=Kt*O),mt=ni-Kt,$i=(dt=(bi=ds-lt)*as+(ki=ys-E)*hs+(se=vs-Q)*rs)-Oi,(Qt=(nt=(Gt=Wi-lt)*as+(ui=is-E)*hs+(xi=ss-Q)*rs)-Oi)>0){if($i>0)return;nt=(Gt=(Wi+=Zt*(ti=Qt/(Qt-$i)))-lt)*as+(ui=(is+=xt*ti)-E)*hs+(xi=(ss+=vt*ti)-Q)*rs,Zt=ds-Wi,xt=ys-is,vt=vs-ss,mt=ni-(Kt+=mt*ti)}else $i>0&&(dt=(bi=(ds=Wi+Zt*(ti=Qt/(Qt-$i)))-lt)*as+(ki=(ys=is+xt*ti)-E)*hs+(se=(vs=ss+vt*ti)-Q)*rs,Zt=ds-Wi,xt=ys-is,vt=vs-ss,mt=(ni=Kt+mt*ti)-Kt);if($i=dt+Oi,(Qt=nt+Oi)<0){if($i<0)return;Gt=(Wi+=Zt*(ti=Qt/(Qt-$i)))-lt,ui=(is+=xt*ti)-E,xi=(ss+=vt*ti)-Q,Zt=ds-Wi,xt=ys-is,vt=vs-ss,mt=ni-(Kt+=mt*ti)}else $i<0&&(bi=(ds=Wi+Zt*(ti=Qt/(Qt-$i)))-lt,ki=(ys=is+xt*ti)-E,se=(vs=ss+vt*ti)-Q,Zt=ds-Wi,xt=ys-is,vt=vs-ss,mt=(ni=Kt+mt*ti)-Kt);if($i=(dt=bi*ls+ki*cs+se*us)-Di,(Qt=(nt=Gt*ls+ui*cs+xi*us)-Di)>0){if($i>0)return;nt=(Gt=(Wi+=Zt*(ti=Qt/(Qt-$i)))-lt)*ls+(ui=(is+=xt*ti)-E)*cs+(xi=(ss+=vt*ti)-Q)*us,Zt=ds-Wi,xt=ys-is,vt=vs-ss,mt=ni-(Kt+=mt*ti)}else $i>0&&(dt=(bi=(ds=Wi+Zt*(ti=Qt/(Qt-$i)))-lt)*ls+(ki=(ys=is+xt*ti)-E)*cs+(se=(vs=ss+vt*ti)-Q)*us,Zt=ds-Wi,xt=ys-is,vt=vs-ss,mt=(ni=Kt+mt*ti)-Kt);if($i=dt+Di,(Qt=nt+Di)<0){if($i<0)return;Wi+=Zt*(ti=Qt/(Qt-$i)),is+=xt*ti,ss+=vt*ti,Kt+=mt*ti}else $i<0&&(ds=Wi+Zt*(ti=Qt/(Qt-$i)),ys=is+xt*ti,vs=ss+vt*ti,ni=Kt+mt*ti);Kt<0&&e.addPoint(Wi,is,ss,ct,ut,O,Kt,this.flip),ni<0&&e.addPoint(ds,ys,vs,ct,ut,O,ni,this.flip)}}}}}),In.prototype=Object.assign(Object.create(gs.prototype),{constructor:In,getSep:function(t,s,e,n,o){var a,l,d,u,p,c,z,f,x,b,w,I,J,_=new $,q=t.position.x,R=t.position.y,tt=t.position.z,it=s.position.x,Z=s.position.y,pt=s.position.z,B=it-q,Y=Z-R,st=pt-tt;B*B+Y*Y+st*st==0&&(Y=.001);var H=-B,X=-Y,et=-st;this.supportPoint(t,-H,-X,-et,_);var Mt=_.x,_i=_.y,Ni=_.z;this.supportPoint(s,H,X,et,_);var pi=_.x,P=_.y,Ht=_.z,g=pi-Mt,k=P-_i,G=Ht-Ni;if(g*H+k*X+G*et<=0)return!1;if((H=k*st-G*Y)*H+(X=G*B-g*st)*X+(et=g*Y-k*B)*et==0)return e.set(g-B,k-Y,G-st).normalize(),n.set(.5*(Mt+pi),.5*(_i+P),.5*(Ni+Ht)),!0;this.supportPoint(t,-H,-X,-et,_);var V=_.x,S=_.y,It=_.z;this.supportPoint(s,H,X,et,_);var $t=_.x,ct=_.y,ut=_.z,O=$t-V,nt=ct-S,dt=ut-It;if(O*H+nt*X+dt*et<=0)return!1;(H=(l=k-Y)*(c=dt-st)-(d=G-st)*(p=nt-Y))*B+(X=d*(u=O-B)-(a=g-B)*c)*Y+(et=a*p-l*u)*st>0&&(a=g,l=k,d=G,g=O,k=nt,G=dt,O=a,nt=l,dt=d,a=Mt,l=_i,d=Ni,Mt=V,_i=S,Ni=It,V=a,S=l,It=d,a=pi,l=P,d=Ht,pi=$t,P=ct,Ht=ut,$t=a,ct=l,ut=d,H=-H,X=-X,et=-et);for(var ps=0;;){if(++ps>100)return!1;this.supportPoint(t,-H,-X,-et,_);var wi=_.x,Fi=_.y,vi=_.z;this.supportPoint(s,H,X,et,_);var fi=_.x,kt=_.y,lt=_.z,E=fi-wi,Q=kt-Fi,yt=lt-vi;if(E*H+Q*X+yt*et<=0)return!1;if((k*yt-G*Q)*B+(G*E-g*yt)*Y+(g*Q-k*E)*st<0)O=E,nt=Q,dt=yt,V=wi,S=Fi,It=vi,$t=fi,ct=kt,ut=lt,H=(l=k-Y)*(c=yt-st)-(d=G-st)*(p=Q-Y),X=d*(u=E-B)-(a=g-B)*c,et=a*p-l*u;else if((Q*dt-yt*nt)*B+(yt*O-E*dt)*Y+(E*nt-Q*O)*st<0)g=E,k=Q,G=yt,Mt=wi,_i=Fi,Ni=vi,pi=fi,P=kt,Ht=lt,H=(l=Q-Y)*(c=dt-st)-(d=yt-st)*(p=nt-Y),X=d*(u=O-B)-(a=E-B)*c,et=a*p-l*u;else for(var gi=!1;;){if(H=(l=nt-k)*(c=yt-G)-(d=dt-G)*(p=Q-k),X=d*(u=E-g)-(a=O-g)*c,et=a*p-l*u,(H*=z=1/T.sqrt(H*H+X*X+et*et))*g+(X*=z)*k+(et*=z)*G>=0&&!gi){var qt=(k*dt-G*nt)*E+(G*O-g*dt)*Q+(g*nt-k*O)*yt,Vt=(Q*dt-yt*nt)*B+(yt*O-E*dt)*Y+(E*nt-Q*O)*st,Ot=(Y*G-st*k)*E+(st*g-B*G)*Q+(B*k-Y*g)*yt,Dt=(nt*G-dt*k)*B+(dt*g-O*G)*Y+(O*k-nt*g)*st,ht=qt+Vt+Ot+Dt;ht<=0&&(qt=0,ht=(Vt=(nt*yt-dt*Q)*H+(dt*E-O*yt)*X+(O*Q-nt*E)*et)+(Ot=(Q*dt-yt*nt)*H+(yt*O-E*dt)*X+(E*nt-Q*O)*et)+(Dt=(k*dt-G*nt)*H+(G*O-g*dt)*X+(g*nt-k*O)*et));var ot=1/ht;f=(q*qt+Mt*Vt+V*Ot+wi*Dt)*ot,x=(R*qt+_i*Vt+S*Ot+Fi*Dt)*ot,b=(tt*qt+Ni*Vt+It*Ot+vi*Dt)*ot,w=(it*qt+pi*Vt+$t*Ot+fi*Dt)*ot,I=(Z*qt+P*Vt+ct*Ot+kt*Dt)*ot,J=(pt*qt+Ht*Vt+ut*Ot+lt*Dt)*ot,gi=!0}this.supportPoint(t,-H,-X,-et,_);var at=_.x,Wt=_.y,jt=_.z;this.supportPoint(s,H,X,et,_);var Bt=_.x,oi=_.y,si=_.z,Tt=Bt-at,zt=oi-Wt,Ct=si-jt,Ii=-(Tt*H+zt*X+Ct*et);if((Tt-E)*H+(zt-Q)*X+(Ct-yt)*et<=.01||Ii>=0)return!!gi&&(e.set(-H,-X,-et),n.set(.5*(f+w),.5*(x+I),.5*(b+J)),o.x=Ii,!0);(zt*G-Ct*k)*B+(Ct*g-Tt*G)*Y+(Tt*k-zt*g)*st<0?(zt*dt-Ct*nt)*B+(Ct*O-Tt*dt)*Y+(Tt*nt-zt*O)*st<0?(g=Tt,k=zt,G=Ct,Mt=at,_i=Wt,Ni=jt,pi=Bt,P=oi,Ht=si):(E=Tt,Q=zt,yt=Ct,wi=at,Fi=Wt,vi=jt,fi=Bt,kt=oi,lt=si):(zt*yt-Ct*Q)*B+(Ct*E-Tt*yt)*Y+(Tt*Q-zt*E)*st<0?(O=Tt,nt=zt,dt=Ct,V=at,S=Wt,It=jt,$t=Bt,ct=oi,ut=si):(g=Tt,k=zt,G=Ct,Mt=at,_i=Wt,Ni=jt,pi=Bt,P=oi,Ht=si)}}},supportPoint:function(t,s,e,n,o){var a,l,d,u=t.rotation.elements,p=u[0]*s+u[3]*e+u[6]*n,c=u[1]*s+u[4]*e+u[7]*n,z=u[2]*s+u[5]*e+u[8]*n,f=p,x=z,b=f*f+x*x,w=t.radius,I=t.halfHeight;b==0?c<0?(a=w,l=-I,d=0):(a=w,l=I,d=0):(b=t.radius/T.sqrt(b),c<0?(a=f*b,l=-I,d=x*b):(a=f*b,l=I,d=x*b)),p=u[0]*a+u[1]*l+u[2]*d+t.position.x,c=u[3]*a+u[4]*l+u[5]*d+t.position.y,z=u[6]*a+u[7]*l+u[8]*d+t.position.z,o.set(p,c,z)},detectCollision:function(t,s,e){var n,o;t.id<s.id?(n=t,o=s):(n=s,o=t);var a,l,d,u,p,c,z,f,x,b,w,I,J,_,q,R,tt,it,Z,pt,B,Y=n.position,st=o.position,H=Y.x,X=Y.y,et=Y.z,Mt=st.x,_i=st.y,Ni=st.z,pi=n.halfHeight,P=o.halfHeight,Ht=n.normalDirection,g=o.normalDirection,k=n.halfDirection,G=o.halfDirection,V=n.radius,S=o.radius,It=Ht.x,$t=Ht.y,ct=Ht.z,ut=g.x,O=g.y,nt=g.z,dt=k.x,ps=k.y,wi=k.z,Fi=G.x,vi=G.y,fi=G.z,kt=H-Mt,lt=X-_i,E=et-Ni,Q=new $,yt=new $,gi=new $;if(this.getSep(n,o,Q,yt,gi)){var qt=Q.x*It+Q.y*$t+Q.z*ct,Vt=Q.x*ut+Q.y*O+Q.z*nt,Ot=qt>0,Dt=Vt>0;Ot||(qt=-qt),Dt||(Vt=-Vt);var ht,ot,at,Wt=0;(qt>.999||Vt>.999)&&(Wt=qt>Vt?1:2);var jt,Bt,oi,si,Tt,zt,Ct,Ii,Zt,xt,vt,mt,ft,Ut,Rt,Gt,ui=gi.x;switch(ht=Q.x,ot=Q.y,at=Q.z,Wt){case 0:e.addPoint(yt.x,yt.y,yt.z,ht,ot,at,ui,!1);break;case 1:if(Ot?(l=H+dt,d=X+ps,u=et+wi,ht=It,ot=$t,at=ct):(l=H-dt,d=X-ps,u=et-wi,ht=-It,ot=-$t,at=-ct),p=Mt+(a=(Z=ht*ut+ot*O+at*nt)<0?P:-P)*ut,c=_i+a*O,z=Ni+a*nt,Vt>=.999999?(f=-ot,x=at,b=ht):(f=ht,x=ot,b=at),kt=(a=f*ut+x*O+b*nt)*ut-f,lt=a*O-x,E=a*nt-b,(a=T.sqrt(kt*kt+lt*lt+E*E))==0)break;if(f=p+(kt*=a=S/a),x=c+(lt*=a),b=z+(E*=a),Z<-.96||Z>.96)jt=ut*ut*1.5-.5,Bt=ut*O*1.5-.866025403*nt,oi=ut*nt*1.5+.866025403*O,si=O*ut*1.5+.866025403*nt,Tt=O*O*1.5-.5,zt=O*nt*1.5-.866025403*ut,Ct=nt*ut*1.5-.866025403*O,Ii=nt*O*1.5+.866025403*ut,Zt=nt*nt*1.5-.5,(a=(f=(xt=f)-(ft=ht*(xt-l)+ot*((vt=x)-d)+at*((mt=b)-u))*ht-l)*f+(x=vt-ft*ot-d)*x+(b=mt-ft*at-u)*b)>V*V&&(f*=a=V/T.sqrt(a),x*=a,b*=a),xt=l+f,vt=d+x,mt=u+b,e.addPoint(xt,vt,mt,ht,ot,at,ft,!1),vt=kt*si+lt*Tt+E*zt,mt=kt*Ct+lt*Ii+E*Zt,(ft=ht*((xt=(kt=xt=kt*jt+lt*Bt+E*oi)+p)-l)+ot*((vt=(lt=vt)+c)-d)+at*((mt=(E=mt)+z)-u))<=0&&((a=(f=xt-ft*ht-l)*f+(x=vt-ft*ot-d)*x+(b=mt-ft*at-u)*b)>V*V&&(f*=a=V/T.sqrt(a),x*=a,b*=a),xt=l+f,vt=d+x,mt=u+b,e.addPoint(xt,vt,mt,ht,ot,at,ft,!1)),vt=kt*si+lt*Tt+E*zt,mt=kt*Ct+lt*Ii+E*Zt,(ft=ht*((xt=(kt=xt=kt*jt+lt*Bt+E*oi)+p)-l)+ot*((vt=(lt=vt)+c)-d)+at*((mt=(E=mt)+z)-u))<=0&&((a=(f=xt-ft*ht-l)*f+(x=vt-ft*ot-d)*x+(b=mt-ft*at-u)*b)>V*V&&(f*=a=V/T.sqrt(a),x*=a,b*=a),xt=l+f,vt=d+x,mt=u+b,e.addPoint(xt,vt,mt,ht,ot,at,ft,!1));else{if(w=f,Z>0?(_=f+ut*P*2,q=x+O*P*2,R=b+nt*P*2):(_=f-ut*P*2,q=x-O*P*2,R=b-nt*P*2),(Gt=(Ut=(kt=l-(w-=(tt=ht*(w-l)+ot*((I=x)-d)+at*((J=b)-u))*ht))*(f=(_-=(it=ht*(_-l)+ot*(q-d)+at*(R-u))*ht)-w)+(lt=d-(I-=tt*ot))*(x=(q-=it*ot)-I)+(E=u-(J-=tt*at))*(b=(R-=it*at)-J))*Ut-(Rt=f*f+x*x+b*b)*(kt*kt+lt*lt+E*E-V*V))<0)break;(B=(Ut-(Gt=T.sqrt(Gt)))/Rt)<(pt=(Ut+Gt)/Rt)&&(a=pt,pt=B,B=a),B>1&&(B=1),pt<0&&(pt=0),f=w+(_-w)*pt,x=I+(q-I)*pt,b=J+(R-J)*pt,_=w+(_-w)*B,q=I+(q-I)*B,R=J+(R-J)*B,w=f,I=x,J=b,a=tt+(it-tt)*pt,it=tt+(it-tt)*B,(tt=a)<0&&e.addPoint(w,I,J,ht,ot,at,ft,!1),it<0&&e.addPoint(_,q,R,ht,ot,at,ft,!1)}break;case 2:if(Dt?(p=Mt-Fi,c=_i-vi,z=Ni-fi,ht=-ut,ot=-O,at=-nt):(p=Mt+Fi,c=_i+vi,z=Ni+fi,ht=ut,ot=O,at=nt),l=H+(a=(Z=ht*It+ot*$t+at*ct)<0?pi:-pi)*It,d=X+a*$t,u=et+a*ct,qt>=.999999?(f=-ot,x=at,b=ht):(f=ht,x=ot,b=at),kt=(a=f*It+x*$t+b*ct)*It-f,lt=a*$t-x,E=a*ct-b,(a=T.sqrt(kt*kt+lt*lt+E*E))==0)break;if(f=l+(kt*=a=V/a),x=d+(lt*=a),b=u+(E*=a),Z<-.96||Z>.96)jt=It*It*1.5-.5,Bt=It*$t*1.5-.866025403*ct,oi=It*ct*1.5+.866025403*$t,si=$t*It*1.5+.866025403*ct,Tt=$t*$t*1.5-.5,zt=$t*ct*1.5-.866025403*It,Ct=ct*It*1.5-.866025403*$t,Ii=ct*$t*1.5+.866025403*It,Zt=ct*ct*1.5-.5,(a=(f=(xt=f)-(ft=ht*(xt-p)+ot*((vt=x)-c)+at*((mt=b)-z))*ht-p)*f+(x=vt-ft*ot-c)*x+(b=mt-ft*at-z)*b)>S*S&&(f*=a=S/T.sqrt(a),x*=a,b*=a),xt=p+f,vt=c+x,mt=z+b,e.addPoint(xt,vt,mt,-ht,-ot,-at,ft,!1),vt=kt*si+lt*Tt+E*zt,mt=kt*Ct+lt*Ii+E*Zt,(ft=ht*((xt=(kt=xt=kt*jt+lt*Bt+E*oi)+l)-p)+ot*((vt=(lt=vt)+d)-c)+at*((mt=(E=mt)+u)-z))<=0&&((a=(f=xt-ft*ht-p)*f+(x=vt-ft*ot-c)*x+(b=mt-ft*at-z)*b)>S*S&&(f*=a=S/T.sqrt(a),x*=a,b*=a),xt=p+f,vt=c+x,mt=z+b,e.addPoint(xt,vt,mt,-ht,-ot,-at,ft,!1)),vt=kt*si+lt*Tt+E*zt,mt=kt*Ct+lt*Ii+E*Zt,(ft=ht*((xt=(kt=xt=kt*jt+lt*Bt+E*oi)+l)-p)+ot*((vt=(lt=vt)+d)-c)+at*((mt=(E=mt)+u)-z))<=0&&((a=(f=xt-ft*ht-p)*f+(x=vt-ft*ot-c)*x+(b=mt-ft*at-z)*b)>S*S&&(f*=a=S/T.sqrt(a),x*=a,b*=a),xt=p+f,vt=c+x,mt=z+b,e.addPoint(xt,vt,mt,-ht,-ot,-at,ft,!1));else{if(w=f,Z>0?(_=f+It*pi*2,q=x+$t*pi*2,R=b+ct*pi*2):(_=f-It*pi*2,q=x-$t*pi*2,R=b-ct*pi*2),(Gt=(Ut=(kt=p-(w-=(tt=ht*(w-p)+ot*((I=x)-c)+at*((J=b)-z))*ht))*(f=(_-=(it=ht*(_-p)+ot*(q-c)+at*(R-z))*ht)-w)+(lt=c-(I-=tt*ot))*(x=(q-=it*ot)-I)+(E=z-(J-=tt*at))*(b=(R-=it*at)-J))*Ut-(Rt=f*f+x*x+b*b)*(kt*kt+lt*lt+E*E-S*S))<0)break;(B=(Ut-(Gt=T.sqrt(Gt)))/Rt)<(pt=(Ut+Gt)/Rt)&&(a=pt,pt=B,B=a),B>1&&(B=1),pt<0&&(pt=0),f=w+(_-w)*pt,x=I+(q-I)*pt,b=J+(R-J)*pt,_=w+(_-w)*B,q=I+(q-I)*B,R=J+(R-J)*B,w=f,I=x,J=b,a=tt+(it-tt)*pt,it=tt+(it-tt)*B,(tt=a)<0&&e.addPoint(w,I,J,-ht,-ot,-at,tt,!1),it<0&&e.addPoint(_,q,R,-ht,-ot,-at,it,!1)}}}}}),en.prototype=Object.assign(Object.create(gs.prototype),{constructor:en,detectCollision:function(t,s,e){var n,o;this.flip?(n=s,o=t):(n=t,o=s);var a,l,d,u,p,c=o.dimentions,z=n.position,f=z.x,x=z.y,b=z.z,w=o.position,I=w.x,J=w.y,_=w.z,q=n.radius,R=o.halfWidth,tt=o.halfHeight,it=o.halfDepth,Z=f-I,pt=x-J,B=b-_,Y=c[0]*Z+c[1]*pt+c[2]*B,st=c[3]*Z+c[4]*pt+c[5]*B,H=c[6]*Z+c[7]*pt+c[8]*B,X=0;Y>R?Y=R:Y<-R?Y=-R:X=1,st>tt?st=tt:st<-tt?st=-tt:X|=2,H>it?H=it:H<-it?H=-it:X|=4,X==7?(B=H<0?it+H:it-H,(Z=Y<0?R+Y:R-Y)<(pt=st<0?tt+st:tt-st)?Z<B?(u=Z-R,Y<0?(Y=-R,Z=c[0],pt=c[1],B=c[2]):(Y=R,Z=-c[0],pt=-c[1],B=-c[2])):(u=B-it,H<0?(H=-it,Z=c[6],pt=c[7],B=c[8]):(H=it,Z=-c[6],pt=-c[7],B=-c[8])):pt<B?(u=pt-tt,st<0?(st=-tt,Z=c[3],pt=c[4],B=c[5]):(st=tt,Z=-c[3],pt=-c[4],B=-c[5])):(u=B-it,H<0?(H=-it,Z=c[6],pt=c[7],B=c[8]):(H=it,Z=-c[6],pt=-c[7],B=-c[8])),a=I+Y*c[0]+st*c[3]+H*c[6],l=J+Y*c[1]+st*c[4]+H*c[7],d=_+Y*c[2]+st*c[5]+H*c[8],e.addPoint(f+q*Z,x+q*pt,b+q*B,Z,pt,B,u-q,this.flip)):(a=I+Y*c[0]+st*c[3]+H*c[6],l=J+Y*c[1]+st*c[4]+H*c[7],d=_+Y*c[2]+st*c[5]+H*c[8],(u=(Z=a-z.x)*Z+(pt=l-z.y)*pt+(B=d-z.z)*B)>0&&u<q*q&&(Z*=p=1/(u=T.sqrt(u)),pt*=p,B*=p,e.addPoint(f+q*Z,x+q*pt,b+q*B,Z,pt,B,u-q,this.flip)))}}),nn.prototype=Object.assign(Object.create(gs.prototype),{constructor:nn,detectCollision:function(t,s,e){var n,o;this.flip?(n=s,o=t):(n=t,o=s);var a=n.position,l=a.x,d=a.y,u=a.z,p=o.position,c=p.x,z=p.y,f=p.z,x=o.normalDirection.x,b=o.normalDirection.y,w=o.normalDirection.z,I=n.radius,J=o.radius,_=I+J,q=o.halfHeight,R=l-c,tt=d-z,it=u-f,Z=R*x+tt*b+it*w;if(!(Z<-q-I||Z>q+I)){var pt,B=c+Z*x,Y=z+Z*b,st=f+Z*w,H=l-B,X=d-Y,et=u-st,Mt=H*H+X*X+et*et;Mt>_*_||(Mt>J*J&&(H*=Mt=J/T.sqrt(Mt),X*=Mt,et*=Mt),Z<-q?Z=-q:Z>q&&(Z=q),(Mt=(R=(B=c+Z*x+H)-l)*R+(tt=(Y=z+Z*b+X)-d)*tt+(it=(st=f+Z*w+et)-u)*it)>0&&Mt<I*I&&(R*=pt=1/(Mt=T.sqrt(Mt)),tt*=pt,it*=pt,e.addPoint(l+R*I,d+tt*I,u+it*I,R,tt,it,Mt-I,this.flip)))}}}),$n.prototype=Object.assign(Object.create(gs.prototype),{constructor:$n,detectCollision:function(t,s,e){var n=t,o=s,a=n.position,l=o.position,d=l.x-a.x,u=l.y-a.y,p=l.z-a.z,c=d*d+u*u+p*p,z=n.radius,f=z+o.radius;if(c>0&&c<f*f){var x=1/(c=T.sqrt(c));d*=x,u*=x,p*=x,e.addPoint(a.x+d*z,a.y+u*z,a.z+p*z,d,u,p,c-f,!1)}}}),on.prototype=Object.assign(Object.create(gs.prototype),{constructor:on,detectCollision:function(t,s,e){var n,o=this.n,a=this.p,l=this.flip?s:t,d=this.flip?t:s,u=l.radius;o.sub(l.position,d.position),o.x*=d.normal.x,o.y*=d.normal.y,o.z*=d.normal.z,(n=o.lengthSq())>0&&n<u*u&&(n=T.sqrt(n),o.copy(d.normal).negate(),a.copy(l.position).addScaledVector(o,u),e.addPointVec(a,o,n-u,this.flip))}}),an.prototype=Object.assign(Object.create(gs.prototype),{constructor:an,detectCollision:function(t,s,e){var n,o=this.n,a=this.p,l=this.cc,d=this.flip?s:t,u=this.flip?t:s,p=d.dimentions,c=d.halfWidth,z=d.halfHeight,f=d.halfDepth,x=0;this.dix.set(p[0],p[1],p[2]),this.diy.set(p[3],p[4],p[5]),this.diz.set(p[6],p[7],p[8]),o.sub(d.position,u.position),o.x*=u.normal.x,o.y*=u.normal.y,o.z*=u.normal.z,l.set(T.dotVectors(this.dix,o),T.dotVectors(this.diy,o),T.dotVectors(this.diz,o)),l.x>c?l.x=c:l.x<-c?l.x=-c:x=1,l.y>z?l.y=z:l.y<-z?l.y=-z:x|=2,l.z>f?l.z=f:l.z<-f?l.z=-f:x|=4,x===7&&(o.set(l.x<0?c+l.x:c-l.x,l.y<0?z+l.y:z-l.y,l.z<0?f+l.z:f-l.z),o.x<o.y?o.x<o.z?(n=o.x-c,l.x<0?(l.x=-c,o.copy(this.dix)):(l.x=c,o.subEqual(this.dix))):(n=o.z-f,l.z<0?(l.z=-f,o.copy(this.diz)):(l.z=f,o.subEqual(this.diz))):o.y<o.z?(n=o.y-z,l.y<0?(l.y=-z,o.copy(this.diy)):(l.y=z,o.subEqual(this.diy))):(n=o.z-f,l.z<0?(l.z=-f,o.copy(this.diz)):(l.z=f,o.subEqual(this.diz))),a.copy(u.position).addScaledVector(o,1),e.addPointVec(a,o,n,this.flip))}}),Object.assign(ho.prototype,{World:!0,play:function(){if(this.timer===null){var t=this;this.timer=setInterval(function(){t.step()},this.timerate)}},stop:function(){this.timer!==null&&(clearInterval(this.timer),this.timer=null)},setGravity:function(t){this.gravity.fromArray(t)},getInfo:function(){return this.isStat?this.performance.show():""},clear:function(){for(this.stop(),this.preLoop=null,this.postLoop=null,this.randX=65535;this.joints!==null;)this.removeJoint(this.joints);for(;this.contacts!==null;)this.removeContact(this.contacts);for(;this.rigidBodies!==null;)this.removeRigidBody(this.rigidBodies)},addRigidBody:function(t){t.parent&&bs("World","It is not possible to be added to more than one world one of the rigid body"),t.setParent(this);for(var s=t.shapes;s!==null;s=s.next)this.addShape(s);this.rigidBodies!==null&&((this.rigidBodies.prev=t).next=this.rigidBodies),this.rigidBodies=t,this.numRigidBodies++},removeRigidBody:function(t){var s=t;if(s.parent===this){s.awake();for(var e=s.jointLink;e!=null;){var n=e.joint;e=e.next,this.removeJoint(n)}for(var o=t.shapes;o!==null;o=o.next)this.removeShape(o);var a=s.prev,l=s.next;a!==null&&(a.next=l),l!==null&&(l.prev=a),this.rigidBodies==s&&(this.rigidBodies=l),s.prev=null,s.next=null,s.parent=null,this.numRigidBodies--}},getByName:function(t){for(var s=this.rigidBodies;s!==null;){if(s.name===t)return s;s=s.next}for(var e=this.joints;e!==null;){if(e.name===t)return e;e=e.next}return null},addShape:function(t){t.parent&&t.parent.parent||bs("World","It is not possible to be added alone to shape world"),t.proxy=this.broadPhase.createProxy(t),t.updateProxy(),this.broadPhase.addProxy(t.proxy)},removeShape:function(t){this.broadPhase.removeProxy(t.proxy),t.proxy=null},addJoint:function(t){t.parent&&bs("World","It is not possible to be added to more than one world one of the joint"),this.joints!=null&&((this.joints.prev=t).next=this.joints),this.joints=t,t.setParent(this),this.numJoints++,t.awake(),t.attach()},removeJoint:function(t){var s=t,e=s.prev,n=s.next;e!==null&&(e.next=n),n!==null&&(n.prev=e),this.joints==s&&(this.joints=n),s.prev=null,s.next=null,this.numJoints--,s.awake(),s.detach(),s.parent=null},addContact:function(t,s){var e;this.unusedContacts!==null?(e=this.unusedContacts,this.unusedContacts=this.unusedContacts.next):e=new no,e.attach(t,s),e.detector=this.detectors[t.type][s.type],this.contacts&&((this.contacts.prev=e).next=this.contacts),this.contacts=e,this.numContacts++},removeContact:function(t){var s=t.prev,e=t.next;e&&(e.prev=s),s&&(s.next=e),this.contacts==t&&(this.contacts=e),t.prev=null,t.next=null,t.detach(),t.next=this.unusedContacts,this.unusedContacts=t,this.numContacts--},getContact:function(t,s){var e,n;t=t.constructor===Ne?t.name:t,s=s.constructor===Ne?s.name:s;for(var o=this.contacts;o!==null;){if(e=o.body1.name,n=o.body2.name,e===t&&n===s||n===t&&e===s)return o.touching?o:null;o=o.next}return null},checkContact:function(t,s){for(var e,n,o=this.contacts;o!==null;){if(e=o.body1.name||" ",n=o.body2.name||" ",e==t&&n==s||n==t&&e==s)return!!o.touching;o=o.next}},callSleep:function(t){return!!t.allowSleep&&!(t.linearVelocity.lengthSq()>.04)&&!(t.angularVelocity.lengthSq()>.25)},step:function(){var t=this.isStat;t&&this.performance.setTime(0);for(var s=this.rigidBodies;s!==null;)s.addedToIsland=!1,s.sleeping&&s.testWakeUp(),s=s.next;t&&this.performance.setTime(1),this.broadPhase.detectPairs();for(var e=this.broadPhase.pairs,n=this.broadPhase.numPairs;n--;){var o,a,l,d=e[n];d.shape1.id<d.shape2.id?(o=d.shape1,a=d.shape2):(o=d.shape2,a=d.shape1),l=o.numContacts<a.numContacts?o.contactLink:a.contactLink;for(var u=!1;l;){if((R=l.contact).shape1==o&&R.shape2==a){R.persisting=!0,u=!0;break}l=l.next}u||this.addContact(o,a)}for(t&&this.performance.calcBroadPhase(),this.numContactPoints=0,R=this.contacts;R!==null;)if(R.persisting||!R.shape1.aabb.intersectTest(R.shape2.aabb)){var p=R.body1,c=R.body2;(p.isDynamic&&!p.sleeping||c.isDynamic&&!c.sleeping)&&R.updateManifold(),this.numContactPoints+=R.manifold.numPoints,R.persisting=!1,R.constraint.addedToIsland=!1,R=R.next}else{var z=R.next;this.removeContact(R),R=z}t&&this.performance.calcNarrowPhase();var f,x,b=1/this.timeStep;for(f=this.joints;f!==null;f=f.next)f.addedToIsland=!1;this.islandRigidBodies=[],this.islandConstraints=[],this.islandStack=[],t&&this.performance.setTime(1),this.numIslands=0;for(var w=this.rigidBodies;w!==null;w=w.next)if(!(w.addedToIsland||w.isStatic||w.sleeping))if(w.isLonely())w.isDynamic&&w.linearVelocity.addScaledVector(this.gravity,this.timeStep),this.callSleep(w)?(w.sleepTime+=this.timeStep,w.sleepTime>.5?w.sleep():w.updatePosition(this.timeStep)):(w.sleepTime=0,w.updatePosition(this.timeStep)),this.numIslands++;else{var I=0,J=0,_=1;this.islandStack[0]=w,w.addedToIsland=!0;do if(s=this.islandStack[--_],this.islandStack[_]=null,s.sleeping=!1,this.islandRigidBodies[I++]=s,!s.isStatic){for(var q=s.contactLink;q!==null;q=q.next){var R;!(x=(R=q.contact).constraint).addedToIsland&&R.touching&&(this.islandConstraints[J++]=x,x.addedToIsland=!0,(z=q.body).addedToIsland||(this.islandStack[_++]=z,z.addedToIsland=!0))}for(var tt=s.jointLink;tt!==null;tt=tt.next)(x=tt.joint).addedToIsland||(this.islandConstraints[J++]=x,x.addedToIsland=!0,!(z=tt.body).addedToIsland&&z.isDynamic&&(this.islandStack[_++]=z,z.addedToIsland=!0))}while(_!=0);for(var it=new $().addScaledVector(this.gravity,this.timeStep),Z=I;Z--;)(s=this.islandRigidBodies[Z]).isDynamic&&s.linearVelocity.addEqual(it);if(this.enableRandomizer){for(Z=J;Z--;)if(Z!==0){var pt=(this.randX=this.randX*this.randA+this.randB&2147483647)/2147483648*Z|0;x=this.islandConstraints[Z],this.islandConstraints[Z]=this.islandConstraints[pt],this.islandConstraints[pt]=x}}for(Z=J;Z--;)this.islandConstraints[Z].preSolve(this.timeStep,b);for(var B=this.numIterations;B--;)for(Z=J;Z--;)this.islandConstraints[Z].solve();for(Z=J;Z--;)this.islandConstraints[Z].postSolve(),this.islandConstraints[Z]=null;var Y=10;for(Z=I;Z--;)s=this.islandRigidBodies[Z],this.callSleep(s)?(s.sleepTime+=this.timeStep,s.sleepTime<Y&&(Y=s.sleepTime)):(s.sleepTime=0,Y=0);if(Y>.5)for(Z=I;Z--;)this.islandRigidBodies[Z].sleep(),this.islandRigidBodies[Z]=null;else for(Z=I;Z--;)this.islandRigidBodies[Z].updatePosition(this.timeStep),this.islandRigidBodies[Z]=null;this.numIslands++}t&&this.performance.calcEnd(),this.postLoop!==null&&this.postLoop()},remove:function(t){},add:function(t){var s=(t=t||{}).type||"box";return s.constructor===String&&(s=[s]),s[0].substring(0,5)==="joint"?this.initJoint(s[0],t):this.initBody(s,t)},initBody:function(t,s){var e=this.invScale,n=s.move||!1,o=s.kinematic||!1,a=s.pos||[0,0,0];a=a.map(function(w){return w*e});var l=s.posShape||[0,0,0];l=l.map(function(w){return w*e});var d=s.rot||[0,0,0];d=d.map(function(w){return w*T.degtorad});var u=s.rotShape;u=d.map(function(w){return w*T.degtorad});var p=s.size===void 0?[1,1,1]:s.size;p.length===1&&(p[1]=p[0]),p.length===2&&(p[2]=p[0]),p=p.map(function(w){return w*e});var c=new Qn;s.density!==void 0&&(c.density=s.density),s.friction!==void 0&&(c.friction=s.friction),s.restitution!==void 0&&(c.restitution=s.restitution),s.belongsTo!==void 0&&(c.belongsTo=s.belongsTo),s.collidesWith!==void 0&&(c.collidesWith=s.collidesWith),s.config!==void 0&&(s.config[0]!==void 0&&(c.density=s.config[0]),s.config[1]!==void 0&&(c.friction=s.config[1]),s.config[2]!==void 0&&(c.restitution=s.config[2]),s.config[3]!==void 0&&(c.belongsTo=s.config[3]),s.config[4]!==void 0&&(c.collidesWith=s.config[4]));for(var z,f,x=new Ne(new $(a[0],a[1],a[2]),new ks().setFromEuler(d[0],d[1],d[2])),b=0;b<t.length;b++){switch(l[f=3*b]!==void 0&&c.relativePosition.set(l[f],l[f+1],l[f+2]),u[f]!==void 0&&c.relativeRotation.setQuat(new ks().setFromEuler(u[f],u[f+1],u[f+2])),t[b]){case"sphere":z=new Ee(c,p[f]);break;case"cylinder":z=new Fe(c,p[f],p[f+1]);break;case"box":z=new Be(c,p[f],p[f+1],p[f+2]);break;case"plane":z=new He(c)}x.addShape(z)}return s.neverSleep||o?x.allowSleep=!1:x.allowSleep=!0,x.isKinematic=o,n?s.massPos||s.massRot?x.setupMass(1,!1):x.setupMass(1,!0):x.setupMass(2),s.name!==void 0&&(x.name=s.name),this.addRigidBody(x),n&&(s.sleep?x.sleep():x.awake()),x},initJoint:function(t,s){var e,n,o=this.invScale,a=s.axe1||[1,0,0],l=s.axe2||[1,0,0],d=s.pos1||[0,0,0],u=s.pos2||[0,0,0];d=d.map(function(I){return I*o}),u=u.map(function(I){return I*o}),t==="jointDistance"?(e=s.min||0,n=s.max||10,e*=o,n*=o):(e=s.min||57.29578,n=s.max||0,e*=T.degtorad,n*=T.degtorad);var p=s.limit||null,c=s.spring||null,z=s.motor||null,f=new eo;f.scale=this.scale,f.invScale=this.invScale,f.allowCollision=s.collision||!1,f.localAxis1.set(a[0],a[1],a[2]),f.localAxis2.set(l[0],l[1],l[2]),f.localAnchorPoint1.set(d[0],d[1],d[2]),f.localAnchorPoint2.set(u[0],u[1],u[2]);var x,b=null,w=null;if(s.body1===void 0||s.body2===void 0)return bs("World","Can't add joint if attach rigidbodys not define !");if(s.body1.constructor===String?b=this.getByName(s.body1):s.body1.constructor===Number?b=this.getByName(s.body1):s.body1.constructor===Ne&&(b=s.body1),s.body2.constructor===String?w=this.getByName(s.body2):s.body2.constructor===Number?w=this.getByName(s.body2):s.body2.constructor===Ne&&(w=s.body2),b===null||w===null)return bs("World","Can't add joint attach rigidbodys not find !");switch(f.body1=b,f.body2=w,t){case"jointDistance":x=new We(f,e,n),c!==null&&x.limitMotor.setSpring(c[0],c[1]),z!==null&&x.limitMotor.setMotor(z[0],z[1]);break;case"jointHinge":case"joint":x=new Re(f,e,n),c!==null&&x.limitMotor.setSpring(c[0],c[1]),z!==null&&x.limitMotor.setMotor(z[0],z[1]);break;case"jointPrisme":x=new Ze(f,e,n);break;case"jointSlide":x=new Ke(f,e,n);break;case"jointBall":x=new qe(f);break;case"jointWheel":x=new Ge(f),p!==null&&x.rotationalLimitMotor1.setLimit(p[0],p[1]),c!==null&&x.rotationalLimitMotor1.setSpring(c[0],c[1]),z!==null&&x.rotationalLimitMotor1.setMotor(z[0],z[1])}return x.name=s.name||"",this.addJoint(x),x}}),r.Math=T,r.Vec3=$,r.Quat=ks,r.Mat33=xs,r.Shape=Xs,r.Box=Be,r.Sphere=Ee,r.Cylinder=Fe,r.Plane=He,r.Particle=kn,r.ShapeConfig=Qn,r.LimitMotor=ms,r.HingeJoint=Re,r.BallAndSocketJoint=qe,r.DistanceJoint=We,r.PrismaticJoint=Ze,r.SliderJoint=Ke,r.WheelJoint=Ge,r.JointConfig=eo,r.RigidBody=Ne,r.World=ho,r.REVISION=M,r.BR_NULL=j,r.BR_BRUTE_FORCE=W,r.BR_SWEEP_AND_PRUNE=F,r.BR_BOUNDING_VOLUME_TREE=_t,r.BODY_NULL=ii,r.BODY_DYNAMIC=1,r.BODY_STATIC=2,r.BODY_KINEMATIC=3,r.BODY_GHOST=4,r.SHAPE_NULL=Ft,r.SHAPE_SPHERE=At,r.SHAPE_BOX=Xt,r.SHAPE_CYLINDER=Li,r.SHAPE_PLANE=Ei,r.SHAPE_PARTICLE=yi,r.SHAPE_TETRA=6,r.JOINT_NULL=Qs,r.JOINT_DISTANCE=te,r.JOINT_BALL_AND_SOCKET=de,r.JOINT_HINGE=Se,r.JOINT_WHEEL=Ie,r.JOINT_SLIDER=Yn,r.JOINT_PRISMATIC=Xn,r.AABB_PROX=.005,r.printError=bs,r.InfoDisplay=bn,Object.defineProperty(r,"__esModule",{value:!0})});const Xc={...bc,enhanceApp({app:r}){r.component("demo-preview",Gc)}};export{Xc as R};
