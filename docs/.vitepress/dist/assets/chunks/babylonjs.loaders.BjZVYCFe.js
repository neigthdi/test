import{r as be,c as Ee}from"./index.BHBPjqeI.js";var Re={exports:{}};(function(Me,xe){(function(Fe,ge){Me.exports=ge(be())})(typeof self<"u"?self:typeof Ee<"u"?Ee:Ee,Le=>(()=>{var Fe={"../../../dev/loaders/src/OBJ/index.ts":(N,E,h)=>{h.r(E),h.d(E,{MTLFileLoader:()=>s.MTLFileLoader,OBJFileLoader:()=>v.OBJFileLoader,SolidParser:()=>u.SolidParser});var s=h("../../../dev/loaders/src/OBJ/mtlFileLoader.ts");h("../../../dev/loaders/src/OBJ/objLoadingOptions.ts");var u=h("../../../dev/loaders/src/OBJ/solidParser.ts"),v=h("../../../dev/loaders/src/OBJ/objFileLoader.ts")},"../../../dev/loaders/src/OBJ/mtlFileLoader.ts":(N,E,h)=>{h.r(E),h.d(E,{MTLFileLoader:()=>u});var s=h("babylonjs/Misc/observable"),u=function(){function v(){this.materials=[]}return v.prototype.parseMTL=function(m,l,i,n){if(!(l instanceof ArrayBuffer)){for(var t=l.split(`
`),e=/\s+/,r,a=null,o=0;o<t.length;o++){var c=t[o].trim();if(!(c.length===0||c.charAt(0)==="#")){var d=c.indexOf(" "),f=d>=0?c.substring(0,d):c;f=f.toLowerCase();var T=d>=0?c.substring(d+1).trim():"";if(f==="newmtl")a&&this.materials.push(a),m._blockEntityCollection=!!n,a=new s.StandardMaterial(T,m),a._parentContainer=n,m._blockEntityCollection=!1;else if(f==="kd"&&a)r=T.split(e,3).map(parseFloat),a.diffuseColor=s.Color3.FromArray(r);else if(f==="ka"&&a)r=T.split(e,3).map(parseFloat),a.ambientColor=s.Color3.FromArray(r);else if(f==="ks"&&a)r=T.split(e,3).map(parseFloat),a.specularColor=s.Color3.FromArray(r);else if(f==="ke"&&a)r=T.split(e,3).map(parseFloat),a.emissiveColor=s.Color3.FromArray(r);else if(f==="ns"&&a)a.specularPower=parseFloat(T);else if(f==="d"&&a)a.alpha=parseFloat(T);else if(f==="map_ka"&&a)a.ambientTexture=v._GetTexture(i,T,m);else if(f==="map_kd"&&a)a.diffuseTexture=v._GetTexture(i,T,m);else if(f==="map_ks"&&a)a.specularTexture=v._GetTexture(i,T,m);else if(f!=="map_ns")if(f==="map_bump"&&a){var g=T.split(e),F=g.indexOf("-bm"),M=null;F>=0&&(M=g[F+1],g.splice(F,2)),a.bumpTexture=v._GetTexture(i,g.join(" "),m),a.bumpTexture&&M!==null&&(a.bumpTexture.level=parseFloat(M))}else f==="map_d"&&a&&(a.opacityTexture=v._GetTexture(i,T,m))}}a&&this.materials.push(a)}},v._GetTexture=function(m,l,i){if(!l)return null;var n=m;if(m==="file:"){var t=l.lastIndexOf("\\");t===-1&&(t=l.lastIndexOf("/")),t>-1?n+=l.substr(t+1):n+=l}else n+=l;return new s.Texture(n,i,!1,v.INVERT_TEXTURE_Y)},v.INVERT_TEXTURE_Y=!0,v}()},"../../../dev/loaders/src/OBJ/objFileLoader.ts":(N,E,h)=>{h.r(E),h.d(E,{OBJFileLoader:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/OBJ/mtlFileLoader.ts"),v=h("../../../dev/loaders/src/OBJ/solidParser.ts"),m=function(){function l(i){this.name="obj",this.extensions=".obj",this._assetContainer=null,this._loadingOptions=i||l._DefaultLoadingOptions}return Object.defineProperty(l,"INVERT_TEXTURE_Y",{get:function(){return u.MTLFileLoader.INVERT_TEXTURE_Y},set:function(i){u.MTLFileLoader.INVERT_TEXTURE_Y=i},enumerable:!1,configurable:!0}),Object.defineProperty(l,"_DefaultLoadingOptions",{get:function(){return{computeNormals:l.COMPUTE_NORMALS,optimizeNormals:l.OPTIMIZE_NORMALS,importVertexColors:l.IMPORT_VERTEX_COLORS,invertY:l.INVERT_Y,invertTextureY:l.INVERT_TEXTURE_Y,UVScaling:l.UV_SCALING,materialLoadingFailsSilently:l.MATERIAL_LOADING_FAILS_SILENTLY,optimizeWithUV:l.OPTIMIZE_WITH_UV,skipMaterials:l.SKIP_MATERIALS,useLegacyBehavior:l.USE_LEGACY_BEHAVIOR}},enumerable:!1,configurable:!0}),l.prototype._loadMTL=function(i,n,t,e){var r=n+i;s.Tools.LoadFile(r,t,void 0,void 0,!1,function(a,o){e(r,o)})},l.prototype.createPlugin=function(){return new l(l._DefaultLoadingOptions)},l.prototype.canDirectLoad=function(){return!1},l.prototype.importMeshAsync=function(i,n,t,e){return this._parseSolid(i,n,t,e).then(function(r){return{meshes:r,particleSystems:[],skeletons:[],animationGroups:[],transformNodes:[],geometries:[],lights:[],spriteManagers:[]}})},l.prototype.loadAsync=function(i,n,t){return this.importMeshAsync(null,i,n,t).then(function(){})},l.prototype.loadAssetContainerAsync=function(i,n,t){var e=this,r=new s.AssetContainer(i);return this._assetContainer=r,this.importMeshAsync(null,i,n,t).then(function(a){return a.meshes.forEach(function(o){return r.meshes.push(o)}),a.meshes.forEach(function(o){var c=o.material;if(c&&r.materials.indexOf(c)==-1){r.materials.push(c);var d=c.getActiveTextures();d.forEach(function(f){r.textures.indexOf(f)==-1&&r.textures.push(f)})}}),e._assetContainer=null,r}).catch(function(a){throw e._assetContainer=null,a})},l.prototype._parseSolid=function(i,n,t,e){var r=this,a="",o=new u.MTLFileLoader,c=[],d=[],f=new v.SolidParser(c,d,this._loadingOptions);f.parse(i,t,n,this._assetContainer,function(g){a=g});var T=[];return a!==""&&!this._loadingOptions.skipMaterials&&T.push(new Promise(function(g,F){r._loadMTL(a,e,function(M){try{o.parseMTL(n,M,e,r._assetContainer);for(var C=0;C<o.materials.length;C++){for(var R=0,B=[],K=void 0;(K=c.indexOf(o.materials[C].name,R))>-1;)B.push(K),R=K+1;if(K===-1&&B.length===0)o.materials[C].dispose();else for(var V=0;V<B.length;V++){var j=d[B[V]],z=o.materials[C];j.material=z,j.getTotalIndices()||(z.pointsCloud=!0)}}g()}catch(Z){s.Tools.Warn("Error processing MTL file: '".concat(a,"'")),r._loadingOptions.materialLoadingFailsSilently?g():F(Z)}},function(M,C){s.Tools.Warn("Error downloading MTL file: '".concat(a,"'")),r._loadingOptions.materialLoadingFailsSilently?g():F(C)})})),Promise.all(T).then(function(){var g=function(F){var M,C;return!!((C=(M=F._internalMetadata)===null||M===void 0?void 0:M._isLine)!==null&&C!==void 0&&C)};return d.forEach(function(F){var M,C;if(g(F)){var R=(M=F.material)!==null&&M!==void 0?M:new s.StandardMaterial(F.name+"_line",n),B=R.getBindedMeshes().filter(function(K){return!g(K)}).length>0;B&&(R=(C=R.clone(R.name+"_line"))!==null&&C!==void 0?C:R),R.wireframe=!0,F.material=R,F._internalMetadata&&(F._internalMetadata._isLine=void 0)}}),d})},l.OPTIMIZE_WITH_UV=!0,l.INVERT_Y=!1,l.IMPORT_VERTEX_COLORS=!1,l.COMPUTE_NORMALS=!1,l.OPTIMIZE_NORMALS=!1,l.UV_SCALING=new s.Vector2(1,1),l.SKIP_MATERIALS=!1,l.MATERIAL_LOADING_FAILS_SILENTLY=!0,l.USE_LEGACY_BEHAVIOR=!1,l}();s.SceneLoader&&s.SceneLoader.RegisterPlugin(new m)},"../../../dev/loaders/src/OBJ/objLoadingOptions.ts":(N,E,h)=>{h.r(E)},"../../../dev/loaders/src/OBJ/solidParser.ts":(N,E,h)=>{h.r(E),h.d(E,{SolidParser:()=>u});var s=h("babylonjs/Misc/observable"),u=function(){function v(m,l,i){this._positions=[],this._normals=[],this._uvs=[],this._colors=[],this._meshesFromObj=[],this._indicesForBabylon=[],this._wrappedPositionForBabylon=[],this._wrappedUvsForBabylon=[],this._wrappedColorsForBabylon=[],this._wrappedNormalsForBabylon=[],this._tuplePosNorm=[],this._curPositionInIndices=0,this._hasMeshes=!1,this._unwrappedPositionsForBabylon=[],this._unwrappedColorsForBabylon=[],this._unwrappedNormalsForBabylon=[],this._unwrappedUVForBabylon=[],this._triangles=[],this._materialNameFromObj="",this._objMeshName="",this._increment=1,this._isFirstMaterial=!0,this._grayColor=new s.Color4(.5,.5,.5,1),this._hasLineData=!1,this._materialToUse=m,this._babylonMeshesArray=l,this._loadingOptions=i}return v.prototype._isInArray=function(m,l){m[l[0]]||(m[l[0]]={normals:[],idx:[]});var i=m[l[0]].normals.indexOf(l[1]);return i===-1?-1:m[l[0]].idx[i]},v.prototype._isInArrayUV=function(m,l){m[l[0]]||(m[l[0]]={normals:[],idx:[],uv:[]});var i=m[l[0]].normals.indexOf(l[1]);return i!=1&&l[2]===m[l[0]].uv[i]?m[l[0]].idx[i]:-1},v.prototype._setData=function(m,l,i,n,t,e,r){var a;this._loadingOptions.optimizeWithUV?a=this._isInArrayUV(this._tuplePosNorm,[m,i,l]):a=this._isInArray(this._tuplePosNorm,[m,i]),a===-1?(this._indicesForBabylon.push(this._wrappedPositionForBabylon.length),this._wrappedPositionForBabylon.push(n),this._wrappedUvsForBabylon.push(t),this._wrappedNormalsForBabylon.push(e),r!==void 0&&this._wrappedColorsForBabylon.push(r),this._tuplePosNorm[m].normals.push(i),this._tuplePosNorm[m].idx.push(this._curPositionInIndices++),this._loadingOptions.optimizeWithUV&&this._tuplePosNorm[m].uv.push(l)):this._indicesForBabylon.push(a)},v.prototype._unwrapData=function(){for(var m=0;m<this._wrappedPositionForBabylon.length;m++)this._unwrappedPositionsForBabylon.push(this._wrappedPositionForBabylon[m].x*this._handednessSign,this._wrappedPositionForBabylon[m].y,this._wrappedPositionForBabylon[m].z),this._unwrappedNormalsForBabylon.push(this._wrappedNormalsForBabylon[m].x*this._handednessSign,this._wrappedNormalsForBabylon[m].y,this._wrappedNormalsForBabylon[m].z),this._unwrappedUVForBabylon.push(this._wrappedUvsForBabylon[m].x,this._wrappedUvsForBabylon[m].y),this._loadingOptions.importVertexColors&&this._unwrappedColorsForBabylon.push(this._wrappedColorsForBabylon[m].r,this._wrappedColorsForBabylon[m].g,this._wrappedColorsForBabylon[m].b,this._wrappedColorsForBabylon[m].a);this._wrappedPositionForBabylon.length=0,this._wrappedNormalsForBabylon.length=0,this._wrappedUvsForBabylon.length=0,this._wrappedColorsForBabylon.length=0,this._tuplePosNorm.length=0,this._curPositionInIndices=0},v.prototype._getTriangles=function(m,l){for(var i=l;i<m.length-1;i++)this._pushTriangle(m,i)},v.prototype._setDataForCurrentFaceWithPattern1=function(m,l){this._getTriangles(m,l);for(var i=0;i<this._triangles.length;i++){var n=parseInt(this._triangles[i])-1;this._setData(n,0,0,this._positions[n],s.Vector2.Zero(),s.Vector3.Up(),this._loadingOptions.importVertexColors?this._colors[n]:void 0)}this._triangles.length=0},v.prototype._setDataForCurrentFaceWithPattern2=function(m,l){this._getTriangles(m,l);for(var i=0;i<this._triangles.length;i++){var n=this._triangles[i].split("/"),t=parseInt(n[0])-1,e=parseInt(n[1])-1;this._setData(t,e,0,this._positions[t],this._uvs[e],s.Vector3.Up(),this._loadingOptions.importVertexColors?this._colors[t]:void 0)}this._triangles.length=0},v.prototype._setDataForCurrentFaceWithPattern3=function(m,l){this._getTriangles(m,l);for(var i=0;i<this._triangles.length;i++){var n=this._triangles[i].split("/"),t=parseInt(n[0])-1,e=parseInt(n[1])-1,r=parseInt(n[2])-1;this._setData(t,e,r,this._positions[t],this._uvs[e],this._normals[r])}this._triangles.length=0},v.prototype._setDataForCurrentFaceWithPattern4=function(m,l){this._getTriangles(m,l);for(var i=0;i<this._triangles.length;i++){var n=this._triangles[i].split("//"),t=parseInt(n[0])-1,e=parseInt(n[1])-1;this._setData(t,1,e,this._positions[t],s.Vector2.Zero(),this._normals[e],this._loadingOptions.importVertexColors?this._colors[t]:void 0)}this._triangles.length=0},v.prototype._setDataForCurrentFaceWithPattern5=function(m,l){this._getTriangles(m,l);for(var i=0;i<this._triangles.length;i++){var n=this._triangles[i].split("/"),t=this._positions.length+parseInt(n[0]),e=this._uvs.length+parseInt(n[1]),r=this._normals.length+parseInt(n[2]);this._setData(t,e,r,this._positions[t],this._uvs[e],this._normals[r],this._loadingOptions.importVertexColors?this._colors[t]:void 0)}this._triangles.length=0},v.prototype._addPreviousObjMesh=function(){this._meshesFromObj.length>0&&(this._handledMesh=this._meshesFromObj[this._meshesFromObj.length-1],this._unwrapData(),this._loadingOptions.useLegacyBehavior&&this._indicesForBabylon.reverse(),this._handledMesh.indices=this._indicesForBabylon.slice(),this._handledMesh.positions=this._unwrappedPositionsForBabylon.slice(),this._handledMesh.normals=this._unwrappedNormalsForBabylon.slice(),this._handledMesh.uvs=this._unwrappedUVForBabylon.slice(),this._handledMesh.hasLines=this._hasLineData,this._loadingOptions.importVertexColors&&(this._handledMesh.colors=this._unwrappedColorsForBabylon.slice()),this._indicesForBabylon.length=0,this._unwrappedPositionsForBabylon.length=0,this._unwrappedColorsForBabylon.length=0,this._unwrappedNormalsForBabylon.length=0,this._unwrappedUVForBabylon.length=0,this._hasLineData=!1)},v.prototype._optimizeNormals=function(m){var l=m.getVerticesData(s.VertexBuffer.PositionKind),i=m.getVerticesData(s.VertexBuffer.NormalKind),n={};if(!(!l||!i)){for(var t=0;t<l.length/3;t++){var e=l[t*3+0],r=l[t*3+1],a=l[t*3+2],o=e+"_"+r+"_"+a,c=n[o];c||(c=[],n[o]=c),c.push(t)}var d=new s.Vector3;for(var o in n){var c=n[o];if(!(c.length<2)){for(var f=c[0],t=1;t<c.length;++t){var T=c[t];i[f*3+0]+=i[T*3+0],i[f*3+1]+=i[T*3+1],i[f*3+2]+=i[T*3+2]}d.copyFromFloats(i[f*3+0],i[f*3+1],i[f*3+2]),d.normalize();for(var t=0;t<c.length;++t){var T=c[t];i[T*3+0]=d.x,i[T*3+1]=d.y,i[T*3+2]=d.z}}}m.setVerticesData(s.VertexBuffer.NormalKind,i)}},v.prototype.parse=function(m,l,i,n,t){var e=this,r,a;this._loadingOptions.useLegacyBehavior?(this._pushTriangle=function(x,p){return e._triangles.push(x[0],x[p],x[p+1])},this._handednessSign=1):i.useRightHandedSystem?(this._pushTriangle=function(x,p){return e._triangles.push(x[0],x[p+1],x[p])},this._handednessSign=1):(this._pushTriangle=function(x,p){return e._triangles.push(x[0],x[p],x[p+1])},this._handednessSign=-1);for(var o=l.split(`
`),c=0;c<o.length;c++){var d=o[c].trim().replace(/\s\s/g," "),f=void 0;if(!(d.length===0||d.charAt(0)==="#"))if(v.VertexPattern.test(d)){if(f=d.match(/[^ ]+/g),this._positions.push(new s.Vector3(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]))),this._loadingOptions.importVertexColors)if(f.length>=7){var T=parseFloat(f[4]),g=parseFloat(f[5]),F=parseFloat(f[6]);this._colors.push(new s.Color4(T>1?T/255:T,g>1?g/255:g,F>1?F/255:F,f.length===7||f[7]===void 0?1:parseFloat(f[7])))}else this._colors.push(this._grayColor)}else if((f=v.NormalPattern.exec(d))!==null)this._normals.push(new s.Vector3(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])));else if((f=v.UVPattern.exec(d))!==null)this._uvs.push(new s.Vector2(parseFloat(f[1])*this._loadingOptions.UVScaling.x,parseFloat(f[2])*this._loadingOptions.UVScaling.y));else if((f=v.FacePattern3.exec(d))!==null)this._setDataForCurrentFaceWithPattern3(f[1].trim().split(" "),1);else if((f=v.FacePattern4.exec(d))!==null)this._setDataForCurrentFaceWithPattern4(f[1].trim().split(" "),1);else if((f=v.FacePattern5.exec(d))!==null)this._setDataForCurrentFaceWithPattern5(f[1].trim().split(" "),1);else if((f=v.FacePattern2.exec(d))!==null)this._setDataForCurrentFaceWithPattern2(f[1].trim().split(" "),1);else if((f=v.FacePattern1.exec(d))!==null)this._setDataForCurrentFaceWithPattern1(f[1].trim().split(" "),1);else if((f=v.LinePattern1.exec(d))!==null)this._setDataForCurrentFaceWithPattern1(f[1].trim().split(" "),0),this._hasLineData=!0;else if((f=v.LinePattern2.exec(d))!==null)this._setDataForCurrentFaceWithPattern2(f[1].trim().split(" "),0),this._hasLineData=!0;else if((f=v.LinePattern3.exec(d))!==null)this._setDataForCurrentFaceWithPattern3(f[1].trim().split(" "),0),this._hasLineData=!0;else if(v.GroupDescriptor.test(d)||v.ObjectDescriptor.test(d)){var M={name:d.substring(2).trim(),indices:null,positions:null,normals:null,uvs:null,colors:null,materialName:this._materialNameFromObj,isObject:v.ObjectDescriptor.test(d)};this._addPreviousObjMesh(),this._meshesFromObj.push(M),this._hasMeshes=!0,this._isFirstMaterial=!0,this._increment=1}else if(v.UseMtlDescriptor.test(d)){if(this._materialNameFromObj=d.substring(7).trim(),!this._isFirstMaterial||!this._hasMeshes){this._addPreviousObjMesh();var M={name:(this._objMeshName||"mesh")+"_mm"+this._increment.toString(),indices:null,positions:null,normals:null,uvs:null,colors:null,materialName:this._materialNameFromObj,isObject:!1};this._increment++,this._meshesFromObj.push(M),this._hasMeshes=!0}this._hasMeshes&&this._isFirstMaterial&&(this._meshesFromObj[this._meshesFromObj.length-1].materialName=this._materialNameFromObj,this._isFirstMaterial=!1)}else v.MtlLibGroupDescriptor.test(d)?t(d.substring(7).trim()):v.SmoothDescriptor.test(d)||s.Logger.Log("Unhandled expression at line : "+d)}if(this._hasMeshes&&(this._handledMesh=this._meshesFromObj[this._meshesFromObj.length-1],this._loadingOptions.useLegacyBehavior&&this._indicesForBabylon.reverse(),this._unwrapData(),this._handledMesh.indices=this._indicesForBabylon,this._handledMesh.positions=this._unwrappedPositionsForBabylon,this._handledMesh.normals=this._unwrappedNormalsForBabylon,this._handledMesh.uvs=this._unwrappedUVForBabylon,this._handledMesh.hasLines=this._hasLineData,this._loadingOptions.importVertexColors&&(this._handledMesh.colors=this._unwrappedColorsForBabylon)),!this._hasMeshes){var C=null;if(this._indicesForBabylon.length)this._loadingOptions.useLegacyBehavior&&this._indicesForBabylon.reverse(),this._unwrapData();else{for(var R=0,B=this._positions;R<B.length;R++){var K=B[R];this._unwrappedPositionsForBabylon.push(K.x,K.y,K.z)}if(this._normals.length)for(var V=0,j=this._normals;V<j.length;V++){var z=j[V];this._unwrappedNormalsForBabylon.push(z.x,z.y,z.z)}if(this._uvs.length)for(var Z=0,Q=this._uvs;Z<Q.length;Z++){var k=Q[Z];this._unwrappedUVForBabylon.push(k.x,k.y)}if(this._colors.length)for(var oe=0,ue=this._colors;oe<ue.length;oe++){var ie=ue[oe];this._unwrappedColorsForBabylon.push(ie.r,ie.g,ie.b,ie.a)}this._materialNameFromObj||(C=new s.StandardMaterial(s.Geometry.RandomId(),i),C.pointsCloud=!0,this._materialNameFromObj=C.name,this._normals.length||(C.disableLighting=!0,C.emissiveColor=s.Color3.White()))}this._meshesFromObj.push({name:s.Geometry.RandomId(),indices:this._indicesForBabylon,positions:this._unwrappedPositionsForBabylon,colors:this._unwrappedColorsForBabylon,normals:this._unwrappedNormalsForBabylon,uvs:this._unwrappedUVForBabylon,materialName:this._materialNameFromObj,directMaterial:C,isObject:!0})}for(var q=0;q<this._meshesFromObj.length;q++){if(m&&this._meshesFromObj[q].name){if(m instanceof Array){if(m.indexOf(this._meshesFromObj[q].name)===-1)continue}else if(this._meshesFromObj[q].name!==m)continue}this._handledMesh=this._meshesFromObj[q],i._blockEntityCollection=!!n;var ee=new s.Mesh(this._meshesFromObj[q].name,i);if(ee._parentContainer=n,i._blockEntityCollection=!1,this._handledMesh._babylonMesh=ee,!this._handledMesh.isObject){for(var $=q-1;$>=0;--$)if(this._meshesFromObj[$].isObject&&this._meshesFromObj[$]._babylonMesh){ee.parent=this._meshesFromObj[$]._babylonMesh;break}}if(this._materialToUse.push(this._meshesFromObj[q].materialName),this._handledMesh.hasLines&&((r=ee._internalMetadata)!==null&&r!==void 0||(ee._internalMetadata={}),ee._internalMetadata._isLine=!0),((a=this._handledMesh.positions)===null||a===void 0?void 0:a.length)===0){this._babylonMeshesArray.push(ee);continue}var O=new s.VertexData;if(O.uvs=this._handledMesh.uvs,O.indices=this._handledMesh.indices,O.positions=this._handledMesh.positions,this._loadingOptions.computeNormals){var b=new Array;s.VertexData.ComputeNormals(this._handledMesh.positions,this._handledMesh.indices,b),O.normals=b}else O.normals=this._handledMesh.normals;this._loadingOptions.importVertexColors&&(O.colors=this._handledMesh.colors),O.applyToMesh(ee),this._loadingOptions.invertY&&(ee.scaling.y*=-1),this._loadingOptions.optimizeNormals&&this._optimizeNormals(ee),this._babylonMeshesArray.push(ee),this._handledMesh.directMaterial&&(ee.material=this._handledMesh.directMaterial)}},v.ObjectDescriptor=/^o/,v.GroupDescriptor=/^g/,v.MtlLibGroupDescriptor=/^mtllib /,v.UseMtlDescriptor=/^usemtl /,v.SmoothDescriptor=/^s /,v.VertexPattern=/^v(\s+[\d|.|+|\-|e|E]+){3,7}/,v.NormalPattern=/^vn(\s+[\d|.|+|\-|e|E]+)( +[\d|.|+|\-|e|E]+)( +[\d|.|+|\-|e|E]+)/,v.UVPattern=/^vt(\s+[\d|.|+|\-|e|E]+)( +[\d|.|+|\-|e|E]+)/,v.FacePattern1=/^f\s+(([\d]{1,}[\s]?){3,})+/,v.FacePattern2=/^f\s+((([\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,v.FacePattern3=/^f\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,v.FacePattern4=/^f\s+((([\d]{1,}\/\/[\d]{1,}[\s]?){3,})+)/,v.FacePattern5=/^f\s+(((-[\d]{1,}\/-[\d]{1,}\/-[\d]{1,}[\s]?){3,})+)/,v.LinePattern1=/^l\s+(([\d]{1,}[\s]?){2,})+/,v.LinePattern2=/^l\s+((([\d]{1,}\/[\d]{1,}[\s]?){2,})+)/,v.LinePattern3=/^l\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){2,})+)/,v}()},"../../../dev/loaders/src/SPLAT/index.ts":(N,E,h)=>{h.r(E),h.d(E,{SPLATFileLoader:()=>s.SPLATFileLoader});var s=h("../../../dev/loaders/src/SPLAT/splatFileLoader.ts")},"../../../dev/loaders/src/SPLAT/splatFileLoader.ts":(N,E,h)=>{h.r(E),h.d(E,{SPLATFileLoader:()=>v});var s=h("../../../../node_modules/tslib/tslib.es6.mjs"),u=h("babylonjs/Misc/observable"),v=function(){function m(){this.name="splat",this.extensions={".splat":{isBinary:!0},".ply":{isBinary:!0}}}return m.prototype.createPlugin=function(){return new m},m.prototype.canDirectLoad=function(){return!1},m.prototype.importMeshAsync=function(l,i,n,t,e,r){return(0,s.__awaiter)(this,void 0,void 0,function(){var a;return(0,s.__generator)(this,function(o){switch(o.label){case 0:return a=new u.GaussianSplattingMesh("GaussianSplatting",null,i),[4,a.loadFileAsync(t+(r??""))];case 1:return o.sent(),[2,{meshes:[a],particleSystems:[],skeletons:[],animationGroups:[],transformNodes:[],geometries:[],lights:[],spriteManagers:[]}]}})})},m.prototype.loadAsync=function(l,i,n){var t=new u.GaussianSplattingMesh("GaussianSplatting",null,l);return t.loadDataAsync(u.GaussianSplattingMesh.ConvertPLYToSplat(i))},m.prototype.loadAssetContainerAsync=function(l,i,n){throw new Error("loadAssetContainerAsync not implemented for Gaussian Splatting loading")},m}();u.SceneLoader&&u.SceneLoader.RegisterPlugin(new v)},"../../../dev/loaders/src/STL/index.ts":(N,E,h)=>{h.r(E),h.d(E,{STLFileLoader:()=>s.STLFileLoader});var s=h("../../../dev/loaders/src/STL/stlFileLoader.ts")},"../../../dev/loaders/src/STL/stlFileLoader.ts":(N,E,h)=>{h.r(E),h.d(E,{STLFileLoader:()=>u});var s=h("babylonjs/Misc/observable"),u=function(){function v(){this.solidPattern=/solid (\S*)([\S\s]*?)endsolid[ ]*(\S*)/g,this.facetsPattern=/facet([\s\S]*?)endfacet/g,this.normalPattern=/normal[\s]+([-+]?[0-9]+\.?[0-9]*([eE][-+]?[0-9]+)?)+[\s]+([-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)+[\s]+([-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)+/g,this.vertexPattern=/vertex[\s]+([-+]?[0-9]+\.?[0-9]*([eE][-+]?[0-9]+)?)+[\s]+([-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)+[\s]+([-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)+/g,this.name="stl",this.extensions={".stl":{isBinary:!0}}}return v.prototype.importMesh=function(m,l,i,n,t){var e;if(typeof i!="string"){if(this._isBinary(i)){var r=new s.Mesh("stlmesh",l);return this._parseBinary(r,i),t&&t.push(r),!0}i=new TextDecoder().decode(new Uint8Array(i))}for(;e=this.solidPattern.exec(i);){var a=e[1],o=e[3];if(o&&a!=o)return s.Tools.Error("Error in STL, solid name != endsolid name"),!1;if(m&&a){if(m instanceof Array){if(!m.indexOf(a))continue}else if(a!==m)continue}a=a||"stlmesh";var r=new s.Mesh(a,l);this._parseASCII(r,e[2]),t&&t.push(r)}return!0},v.prototype.load=function(m,l,i){var n=this.importMesh(null,m,l,i,null);return n},v.prototype.loadAssetContainer=function(m,l,i){var n=new s.AssetContainer(m);return m._blockEntityCollection=!0,this.importMesh(null,m,l,i,n.meshes),m._blockEntityCollection=!1,n},v.prototype._isBinary=function(m){var l=new DataView(m);if(l.byteLength<=80)return!1;var i=32/8*3+32/8*3*3+16/8,n=l.getUint32(80,!0);if(80+32/8+n*i===l.byteLength)return!0;for(var t=[115,111,108,105,100],e=0;e<5;e++)if(l.getUint8(e)!==t[e])return!0;return!1},v.prototype._parseBinary=function(m,l){for(var i=new DataView(l),n=i.getUint32(80,!0),t=84,e=12*4+2,r=0,a=new Float32Array(n*3*3),o=new Float32Array(n*3*3),c=new Uint32Array(n*3),d=0,f=0;f<n;f++){for(var T=t+f*e,g=i.getFloat32(T,!0),F=i.getFloat32(T+4,!0),M=i.getFloat32(T+8,!0),C=1;C<=3;C++){var R=T+C*12;a[r]=i.getFloat32(R,!0),o[r]=g,v.DO_NOT_ALTER_FILE_COORDINATES?(a[r+1]=i.getFloat32(R+4,!0),a[r+2]=i.getFloat32(R+8,!0),o[r+1]=F,o[r+2]=M):(a[r+2]=i.getFloat32(R+4,!0),a[r+1]=i.getFloat32(R+8,!0),o[r+2]=F,o[r+1]=M),r+=3}v.DO_NOT_ALTER_FILE_COORDINATES?(c[d]=d,c[d+1]=d+2,c[d+2]=d+1,d+=3):(c[d]=d++,c[d]=d++,c[d]=d++)}m.setVerticesData(s.VertexBuffer.PositionKind,a),m.setVerticesData(s.VertexBuffer.NormalKind,o),m.setIndices(c),m.computeWorldMatrix(!0)},v.prototype._parseASCII=function(m,l){for(var i=[],n=[],t=[],e=0,r;r=this.facetsPattern.exec(l);){var a=r[1],o=this.normalPattern.exec(a);if(this.normalPattern.lastIndex=0,!!o){for(var c=[Number(o[1]),Number(o[5]),Number(o[3])],d=void 0;d=this.vertexPattern.exec(a);)v.DO_NOT_ALTER_FILE_COORDINATES?(i.push(Number(d[1]),Number(d[3]),Number(d[5])),n.push(c[0],c[2],c[1])):(i.push(Number(d[1]),Number(d[5]),Number(d[3])),n.push(c[0],c[1],c[2]));v.DO_NOT_ALTER_FILE_COORDINATES?(t.push(e,e+2,e+1),e+=3):t.push(e++,e++,e++),this.vertexPattern.lastIndex=0}}this.facetsPattern.lastIndex=0,m.setVerticesData(s.VertexBuffer.PositionKind,i),m.setVerticesData(s.VertexBuffer.NormalKind,n),m.setIndices(t),m.computeWorldMatrix(!0)},v.DO_NOT_ALTER_FILE_COORDINATES=!1,v}();s.SceneLoader&&s.SceneLoader.RegisterPlugin(new u)},"../../../dev/loaders/src/glTF/1.0/glTFBinaryExtension.ts":(N,E,h)=>{h.r(E),h.d(E,{GLTFBinaryExtension:()=>i});var s=h("../../../../node_modules/tslib/tslib.es6.mjs"),u=h("../../../dev/loaders/src/glTF/1.0/glTFLoader.ts"),v=h("../../../dev/loaders/src/glTF/1.0/glTFLoaderUtils.ts"),m=h("../../../dev/loaders/src/glTF/1.0/glTFLoaderInterfaces.ts"),l="binary_glTF",i=function(n){(0,s.__extends)(t,n);function t(){return n.call(this,"KHR_binary_glTF")||this}return t.prototype.loadRuntimeAsync=function(e,r,a,o){var c=r.json.extensionsUsed;return!c||c.indexOf(this.name)===-1||!r.bin?!1:(this._bin=r.bin,o(u.GLTFLoaderBase.CreateRuntime(r.json,e,a)),!0)},t.prototype.loadBufferAsync=function(e,r,a,o){return e.extensionsUsed.indexOf(this.name)===-1||r!==l?!1:(this._bin.readAsync(0,this._bin.byteLength).then(a,function(c){return o(c.message)}),!0)},t.prototype.loadTextureBufferAsync=function(e,r,a){var o=e.textures[r],c=e.images[o.source];if(!c.extensions||!(this.name in c.extensions))return!1;var d=c.extensions[this.name],f=e.bufferViews[d.bufferView],T=v.GLTFUtils.GetBufferFromBufferView(e,f,0,f.byteLength,m.EComponentType.UNSIGNED_BYTE);return a(T),!0},t.prototype.loadShaderStringAsync=function(e,r,a){var o=e.shaders[r];if(!o.extensions||!(this.name in o.extensions))return!1;var c=o.extensions[this.name],d=e.bufferViews[c.bufferView],f=v.GLTFUtils.GetBufferFromBufferView(e,d,0,d.byteLength,m.EComponentType.UNSIGNED_BYTE);return setTimeout(function(){var T=v.GLTFUtils.DecodeBufferToText(f);a(T)}),!0},t}(u.GLTFLoaderExtension);u.GLTFLoader.RegisterExtension(new i)},"../../../dev/loaders/src/glTF/1.0/glTFLoader.ts":(N,E,h)=>{h.r(E),h.d(E,{GLTFLoader:()=>b,GLTFLoaderBase:()=>O,GLTFLoaderExtension:()=>x});var s=h("../../../dev/loaders/src/glTF/1.0/glTFLoaderInterfaces.ts"),u=h("babylonjs/Misc/observable"),v=h("../../../dev/loaders/src/glTF/1.0/glTFLoaderUtils.ts"),m=h("../../../dev/loaders/src/glTF/glTFFileLoader.ts"),l;(function(p){p[p.IDENTIFIER=1]="IDENTIFIER",p[p.UNKNOWN=2]="UNKNOWN",p[p.END_OF_INPUT=3]="END_OF_INPUT"})(l||(l={}));var i=function(){function p(_){this._pos=0,this.currentToken=l.UNKNOWN,this.currentIdentifier="",this.currentString="",this.isLetterOrDigitPattern=/^[a-zA-Z0-9]+$/,this._toParse=_,this._maxPos=_.length}return p.prototype.getNextToken=function(){if(this.isEnd())return l.END_OF_INPUT;if(this.currentString=this.read(),this.currentToken=l.UNKNOWN,this.currentString==="_"||this.isLetterOrDigitPattern.test(this.currentString))for(this.currentToken=l.IDENTIFIER,this.currentIdentifier=this.currentString;!this.isEnd()&&(this.isLetterOrDigitPattern.test(this.currentString=this.peek())||this.currentString==="_");)this.currentIdentifier+=this.currentString,this.forward();return this.currentToken},p.prototype.peek=function(){return this._toParse[this._pos]},p.prototype.read=function(){return this._toParse[this._pos++]},p.prototype.forward=function(){this._pos++},p.prototype.isEnd=function(){return this._pos>=this._maxPos},p}(),n=["MODEL","VIEW","PROJECTION","MODELVIEW","MODELVIEWPROJECTION","JOINTMATRIX"],t=["world","view","projection","worldView","worldViewProjection","mBones"],e=["translation","rotation","scale"],r=["position","rotationQuaternion","scaling"],a=function(p,_){for(var y in p){var A=p[y];_.buffers[y]=A,_.buffersCount++}},o=function(p,_){for(var y in p){var A=p[y];_.shaders[y]=A,_.shaderscount++}},c=function(p,_,y){for(var A in p){var L=p[A];y[_][A]=L}},d=function(p){if(p)for(var _=0;_<p.length/2;_++)p[_*2+1]=1-p[_*2+1]},f=function(p){if(p.semantic==="NORMAL")return"normal";if(p.semantic==="POSITION")return"position";if(p.semantic==="JOINT")return"matricesIndices";if(p.semantic==="WEIGHT")return"matricesWeights";if(p.semantic==="COLOR")return"color";if(p.semantic&&p.semantic.indexOf("TEXCOORD_")!==-1){var _=Number(p.semantic.split("_")[1]);return"uv"+(_===0?"":_+1)}return null},T=function(p){for(var _ in p.animations){var y=p.animations[_];if(!(!y.channels||!y.samplers))for(var A=null,L=0;L<y.channels.length;L++){var S=y.channels[L],P=y.samplers[S.sampler];if(P){var I=null,D=null;y.parameters?(I=y.parameters[P.input],D=y.parameters[P.output]):(I=P.input,D=P.output);var G=v.GLTFUtils.GetBufferFromAccessor(p,p.accessors[I]),w=v.GLTFUtils.GetBufferFromAccessor(p,p.accessors[D]),W=S.target.id,U=p.scene.getNodeById(W);if(U===null&&(U=p.scene.getNodeByName(W)),U===null){u.Tools.Warn("Creating animation named "+_+". But cannot find node named "+W+" to attach to");continue}var H=U instanceof u.Bone,Y=S.target.path,X=e.indexOf(Y);X!==-1&&(Y=r[X]);var te=u.Animation.ANIMATIONTYPE_MATRIX;H||(Y==="rotationQuaternion"?(te=u.Animation.ANIMATIONTYPE_QUATERNION,U.rotationQuaternion=new u.Quaternion):te=u.Animation.ANIMATIONTYPE_VECTOR3);var ne=null,le=[],J=0,re=!1;H&&A&&A.getKeys().length===G.length&&(ne=A,re=!0),re||(p.scene._blockEntityCollection=!!p.assetContainer,ne=new u.Animation(_,H?"_matrix":Y,1,te,u.Animation.ANIMATIONLOOPMODE_CYCLE),p.scene._blockEntityCollection=!1);for(var se=0;se<G.length;se++){var ce=null;if(Y==="rotationQuaternion"?(ce=u.Quaternion.FromArray([w[J],w[J+1],w[J+2],w[J+3]]),J+=4):(ce=u.Vector3.FromArray([w[J],w[J+1],w[J+2]]),J+=3),H){var Te=U,fe=u.Vector3.Zero(),ve=new u.Quaternion,he=u.Vector3.Zero(),_e=Te.getBaseMatrix();re&&A&&(_e=A.getKeys()[se].value),_e.decompose(he,ve,fe),Y==="position"?fe=ce:Y==="rotationQuaternion"?ve=ce:he=ce,ce=u.Matrix.Compose(he,ve,fe)}re?A&&(A.getKeys()[se].value=ce):le.push({frame:G[se],value:ce})}!re&&ne&&(ne.setKeys(le),U.animations.push(ne)),A=ne,p.scene.stopAnimation(U),p.scene.beginAnimation(U,0,G[G.length-1],!0,1)}}}},g=function(p){var _=null;if(p.translation||p.rotation||p.scale){var y=u.Vector3.FromArray(p.scale||[1,1,1]),A=u.Quaternion.FromArray(p.rotation||[0,0,0,1]),L=u.Vector3.FromArray(p.translation||[0,0,0]);_=u.Matrix.Compose(y,A,L)}else _=u.Matrix.FromArray(p.matrix);return _},F=function(p,_,y,A){for(var L=0;L<A.bones.length;L++)if(A.bones[L].name===y)return A.bones[L];var S=p.nodes;for(var P in S){var I=S[P];if(I.jointName)for(var D=I.children,L=0;L<D.length;L++){var G=p.nodes[D[L]];if(G.jointName&&G.jointName===y){var w=g(I),W=new u.Bone(I.name||"",A,F(p,_,I.jointName,A),w);return W.id=P,W}}}return null},M=function(p,_){for(var y=0;y<p.length;y++)for(var A=p[y],L=0;L<A.node.children.length;L++){var S=A.node.children[L];if(S===_)return A.bone}return null},C=function(p,_){var y=p.nodes,A=y[_];if(A)return{node:A,id:_};for(var L in y)if(A=y[L],A.jointName===_)return{node:A,id:L};return null},R=function(p,_){for(var y=0;y<p.jointNames.length;y++)if(p.jointNames[y]===_)return!0;return!1},B=function(p,_,y,A){for(var L in p.nodes){var S=p.nodes[L],P=L;if(!(!S.jointName||R(y,S.jointName))){var I=g(S),D=new u.Bone(S.name||"",_,null,I);D.id=P,A.push({bone:D,node:S,id:P})}}for(var G=0;G<A.length;G++)for(var w=A[G],W=w.node.children,U=0;U<W.length;U++){for(var H=null,Y=0;Y<A.length;Y++)if(A[Y].id===W[U]){H=A[Y];break}H&&(H.bone._parent=w.bone,w.bone.children.push(H.bone))}},K=function(p,_,y,A){if(A||(A=new u.Skeleton(_.name||"","",p.scene)),!_.babylonSkeleton)return A;var L=[],S=[];B(p,A,_,L),A.bones=[];for(var P=0;P<_.jointNames.length;P++){var I=C(p,_.jointNames[P]);if(I){var D=I.node;if(!D){u.Tools.Warn("Joint named "+_.jointNames[P]+" does not exist");continue}var G=I.id,w=p.scene.getBoneById(G);if(w){A.bones.push(w);continue}for(var W=!1,U=null,H=0;H<P;H++){var Y=C(p,_.jointNames[H]);if(Y){var X=Y.node;if(!X){u.Tools.Warn("Joint named "+_.jointNames[H]+" does not exist when looking for parent");continue}var te=X.children;if(te){W=!1;for(var ne=0;ne<te.length;ne++)if(te[ne]===G){U=F(p,_,_.jointNames[H],A),W=!0;break}if(W)break}}}var le=g(D);!U&&L.length>0&&(U=M(L,G),U&&S.indexOf(U)===-1&&S.push(U));var J=new u.Bone(D.jointName||"",A,U,le);J.id=G}}var re=A.bones;A.bones=[];for(var P=0;P<_.jointNames.length;P++){var I=C(p,_.jointNames[P]);if(I){for(var H=0;H<re.length;H++)if(re[H].id===I.id){A.bones.push(re[H]);break}}}A.prepare();for(var P=0;P<S.length;P++)A.bones.push(S[P]);return A},V=function(p,_,y,A,L){if(L||(p.scene._blockEntityCollection=!!p.assetContainer,L=new u.Mesh(_.name||"",p.scene),L._parentContainer=p.assetContainer,p.scene._blockEntityCollection=!1,L.id=A),!_.babylonNode)return L;for(var S=[],P=null,I=[],D=[],G=[],w=[],W=0;W<y.length;W++){var U=y[W],H=p.meshes[U];if(H)for(var Y=0;Y<H.primitives.length;Y++){var X=new u.VertexData,te=H.primitives[Y];te.mode;var ne=te.attributes,le=null,J=null;for(var re in ne)if(le=p.accessors[ne[re]],J=v.GLTFUtils.GetBufferFromAccessor(p,le),re==="NORMAL")X.normals=new Float32Array(J.length),X.normals.set(J);else if(re==="POSITION"){if(m.GLTFFileLoader.HomogeneousCoordinates){X.positions=new Float32Array(J.length-J.length/4);for(var se=0;se<J.length;se+=4)X.positions[se]=J[se],X.positions[se+1]=J[se+1],X.positions[se+2]=J[se+2]}else X.positions=new Float32Array(J.length),X.positions.set(J);D.push(X.positions.length)}else if(re.indexOf("TEXCOORD_")!==-1){var ce=Number(re.split("_")[1]),Te=u.VertexBuffer.UVKind+(ce===0?"":ce+1),fe=new Float32Array(J.length);fe.set(J),d(fe),X.set(fe,Te)}else re==="JOINT"?(X.matricesIndices=new Float32Array(J.length),X.matricesIndices.set(J)):re==="WEIGHT"?(X.matricesWeights=new Float32Array(J.length),X.matricesWeights.set(J)):re==="COLOR"&&(X.colors=new Float32Array(J.length),X.colors.set(J));if(le=p.accessors[te.indices],le)J=v.GLTFUtils.GetBufferFromAccessor(p,le),X.indices=new Int32Array(J.length),X.indices.set(J),w.push(X.indices.length);else{for(var ve=[],se=0;se<X.positions.length/3;se++)ve.push(se);X.indices=new Int32Array(ve),w.push(X.indices.length)}P?P.merge(X):P=X;var he=p.scene.getMaterialById(te.material);S.push(he===null?v.GLTFUtils.GetDefaultMaterial(p.scene):he),I.push(I.length===0?0:I[I.length-1]+D[D.length-2]),G.push(G.length===0?0:G[G.length-1]+w[w.length-2])}}var _e;p.scene._blockEntityCollection=!!p.assetContainer,S.length>1?(_e=new u.MultiMaterial("multimat"+A,p.scene),_e.subMaterials=S):_e=new u.StandardMaterial("multimat"+A,p.scene),S.length===1&&(_e=S[0]),_e._parentContainer=p.assetContainer,L.material||(L.material=_e),new u.Geometry(A,p.scene,P,!1,L),L.computeWorldMatrix(!0),p.scene._blockEntityCollection=!1,L.subMeshes=[];for(var me=0,W=0;W<y.length;W++){var U=y[W],H=p.meshes[U];if(H)for(var Y=0;Y<H.primitives.length;Y++)H.primitives[Y].mode,u.SubMesh.AddToMesh(me,I[me],D[me],G[me],w[me],L,L,!0),me++}return L},j=function(p,_,y,A){p.position&&(p.position=_),(p.rotationQuaternion||p.rotation)&&(p.rotationQuaternion=y),p.scaling&&(p.scaling=A)},z=function(p,_){if(_.matrix){var y=new u.Vector3(0,0,0),A=new u.Quaternion,L=new u.Vector3(0,0,0),S=u.Matrix.FromArray(_.matrix);S.decompose(L,A,y),j(p,y,A,L)}else _.translation&&_.rotation&&_.scale&&j(p,u.Vector3.FromArray(_.translation),u.Quaternion.FromArray(_.rotation),u.Vector3.FromArray(_.scale));p.computeWorldMatrix(!0)},Z=function(p,_,y){var A=null;if(p.importOnlyMeshes&&(_.skin||_.meshes)&&p.importMeshesNames&&p.importMeshesNames.length>0&&p.importMeshesNames.indexOf(_.name||"")===-1)return null;if(_.skin){if(_.meshes){var L=p.skins[_.skin],S=V(p,_,_.meshes,y,_.babylonNode);S.skeleton=p.scene.getLastSkeletonById(_.skin),S.skeleton===null&&(S.skeleton=K(p,L,S,L.babylonSkeleton),L.babylonSkeleton||(L.babylonSkeleton=S.skeleton)),A=S}}else if(_.meshes){var S=V(p,_,_.mesh?[_.mesh]:_.meshes,y,_.babylonNode);A=S}else if(_.light&&!_.babylonNode&&!p.importOnlyMeshes){var P=p.lights[_.light];if(P){if(P.type==="ambient"){var I=P[P.type],D=new u.HemisphericLight(_.light,u.Vector3.Zero(),p.scene);D.name=_.name||"",I.color&&(D.diffuse=u.Color3.FromArray(I.color)),A=D}else if(P.type==="directional"){var G=P[P.type],w=new u.DirectionalLight(_.light,u.Vector3.Zero(),p.scene);w.name=_.name||"",G.color&&(w.diffuse=u.Color3.FromArray(G.color)),A=w}else if(P.type==="point"){var W=P[P.type],U=new u.PointLight(_.light,u.Vector3.Zero(),p.scene);U.name=_.name||"",W.color&&(U.diffuse=u.Color3.FromArray(W.color)),A=U}else if(P.type==="spot"){var H=P[P.type],Y=new u.SpotLight(_.light,u.Vector3.Zero(),u.Vector3.Zero(),0,0,p.scene);Y.name=_.name||"",H.color&&(Y.diffuse=u.Color3.FromArray(H.color)),H.fallOfAngle&&(Y.angle=H.fallOfAngle),H.fallOffExponent&&(Y.exponent=H.fallOffExponent),A=Y}}}else if(_.camera&&!_.babylonNode&&!p.importOnlyMeshes){var X=p.cameras[_.camera];if(X){if(p.scene._blockEntityCollection=!!p.assetContainer,X.type==="orthographic"){var te=new u.FreeCamera(_.camera,u.Vector3.Zero(),p.scene,!1);te.name=_.name||"",te.mode=u.Camera.ORTHOGRAPHIC_CAMERA,te.attachControl(),A=te,te._parentContainer=p.assetContainer}else if(X.type==="perspective"){var ne=X[X.type],le=new u.FreeCamera(_.camera,u.Vector3.Zero(),p.scene,!1);le.name=_.name||"",le.attachControl(),ne.aspectRatio||(ne.aspectRatio=p.scene.getEngine().getRenderWidth()/p.scene.getEngine().getRenderHeight()),ne.znear&&ne.zfar&&(le.maxZ=ne.zfar,le.minZ=ne.znear),A=le,le._parentContainer=p.assetContainer}p.scene._blockEntityCollection=!1}}if(!_.jointName){if(_.babylonNode)return _.babylonNode;if(A===null){p.scene._blockEntityCollection=!!p.assetContainer;var J=new u.Mesh(_.name||"",p.scene);J._parentContainer=p.assetContainer,p.scene._blockEntityCollection=!1,_.babylonNode=J,A=J}}if(A!==null){if(_.matrix&&A instanceof u.Mesh)z(A,_);else{var re=_.translation||[0,0,0],se=_.rotation||[0,0,0,1],ce=_.scale||[1,1,1];j(A,u.Vector3.FromArray(re),u.Quaternion.FromArray(se),u.Vector3.FromArray(ce))}A.updateCache(!0),_.babylonNode=A}return A},Q=function(p,_,y,A){A===void 0&&(A=!1);var L=p.nodes[_],S=null;if(p.importOnlyMeshes&&!A&&p.importMeshesNames?p.importMeshesNames.indexOf(L.name||"")!==-1||p.importMeshesNames.length===0?A=!0:A=!1:A=!0,!L.jointName&&A&&(S=Z(p,L,_),S!==null&&(S.id=_,S.parent=y)),L.children)for(var P=0;P<L.children.length;P++)Q(p,L.children[P],S,A)},k=function(p){var _=p.currentScene;if(_)for(var y=0;y<_.nodes.length;y++)Q(p,_.nodes[y],null);else for(var A in p.scenes){_=p.scenes[A];for(var y=0;y<_.nodes.length;y++)Q(p,_.nodes[y],null)}T(p);for(var y=0;y<p.scene.skeletons.length;y++){var L=p.scene.skeletons[y];p.scene.beginAnimation(L,0,Number.MAX_VALUE,!0,1)}},oe=function(p,_,y,A,L,S,P){var I=S.values||L.parameters;for(var D in y){var G=y[D],w=G.type;if(w===s.EParameterType.FLOAT_MAT2||w===s.EParameterType.FLOAT_MAT3||w===s.EParameterType.FLOAT_MAT4){if(G.semantic&&!G.source&&!G.node)v.GLTFUtils.SetMatrix(_.scene,p,G,D,A.getEffect());else if(G.semantic&&(G.source||G.node)){var W=_.scene.getNodeByName(G.source||G.node||"");if(W===null&&(W=_.scene.getNodeById(G.source||G.node||"")),W===null)continue;v.GLTFUtils.SetMatrix(_.scene,W,G,D,A.getEffect())}}else{var U=I[L.uniforms[D]];if(!U)continue;if(w===s.EParameterType.SAMPLER_2D){var H=_.textures[S.values?U:G.value].babylonTexture;if(H==null)continue;A.getEffect().setTexture(D,H)}else v.GLTFUtils.SetUniform(A.getEffect(),D,U,w)}}P(A)},ue=function(p,_,y,A,L){var S=A.values||y.parameters,P=y.uniforms,I=function(G){var w=L[G],W=w.type,U=S[P[G]];if(U===void 0&&(U=w.value),!U)return"continue";var H=function(Y){return function(X){w.value&&Y&&(_.setTexture(Y,X),delete L[Y])}};W===s.EParameterType.SAMPLER_2D?x.LoadTextureAsync(p,A.values?U:w.value,H(G),function(){return H(null)}):w.value&&v.GLTFUtils.SetUniform(_,G,A.values?U:w.value,W)&&delete L[G]};for(var D in L)I(D)},ie=function(p,_,y){return function(A,L){_.dispose(!0),y("Cannot compile program named "+p.name+". Error: "+L+". Default material will be applied")}},q=function(p,_,y,A,L,S){return function(P){ue(p,_,y,A,L),_.onBind=function(I){oe(I,p,L,_,y,A,S)}}},ee=function(p,_,y){for(var A in _.uniforms){var L=_.uniforms[A],S=_.parameters[L];if(p.currentIdentifier===A&&S.semantic&&!S.source&&!S.node){var P=n.indexOf(S.semantic);if(P!==-1)return delete y[A],t[P]}}return p.currentIdentifier},$=function(p){for(var _ in p.materials)x.LoadMaterialAsync(p,_,function(){},function(){})},O=function(){function p(){}return p.CreateRuntime=function(_,y,A){var L={extensions:{},accessors:{},buffers:{},bufferViews:{},meshes:{},lights:{},cameras:{},nodes:{},images:{},textures:{},shaders:{},programs:{},samplers:{},techniques:{},materials:{},animations:{},skins:{},extensionsUsed:[],scenes:{},buffersCount:0,shaderscount:0,scene:y,rootUrl:A,loadedBufferCount:0,loadedBufferViews:{},loadedShaderCount:0,importOnlyMeshes:!1,dummyNodes:[],assetContainer:null};return _.extensions&&c(_.extensions,"extensions",L),_.extensionsUsed&&c(_.extensionsUsed,"extensionsUsed",L),_.buffers&&a(_.buffers,L),_.bufferViews&&c(_.bufferViews,"bufferViews",L),_.accessors&&c(_.accessors,"accessors",L),_.meshes&&c(_.meshes,"meshes",L),_.lights&&c(_.lights,"lights",L),_.cameras&&c(_.cameras,"cameras",L),_.nodes&&c(_.nodes,"nodes",L),_.images&&c(_.images,"images",L),_.textures&&c(_.textures,"textures",L),_.shaders&&o(_.shaders,L),_.programs&&c(_.programs,"programs",L),_.samplers&&c(_.samplers,"samplers",L),_.techniques&&c(_.techniques,"techniques",L),_.materials&&c(_.materials,"materials",L),_.animations&&c(_.animations,"animations",L),_.skins&&c(_.skins,"skins",L),_.scenes&&(L.scenes=_.scenes),_.scene&&_.scenes&&(L.currentScene=_.scenes[_.scene]),L},p.LoadBufferAsync=function(_,y,A,L,S){var P=_.buffers[y];u.Tools.IsBase64(P.uri)?setTimeout(function(){return A(new Uint8Array(u.Tools.DecodeBase64(P.uri)))}):u.Tools.LoadFile(_.rootUrl+P.uri,function(I){return A(new Uint8Array(I))},S,void 0,!0,function(I){I&&L(I.status+" "+I.statusText)})},p.LoadTextureBufferAsync=function(_,y,A,L){var S=_.textures[y];if(!S||!S.source){L("");return}if(S.babylonTexture){A(null);return}var P=_.images[S.source];u.Tools.IsBase64(P.uri)?setTimeout(function(){return A(new Uint8Array(u.Tools.DecodeBase64(P.uri)))}):u.Tools.LoadFile(_.rootUrl+P.uri,function(I){return A(new Uint8Array(I))},void 0,void 0,!0,function(I){I&&L(I.status+" "+I.statusText)})},p.CreateTextureAsync=function(_,y,A,L){var S=_.textures[y];if(S.babylonTexture){L(S.babylonTexture);return}var P=_.samplers[S.sampler],I=P.minFilter===s.ETextureFilterType.NEAREST_MIPMAP_NEAREST||P.minFilter===s.ETextureFilterType.NEAREST_MIPMAP_LINEAR||P.minFilter===s.ETextureFilterType.LINEAR_MIPMAP_NEAREST||P.minFilter===s.ETextureFilterType.LINEAR_MIPMAP_LINEAR,D=u.Texture.BILINEAR_SAMPLINGMODE,G=A==null?new Blob:new Blob([A]),w=URL.createObjectURL(G),W=function(){return URL.revokeObjectURL(w)},U=new u.Texture(w,_.scene,!I,!0,D,W,W);P.wrapS!==void 0&&(U.wrapU=v.GLTFUtils.GetWrapMode(P.wrapS)),P.wrapT!==void 0&&(U.wrapV=v.GLTFUtils.GetWrapMode(P.wrapT)),U.name=y,S.babylonTexture=U,L(U)},p.LoadShaderStringAsync=function(_,y,A,L){var S=_.shaders[y];if(u.Tools.IsBase64(S.uri)){var P=atob(S.uri.split(",")[1]);A&&A(P)}else u.Tools.LoadFile(_.rootUrl+S.uri,A,void 0,void 0,!1,function(I){I&&L&&L(I.status+" "+I.statusText)})},p.LoadMaterialAsync=function(_,y,A,L){var S=_.materials[y];if(!S.technique){L&&L("No technique found.");return}var P=_.techniques[S.technique];if(!P){_.scene._blockEntityCollection=!!_.assetContainer;var I=new u.StandardMaterial(y,_.scene);I._parentContainer=_.assetContainer,_.scene._blockEntityCollection=!1,I.diffuseColor=new u.Color3(.5,.5,.5),I.sideOrientation=u.Material.CounterClockWiseSideOrientation,A(I);return}var D=_.programs[P.program],G=P.states,w=u.Effect.ShadersStore[D.vertexShader+"VertexShader"],W=u.Effect.ShadersStore[D.fragmentShader+"PixelShader"],U="",H="",Y=new i(w),X=new i(W),te={},ne=[],le=[],J=[];for(var re in P.uniforms){var se=P.uniforms[re],ce=P.parameters[se];if(te[re]=ce,ce.semantic&&!ce.node&&!ce.source){var Te=n.indexOf(ce.semantic);Te!==-1?(ne.push(t[Te]),delete te[re]):ne.push(re)}else ce.type===s.EParameterType.SAMPLER_2D?J.push(re):ne.push(re)}for(var fe in P.attributes){var ve=P.attributes[fe],he=P.parameters[ve];if(he.semantic){var _e=f(he);_e&&le.push(_e)}}for(;!Y.isEnd()&&Y.getNextToken();){var me=Y.currentToken;if(me!==l.IDENTIFIER){U+=Y.currentString;continue}var Oe=!1;for(var fe in P.attributes){var ve=P.attributes[fe],he=P.parameters[ve];if(Y.currentIdentifier===fe&&he.semantic){U+=f(he),Oe=!0;break}}Oe||(U+=ee(Y,P,te))}for(;!X.isEnd()&&X.getNextToken();){var me=X.currentToken;if(me!==l.IDENTIFIER){H+=X.currentString;continue}H+=ee(X,P,te)}var Ce={vertex:D.vertexShader+y,fragment:D.fragmentShader+y},Pe={attributes:le,uniforms:ne,samplers:J,needAlphaBlending:G&&G.enable&&G.enable.indexOf(3042)!==-1};u.Effect.ShadersStore[D.vertexShader+y+"VertexShader"]=U,u.Effect.ShadersStore[D.fragmentShader+y+"PixelShader"]=H;var pe=new u.ShaderMaterial(y,_.scene,Ce,Pe);if(pe.onError=ie(D,pe,L),pe.onCompiled=q(_,pe,P,S,te,A),pe.sideOrientation=u.Material.CounterClockWiseSideOrientation,G&&G.functions){var Ae=G.functions;Ae.cullFace&&Ae.cullFace[0]!==s.ECullingType.BACK&&(pe.backFaceCulling=!1);var ae=Ae.blendFuncSeparate;ae&&(ae[0]===s.EBlendingFunction.SRC_ALPHA&&ae[1]===s.EBlendingFunction.ONE_MINUS_SRC_ALPHA&&ae[2]===s.EBlendingFunction.ONE&&ae[3]===s.EBlendingFunction.ONE?pe.alphaMode=u.Constants.ALPHA_COMBINE:ae[0]===s.EBlendingFunction.ONE&&ae[1]===s.EBlendingFunction.ONE&&ae[2]===s.EBlendingFunction.ZERO&&ae[3]===s.EBlendingFunction.ONE?pe.alphaMode=u.Constants.ALPHA_ONEONE:ae[0]===s.EBlendingFunction.SRC_ALPHA&&ae[1]===s.EBlendingFunction.ONE&&ae[2]===s.EBlendingFunction.ZERO&&ae[3]===s.EBlendingFunction.ONE?pe.alphaMode=u.Constants.ALPHA_ADD:ae[0]===s.EBlendingFunction.ZERO&&ae[1]===s.EBlendingFunction.ONE_MINUS_SRC_COLOR&&ae[2]===s.EBlendingFunction.ONE&&ae[3]===s.EBlendingFunction.ONE?pe.alphaMode=u.Constants.ALPHA_SUBTRACT:ae[0]===s.EBlendingFunction.DST_COLOR&&ae[1]===s.EBlendingFunction.ZERO&&ae[2]===s.EBlendingFunction.ONE&&ae[3]===s.EBlendingFunction.ONE?pe.alphaMode=u.Constants.ALPHA_MULTIPLY:ae[0]===s.EBlendingFunction.SRC_ALPHA&&ae[1]===s.EBlendingFunction.ONE_MINUS_SRC_COLOR&&ae[2]===s.EBlendingFunction.ONE&&ae[3]===s.EBlendingFunction.ONE&&(pe.alphaMode=u.Constants.ALPHA_MAXIMIZED))}},p}(),b=function(){function p(){}return p.RegisterExtension=function(_){if(p.Extensions[_.name]){u.Tools.Error('Tool with the same name "'+_.name+'" already exists');return}p.Extensions[_.name]=_},p.prototype.dispose=function(){},p.prototype._importMeshAsync=function(_,y,A,L,S,P,I,D){var G=this;return y.useRightHandedSystem=!0,x.LoadRuntimeAsync(y,A,L,function(w){w.assetContainer=S,w.importOnlyMeshes=!0,_===""?w.importMeshesNames=[]:typeof _=="string"?w.importMeshesNames=[_]:_&&!(_ instanceof Array)?w.importMeshesNames=[_]:(w.importMeshesNames=[],u.Tools.Warn("Argument meshesNames must be of type string or string[]")),G._createNodes(w);var W=[],U=[];for(var H in w.nodes){var Y=w.nodes[H];Y.babylonNode instanceof u.AbstractMesh&&W.push(Y.babylonNode)}for(var X in w.skins){var te=w.skins[X];te.babylonSkeleton instanceof u.Skeleton&&U.push(te.babylonSkeleton)}G._loadBuffersAsync(w,function(){G._loadShadersAsync(w,function(){$(w),k(w),!m.GLTFFileLoader.IncrementalLoading&&P&&P(W,U)})}),m.GLTFFileLoader.IncrementalLoading&&P&&P(W,U)},D),!0},p.prototype.importMeshAsync=function(_,y,A,L,S,P){var I=this;return new Promise(function(D,G){I._importMeshAsync(_,y,L,S,A,function(w,W){D({meshes:w,particleSystems:[],skeletons:W,animationGroups:[],lights:[],transformNodes:[],geometries:[],spriteManagers:[]})},P,function(w){G(new Error(w))})})},p.prototype._loadAsync=function(_,y,A,L,S,P){var I=this;_.useRightHandedSystem=!0,x.LoadRuntimeAsync(_,y,A,function(D){x.LoadRuntimeExtensionsAsync(D,function(){I._createNodes(D),I._loadBuffersAsync(D,function(){I._loadShadersAsync(D,function(){$(D),k(D),m.GLTFFileLoader.IncrementalLoading||L()})}),m.GLTFFileLoader.IncrementalLoading&&L()},P)},P)},p.prototype.loadAsync=function(_,y,A,L){var S=this;return new Promise(function(P,I){S._loadAsync(_,y,A,function(){P()},L,function(D){I(new Error(D))})})},p.prototype._loadShadersAsync=function(_,y){var A=!1,L=function(I,D){x.LoadShaderStringAsync(_,I,function(G){G instanceof ArrayBuffer||(_.loadedShaderCount++,G&&(u.Effect.ShadersStore[I+(D.type===s.EShaderType.VERTEX?"VertexShader":"PixelShader")]=G),_.loadedShaderCount===_.shaderscount&&y())},function(){u.Tools.Error("Error when loading shader program named "+I+" located at "+D.uri)})};for(var S in _.shaders){A=!0;var P=_.shaders[S];P?L.bind(this,S,P)():u.Tools.Error("No shader named: "+S)}A||y()},p.prototype._loadBuffersAsync=function(_,y){var A=!1,L=function(I,D){x.LoadBufferAsync(_,I,function(G){_.loadedBufferCount++,G&&(G.byteLength!=_.buffers[I].byteLength&&u.Tools.Error("Buffer named "+I+" is length "+G.byteLength+". Expected: "+D.byteLength),_.loadedBufferViews[I]=G),_.loadedBufferCount===_.buffersCount&&y()},function(){u.Tools.Error("Error when loading buffer named "+I+" located at "+D.uri)})};for(var S in _.buffers){A=!0;var P=_.buffers[S];P?L.bind(this,S,P)():u.Tools.Error("No buffer named: "+S)}A||y()},p.prototype._createNodes=function(_){var y=_.currentScene;if(y)for(var A=0;A<y.nodes.length;A++)Q(_,y.nodes[A],null);else for(var L in _.scenes){y=_.scenes[L];for(var A=0;A<y.nodes.length;A++)Q(_,y.nodes[A],null)}},p.Extensions={},p}(),x=function(){function p(_){this._name=_}return Object.defineProperty(p.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),p.prototype.loadRuntimeAsync=function(_,y,A,L,S){return!1},p.prototype.loadRuntimeExtensionsAsync=function(_,y,A){return!1},p.prototype.loadBufferAsync=function(_,y,A,L,S){return!1},p.prototype.loadTextureBufferAsync=function(_,y,A,L){return!1},p.prototype.createTextureAsync=function(_,y,A,L,S){return!1},p.prototype.loadShaderStringAsync=function(_,y,A,L){return!1},p.prototype.loadMaterialAsync=function(_,y,A,L){return!1},p.LoadRuntimeAsync=function(_,y,A,L,S){p._ApplyExtensions(function(P){return P.loadRuntimeAsync(_,y,A,L,S)},function(){setTimeout(function(){L&&L(O.CreateRuntime(y.json,_,A))})})},p.LoadRuntimeExtensionsAsync=function(_,y,A){p._ApplyExtensions(function(L){return L.loadRuntimeExtensionsAsync(_,y,A)},function(){setTimeout(function(){y()})})},p.LoadBufferAsync=function(_,y,A,L,S){p._ApplyExtensions(function(P){return P.loadBufferAsync(_,y,A,L,S)},function(){O.LoadBufferAsync(_,y,A,L,S)})},p.LoadTextureAsync=function(_,y,A,L){p._LoadTextureBufferAsync(_,y,function(S){S&&p._CreateTextureAsync(_,y,S,A,L)},L)},p.LoadShaderStringAsync=function(_,y,A,L){p._ApplyExtensions(function(S){return S.loadShaderStringAsync(_,y,A,L)},function(){O.LoadShaderStringAsync(_,y,A,L)})},p.LoadMaterialAsync=function(_,y,A,L){p._ApplyExtensions(function(S){return S.loadMaterialAsync(_,y,A,L)},function(){O.LoadMaterialAsync(_,y,A,L)})},p._LoadTextureBufferAsync=function(_,y,A,L){p._ApplyExtensions(function(S){return S.loadTextureBufferAsync(_,y,A,L)},function(){O.LoadTextureBufferAsync(_,y,A,L)})},p._CreateTextureAsync=function(_,y,A,L,S){p._ApplyExtensions(function(P){return P.createTextureAsync(_,y,A,L,S)},function(){O.CreateTextureAsync(_,y,A,L)})},p._ApplyExtensions=function(_,y){for(var A in b.Extensions){var L=b.Extensions[A];if(_(L))return}y()},p}();m.GLTFFileLoader._CreateGLTF1Loader=function(){return new b}},"../../../dev/loaders/src/glTF/1.0/glTFLoaderInterfaces.ts":(N,E,h)=>{h.r(E),h.d(E,{EBlendingFunction:()=>t,EComponentType:()=>s,ECullingType:()=>n,EParameterType:()=>v,EShaderType:()=>u,ETextureFilterType:()=>l,ETextureFormat:()=>i,ETextureWrapMode:()=>m});var s;(function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.FLOAT=5126]="FLOAT"})(s||(s={}));var u;(function(e){e[e.FRAGMENT=35632]="FRAGMENT",e[e.VERTEX=35633]="VERTEX"})(u||(u={}));var v;(function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D"})(v||(v={}));var m;(function(e){e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.REPEAT=10497]="REPEAT"})(m||(m={}));var l;(function(e){e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9728]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"})(l||(l={}));var i;(function(e){e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA"})(i||(i={}));var n;(function(e){e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK"})(n||(n={}));var t;(function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE"})(t||(t={}))},"../../../dev/loaders/src/glTF/1.0/glTFLoaderUtils.ts":(N,E,h)=>{h.r(E),h.d(E,{GLTFUtils:()=>v});var s=h("../../../dev/loaders/src/glTF/1.0/glTFLoaderInterfaces.ts"),u=h("babylonjs/Misc/observable"),v=function(){function m(){}return m.SetMatrix=function(l,i,n,t,e){var r=null;if(n.semantic==="MODEL"?r=i.getWorldMatrix():n.semantic==="PROJECTION"?r=l.getProjectionMatrix():n.semantic==="VIEW"?r=l.getViewMatrix():n.semantic==="MODELVIEWINVERSETRANSPOSE"?r=u.Matrix.Transpose(i.getWorldMatrix().multiply(l.getViewMatrix()).invert()):n.semantic==="MODELVIEW"?r=i.getWorldMatrix().multiply(l.getViewMatrix()):n.semantic==="MODELVIEWPROJECTION"?r=i.getWorldMatrix().multiply(l.getTransformMatrix()):n.semantic==="MODELINVERSE"?r=i.getWorldMatrix().invert():n.semantic==="VIEWINVERSE"?r=l.getViewMatrix().invert():n.semantic==="PROJECTIONINVERSE"?r=l.getProjectionMatrix().invert():n.semantic==="MODELVIEWINVERSE"?r=i.getWorldMatrix().multiply(l.getViewMatrix()).invert():n.semantic==="MODELVIEWPROJECTIONINVERSE"?r=i.getWorldMatrix().multiply(l.getTransformMatrix()).invert():n.semantic==="MODELINVERSETRANSPOSE"&&(r=u.Matrix.Transpose(i.getWorldMatrix().invert())),r)switch(n.type){case s.EParameterType.FLOAT_MAT2:e.setMatrix2x2(t,u.Matrix.GetAsMatrix2x2(r));break;case s.EParameterType.FLOAT_MAT3:e.setMatrix3x3(t,u.Matrix.GetAsMatrix3x3(r));break;case s.EParameterType.FLOAT_MAT4:e.setMatrix(t,r);break}},m.SetUniform=function(l,i,n,t){switch(t){case s.EParameterType.FLOAT:return l.setFloat(i,n),!0;case s.EParameterType.FLOAT_VEC2:return l.setVector2(i,u.Vector2.FromArray(n)),!0;case s.EParameterType.FLOAT_VEC3:return l.setVector3(i,u.Vector3.FromArray(n)),!0;case s.EParameterType.FLOAT_VEC4:return l.setVector4(i,u.Vector4.FromArray(n)),!0;default:return!1}},m.GetWrapMode=function(l){switch(l){case s.ETextureWrapMode.CLAMP_TO_EDGE:return u.Texture.CLAMP_ADDRESSMODE;case s.ETextureWrapMode.MIRRORED_REPEAT:return u.Texture.MIRROR_ADDRESSMODE;case s.ETextureWrapMode.REPEAT:return u.Texture.WRAP_ADDRESSMODE;default:return u.Texture.WRAP_ADDRESSMODE}},m.GetByteStrideFromType=function(l){var i=l.type;switch(i){case"VEC2":return 2;case"VEC3":return 3;case"VEC4":return 4;case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16;default:return 1}},m.GetTextureFilterMode=function(l){switch(l){case s.ETextureFilterType.LINEAR:case s.ETextureFilterType.LINEAR_MIPMAP_NEAREST:case s.ETextureFilterType.LINEAR_MIPMAP_LINEAR:return u.Texture.TRILINEAR_SAMPLINGMODE;case s.ETextureFilterType.NEAREST:case s.ETextureFilterType.NEAREST_MIPMAP_NEAREST:return u.Texture.NEAREST_SAMPLINGMODE;default:return u.Texture.BILINEAR_SAMPLINGMODE}},m.GetBufferFromBufferView=function(l,i,n,t,e){n=i.byteOffset+n;var r=l.loadedBufferViews[i.buffer];if(n+t>r.byteLength)throw new Error("Buffer access is out of range");var a=r.buffer;switch(n+=r.byteOffset,e){case s.EComponentType.BYTE:return new Int8Array(a,n,t);case s.EComponentType.UNSIGNED_BYTE:return new Uint8Array(a,n,t);case s.EComponentType.SHORT:return new Int16Array(a,n,t);case s.EComponentType.UNSIGNED_SHORT:return new Uint16Array(a,n,t);default:return new Float32Array(a,n,t)}},m.GetBufferFromAccessor=function(l,i){var n=l.bufferViews[i.bufferView],t=i.count*m.GetByteStrideFromType(i);return m.GetBufferFromBufferView(l,n,i.byteOffset,t,i.componentType)},m.DecodeBufferToText=function(l){for(var i="",n=l.byteLength,t=0;t<n;++t)i+=String.fromCharCode(l[t]);return i},m.GetDefaultMaterial=function(l){if(!m._DefaultMaterial){u.Effect.ShadersStore.GLTFDefaultMaterialVertexShader=["precision highp float;","","uniform mat4 worldView;","uniform mat4 projection;","","attribute vec3 position;","","void main(void)","{","    gl_Position = projection * worldView * vec4(position, 1.0);","}"].join(`
`),u.Effect.ShadersStore.GLTFDefaultMaterialPixelShader=["precision highp float;","","uniform vec4 u_emission;","","void main(void)","{","    gl_FragColor = u_emission;","}"].join(`
`);var i={vertex:"GLTFDefaultMaterial",fragment:"GLTFDefaultMaterial"},n={attributes:["position"],uniforms:["worldView","projection","u_emission"],samplers:new Array,needAlphaBlending:!1};m._DefaultMaterial=new u.ShaderMaterial("GLTFDefaultMaterial",l,i,n),m._DefaultMaterial.setColor4("u_emission",new u.Color4(.5,.5,.5,1))}return m._DefaultMaterial},m._DefaultMaterial=null,m}()},"../../../dev/loaders/src/glTF/1.0/glTFMaterialsCommonExtension.ts":(N,E,h)=>{h.r(E),h.d(E,{GLTFMaterialsCommonExtension:()=>m});var s=h("../../../../node_modules/tslib/tslib.es6.mjs"),u=h("../../../dev/loaders/src/glTF/1.0/glTFLoader.ts"),v=h("babylonjs/Misc/observable"),m=function(l){(0,s.__extends)(i,l);function i(){return l.call(this,"KHR_materials_common")||this}return i.prototype.loadRuntimeExtensionsAsync=function(n){if(!n.extensions)return!1;var t=n.extensions[this.name];if(!t)return!1;var e=t.lights;if(e)for(var r in e){var a=e[r];switch(a.type){case"ambient":{var o=new v.HemisphericLight(a.name,new v.Vector3(0,1,0),n.scene),c=a.ambient;c&&(o.diffuse=v.Color3.FromArray(c.color||[1,1,1]));break}case"point":{var d=new v.PointLight(a.name,new v.Vector3(10,10,10),n.scene),f=a.point;f&&(d.diffuse=v.Color3.FromArray(f.color||[1,1,1]));break}case"directional":{var T=new v.DirectionalLight(a.name,new v.Vector3(0,-1,0),n.scene),g=a.directional;g&&(T.diffuse=v.Color3.FromArray(g.color||[1,1,1]));break}case"spot":{var F=a.spot;if(F){var M=new v.SpotLight(a.name,new v.Vector3(0,10,0),new v.Vector3(0,-1,0),F.fallOffAngle||Math.PI,F.fallOffExponent||0,n.scene);M.diffuse=v.Color3.FromArray(F.color||[1,1,1])}break}default:v.Tools.Warn('GLTF Material Common extension: light type "'+a.type+"” not supported");break}}return!1},i.prototype.loadMaterialAsync=function(n,t,e,r){var a=n.materials[t];if(!a||!a.extensions)return!1;var o=a.extensions[this.name];if(!o)return!1;var c=new v.StandardMaterial(t,n.scene);return c.sideOrientation=v.Material.CounterClockWiseSideOrientation,o.technique==="CONSTANT"&&(c.disableLighting=!0),c.backFaceCulling=o.doubleSided===void 0?!1:!o.doubleSided,c.alpha=o.values.transparency===void 0?1:o.values.transparency,c.specularPower=o.values.shininess===void 0?0:o.values.shininess,typeof o.values.ambient=="string"?this._loadTexture(n,o.values.ambient,c,"ambientTexture",r):c.ambientColor=v.Color3.FromArray(o.values.ambient||[0,0,0]),typeof o.values.diffuse=="string"?this._loadTexture(n,o.values.diffuse,c,"diffuseTexture",r):c.diffuseColor=v.Color3.FromArray(o.values.diffuse||[0,0,0]),typeof o.values.emission=="string"?this._loadTexture(n,o.values.emission,c,"emissiveTexture",r):c.emissiveColor=v.Color3.FromArray(o.values.emission||[0,0,0]),typeof o.values.specular=="string"?this._loadTexture(n,o.values.specular,c,"specularTexture",r):c.specularColor=v.Color3.FromArray(o.values.specular||[0,0,0]),!0},i.prototype._loadTexture=function(n,t,e,r,a){u.GLTFLoaderBase.LoadTextureBufferAsync(n,t,function(o){u.GLTFLoaderBase.CreateTextureAsync(n,t,o,function(c){return e[r]=c})},a)},i}(u.GLTFLoaderExtension);u.GLTFLoader.RegisterExtension(new m)},"../../../dev/loaders/src/glTF/1.0/index.ts":(N,E,h)=>{h.r(E),h.d(E,{EBlendingFunction:()=>v.EBlendingFunction,EComponentType:()=>v.EComponentType,ECullingType:()=>v.ECullingType,EParameterType:()=>v.EParameterType,EShaderType:()=>v.EShaderType,ETextureFilterType:()=>v.ETextureFilterType,ETextureFormat:()=>v.ETextureFormat,ETextureWrapMode:()=>v.ETextureWrapMode,GLTFBinaryExtension:()=>s.GLTFBinaryExtension,GLTFLoader:()=>u.GLTFLoader,GLTFLoaderBase:()=>u.GLTFLoaderBase,GLTFLoaderExtension:()=>u.GLTFLoaderExtension,GLTFMaterialsCommonExtension:()=>l.GLTFMaterialsCommonExtension,GLTFUtils:()=>m.GLTFUtils});var s=h("../../../dev/loaders/src/glTF/1.0/glTFBinaryExtension.ts"),u=h("../../../dev/loaders/src/glTF/1.0/glTFLoader.ts"),v=h("../../../dev/loaders/src/glTF/1.0/glTFLoaderInterfaces.ts"),m=h("../../../dev/loaders/src/glTF/1.0/glTFLoaderUtils.ts"),l=h("../../../dev/loaders/src/glTF/1.0/glTFMaterialsCommonExtension.ts")},"../../../dev/loaders/src/glTF/2.0/Extensions/EXT_lights_image_based.ts":(N,E,h)=>{h.r(E),h.d(E,{EXT_lights_image_based:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="EXT_lights_image_based",m=function(){function l(i){this.name=v,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null,delete this._lights},l.prototype.onLoading=function(){var i=this._loader.gltf.extensions;if(i&&i[this.name]){var n=i[this.name];this._lights=n.lights}},l.prototype.loadSceneAsync=function(i,n){var t=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(e,r){t._loader._allMaterialsDirtyRequired=!0;var a=new Array;a.push(t._loader.loadSceneAsync(i,n)),t._loader.logOpen("".concat(e));var o=u.ArrayItem.Get("".concat(e,"/light"),t._lights,r.light);return a.push(t._loadLightAsync("/extensions/".concat(t.name,"/lights/").concat(r.light),o).then(function(c){t._loader.babylonScene.environmentTexture=c})),t._loader.logClose(),Promise.all(a).then(function(){})})},l.prototype._loadLightAsync=function(i,n){var t=this;if(!n._loaded){var e=new Array;this._loader.logOpen("".concat(i));for(var r=new Array(n.specularImages.length),a=function(d){var f=n.specularImages[d];r[d]=new Array(f.length);for(var T=function(F){var M="".concat(i,"/specularImages/").concat(d,"/").concat(F);o._loader.logOpen("".concat(M));var C=f[F],R=u.ArrayItem.Get(M,o._loader.gltf.images,C);e.push(o._loader.loadImageAsync("/images/".concat(C),R).then(function(B){r[d][F]=B})),o._loader.logClose()},g=0;g<f.length;g++)T(g)},o=this,c=0;c<n.specularImages.length;c++)a(c);this._loader.logClose(),n._loaded=Promise.all(e).then(function(){var d=new s.RawCubeTexture(t._loader.babylonScene,null,n.specularImageSize);if(d.name=n.name||"environment",n._babylonTexture=d,n.intensity!=null&&(d.level=n.intensity),n.rotation){var f=s.Quaternion.FromArray(n.rotation);t._loader.babylonScene.useRightHandedSystem||(f=s.Quaternion.Inverse(f)),s.Matrix.FromQuaternionToRef(f,d.getReflectionTextureMatrix())}if(!n.irradianceCoefficients)throw new Error("".concat(i,": Irradiance coefficients are missing"));var T=s.SphericalHarmonics.FromArray(n.irradianceCoefficients);T.scaleInPlace(n.intensity),T.convertIrradianceToLambertianRadiance();var g=s.SphericalPolynomial.FromHarmonics(T),F=(r.length-1)/s.Scalar.Log2(n.specularImageSize);return d.updateRGBDAsync(r,g,F)})}return n._loaded.then(function(){return n._babylonTexture})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/EXT_mesh_gpu_instancing.ts":(N,E,h)=>{h.r(E),h.d(E,{EXT_mesh_gpu_instancing:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="EXT_mesh_gpu_instancing",m=function(){function l(i){this.name=v,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadNodeAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){e._loader._disableInstancedMesh++;var o=e._loader.loadNodeAsync("/nodes/".concat(n.index),n,t);if(e._loader._disableInstancedMesh--,!n._primitiveBabylonMeshes)return o;var c=new Array,d=0,f=function(T){if(a.attributes[T]==null){c.push(Promise.resolve(null));return}var g=u.ArrayItem.Get("".concat(r,"/attributes/").concat(T),e._loader.gltf.accessors,a.attributes[T]);if(c.push(e._loader._loadFloatAccessorAsync("/accessors/".concat(g.bufferView),g)),d===0)d=g.count;else if(d!==g.count)throw new Error("".concat(r,"/attributes: Instance buffer accessors do not have the same count."))};return f("TRANSLATION"),f("ROTATION"),f("SCALE"),o.then(function(T){return Promise.all(c).then(function(g){var F=g[0],M=g[1],C=g[2],R=new Float32Array(d*16);s.TmpVectors.Vector3[0].copyFromFloats(0,0,0),s.TmpVectors.Quaternion[0].copyFromFloats(0,0,0,1),s.TmpVectors.Vector3[1].copyFromFloats(1,1,1);for(var B=0;B<d;++B)F&&s.Vector3.FromArrayToRef(F,B*3,s.TmpVectors.Vector3[0]),M&&s.Quaternion.FromArrayToRef(M,B*4,s.TmpVectors.Quaternion[0]),C&&s.Vector3.FromArrayToRef(C,B*3,s.TmpVectors.Vector3[1]),s.Matrix.ComposeToRef(s.TmpVectors.Vector3[1],s.TmpVectors.Quaternion[0],s.TmpVectors.Vector3[0],s.TmpVectors.Matrix[0]),s.TmpVectors.Matrix[0].copyToArray(R,B*16);for(var K=0,V=n._primitiveBabylonMeshes;K<V.length;K++){var j=V[K];j.thinInstanceSetBuffer("matrix",R,16,!0)}return T})})})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/EXT_meshopt_compression.ts":(N,E,h)=>{h.r(E),h.d(E,{EXT_meshopt_compression:()=>m});var s=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),u=h("babylonjs/Misc/observable"),v="EXT_meshopt_compression",m=function(){function l(i){this.name=v,this.enabled=i.isExtensionUsed(v),this._loader=i}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadBufferViewAsync=function(i,n){var t=this;return s.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(e,r){var a=n;if(a._meshOptData)return a._meshOptData;var o=s.ArrayItem.Get("".concat(i,"/buffer"),t._loader.gltf.buffers,r.buffer);return a._meshOptData=t._loader.loadBufferAsync("/buffers/".concat(o.index),o,r.byteOffset||0,r.byteLength).then(function(c){return u.MeshoptCompression.Default.decodeGltfBufferAsync(c,r.count,r.byteStride,r.mode,r.filter)}),a._meshOptData})},l}();s.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/EXT_texture_avif.ts":(N,E,h)=>{h.r(E),h.d(E,{EXT_texture_avif:()=>v});var s=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),u="EXT_texture_avif",v=function(){function m(l){this.name=u,this._loader=l,this.enabled=l.isExtensionUsed(u)}return m.prototype.dispose=function(){this._loader=null},m.prototype._loadTextureAsync=function(l,i,n){var t=this;return s.GLTFLoader.LoadExtensionAsync(l,i,this.name,function(e,r){var a=i.sampler==null?s.GLTFLoader.DefaultSampler:s.ArrayItem.Get("".concat(l,"/sampler"),t._loader.gltf.samplers,i.sampler),o=s.ArrayItem.Get("".concat(e,"/source"),t._loader.gltf.images,r.source);return t._loader._createTextureAsync(l,a,o,function(c){n(c)},void 0,!i._textureInfo.nonColorData)})},m}();s.GLTFLoader.RegisterExtension(u,function(m){return new v(m)})},"../../../dev/loaders/src/glTF/2.0/Extensions/EXT_texture_webp.ts":(N,E,h)=>{h.r(E),h.d(E,{EXT_texture_webp:()=>v});var s=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),u="EXT_texture_webp",v=function(){function m(l){this.name=u,this._loader=l,this.enabled=l.isExtensionUsed(u)}return m.prototype.dispose=function(){this._loader=null},m.prototype._loadTextureAsync=function(l,i,n){var t=this;return s.GLTFLoader.LoadExtensionAsync(l,i,this.name,function(e,r){var a=i.sampler==null?s.GLTFLoader.DefaultSampler:s.ArrayItem.Get("".concat(l,"/sampler"),t._loader.gltf.samplers,i.sampler),o=s.ArrayItem.Get("".concat(e,"/source"),t._loader.gltf.images,r.source);return t._loader._createTextureAsync(l,a,o,function(c){n(c)},void 0,!i._textureInfo.nonColorData)})},m}();s.GLTFLoader.RegisterExtension(u,function(m){return new v(m)})},"../../../dev/loaders/src/glTF/2.0/Extensions/ExtrasAsMetadata.ts":(N,E,h)=>{h.r(E),h.d(E,{ExtrasAsMetadata:()=>v});var s=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),u="ExtrasAsMetadata",v=function(){function m(l){this.name=u,this.enabled=!0,this._loader=l}return m.prototype._assignExtras=function(l,i){if(i.extras&&Object.keys(i.extras).length>0){var n=l.metadata=l.metadata||{},t=n.gltf=n.gltf||{};t.extras=i.extras}},m.prototype.dispose=function(){this._loader=null},m.prototype.loadNodeAsync=function(l,i,n){var t=this;return this._loader.loadNodeAsync(l,i,function(e){t._assignExtras(e,i),n(e)})},m.prototype.loadCameraAsync=function(l,i,n){var t=this;return this._loader.loadCameraAsync(l,i,function(e){t._assignExtras(e,i),n(e)})},m.prototype.createMaterial=function(l,i,n){var t=this._loader.createMaterial(l,i,n);return this._assignExtras(t,i),t},m}();s.GLTFLoader.RegisterExtension(u,function(m){return new v(m)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_animation_pointer.data.ts":(N,E,h)=>{h.r(E),h.d(E,{animationPointerTree:()=>F});var s=h("../../../../node_modules/tslib/tslib.es6.mjs"),u=h("babylonjs/Misc/observable"),v=h("../../../dev/loaders/src/glTF/2.0/glTFLoaderAnimation.ts");function m(M,C,R,B){return u.Color3.FromArray(C,R).scale(B)}function l(M,C,R,B){return C[R+3]*B}function i(M,C,R,B){return C[R]*B}function n(M,C,R,B){return-C[R]*B}function t(M,C,R,B){return C[R+1]*B}function e(M,C,R,B){return C[R]*B*2}function r(M){return{scale:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"".concat(M,".uScale"),i,function(){return 2}),new o(u.Animation.ANIMATIONTYPE_FLOAT,"".concat(M,".vScale"),t,function(){return 2})],offset:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"".concat(M,".uOffset"),i,function(){return 2}),new o(u.Animation.ANIMATIONTYPE_FLOAT,"".concat(M,".vOffset"),t,function(){return 2})],rotation:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"".concat(M,".wAng"),n,function(){return 1})]}}var a=function(M){(0,s.__extends)(C,M);function C(){return M!==null&&M.apply(this,arguments)||this}return C.prototype.buildAnimations=function(R,B,K,V,j){j(R._babylonCamera,this._buildAnimation(B,K,V))},C}(v.AnimationPropertyInfo),o=function(M){(0,s.__extends)(C,M);function C(){return M!==null&&M.apply(this,arguments)||this}return C.prototype.buildAnimations=function(R,B,K,V,j){for(var z in R._data)j(R._data[z].babylonMaterial,this._buildAnimation(B,K,V))},C}(v.AnimationPropertyInfo),c=function(M){(0,s.__extends)(C,M);function C(){return M!==null&&M.apply(this,arguments)||this}return C.prototype.buildAnimations=function(R,B,K,V,j){j(R._babylonLight,this._buildAnimation(B,K,V))},C}(v.AnimationPropertyInfo),d={__array__:(0,s.__assign)({__target__:!0},v.nodeAnimationData)},f={__array__:{__target__:!0,orthographic:{xmag:[new a(u.Animation.ANIMATIONTYPE_FLOAT,"orthoLeft",n,function(){return 1}),new a(u.Animation.ANIMATIONTYPE_FLOAT,"orthoRight",t,function(){return 1})],ymag:[new a(u.Animation.ANIMATIONTYPE_FLOAT,"orthoBottom",n,function(){return 1}),new a(u.Animation.ANIMATIONTYPE_FLOAT,"orthoTop",t,function(){return 1})],zfar:[new a(u.Animation.ANIMATIONTYPE_FLOAT,"maxZ",i,function(){return 1})],znear:[new a(u.Animation.ANIMATIONTYPE_FLOAT,"minZ",i,function(){return 1})]},perspective:{yfov:[new a(u.Animation.ANIMATIONTYPE_FLOAT,"fov",i,function(){return 1})],zfar:[new a(u.Animation.ANIMATIONTYPE_FLOAT,"maxZ",i,function(){return 1})],znear:[new a(u.Animation.ANIMATIONTYPE_FLOAT,"minZ",i,function(){return 1})]}}},T={__array__:{__target__:!0,pbrMetallicRoughness:{baseColorFactor:[new o(u.Animation.ANIMATIONTYPE_COLOR3,"albedoColor",m,function(){return 4}),new o(u.Animation.ANIMATIONTYPE_FLOAT,"alpha",l,function(){return 4})],metallicFactor:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"metallic",i,function(){return 1})],roughnessFactor:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"roughness",i,function(){return 1})],baseColorTexture:{extensions:{KHR_texture_transform:r("albedoTexture")}},metallicRoughnessTexture:{extensions:{KHR_texture_transform:r("metallicTexture")}}},emissiveFactor:[new o(u.Animation.ANIMATIONTYPE_COLOR3,"emissiveColor",m,function(){return 3})],normalTexture:{scale:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"bumpTexture.level",i,function(){return 1})],extensions:{KHR_texture_transform:r("bumpTexture")}},occlusionTexture:{strength:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"ambientTextureStrength",i,function(){return 1})],extensions:{KHR_texture_transform:r("ambientTexture")}},emissiveTexture:{extensions:{KHR_texture_transform:r("emissiveTexture")}},extensions:{KHR_materials_anisotropy:{anisotropyStrength:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"anisotropy.intensity",i,function(){return 1})],anisotropyRotation:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"anisotropy.angle",i,function(){return 1})],anisotropyTexture:{extensions:{KHR_texture_transform:r("anisotropy.texture")}}},KHR_materials_clearcoat:{clearcoatFactor:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"clearCoat.intensity",i,function(){return 1})],clearcoatRoughnessFactor:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"clearCoat.roughness",i,function(){return 1})],clearcoatTexture:{extensions:{KHR_texture_transform:r("clearCoat.texture")}},clearcoatNormalTexture:{scale:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"clearCoat.bumpTexture.level",i,function(){return 1})],extensions:{KHR_texture_transform:r("clearCoat.bumpTexture")}},clearcoatRoughnessTexture:{extensions:{KHR_texture_transform:r("clearCoat.textureRoughness")}}},KHR_materials_dispersion:{dispersion:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"subSurface.dispersion",i,function(){return 1})]},KHR_materials_emissive_strength:{emissiveStrength:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"emissiveIntensity",i,function(){return 1})]},KHR_materials_ior:{ior:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"indexOfRefraction",i,function(){return 1})]},KHR_materials_iridescence:{iridescenceFactor:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"iridescence.intensity",i,function(){return 1})],iridescenceIor:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"iridescence.indexOfRefraction",i,function(){return 1})],iridescenceThicknessMinimum:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"iridescence.minimumThickness",i,function(){return 1})],iridescenceThicknessMaximum:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"iridescence.maximumThickness",i,function(){return 1})],iridescenceTexture:{extensions:{KHR_texture_transform:r("iridescence.texture")}},iridescenceThicknessTexture:{extensions:{KHR_texture_transform:r("iridescence.thicknessTexture")}}},KHR_materials_sheen:{sheenColorFactor:[new o(u.Animation.ANIMATIONTYPE_COLOR3,"sheen.color",m,function(){return 3})],sheenRoughnessFactor:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"sheen.roughness",i,function(){return 1})],sheenColorTexture:{extensions:{KHR_texture_transform:r("sheen.texture")}},sheenRoughnessTexture:{extensions:{KHR_texture_transform:r("sheen.textureRoughness")}}},KHR_materials_specular:{specularFactor:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"metallicF0Factor",i,function(){return 1})],specularColorFactor:[new o(u.Animation.ANIMATIONTYPE_COLOR3,"metallicReflectanceColor",m,function(){return 3})],specularTexture:{extensions:{KHR_texture_transform:r("metallicReflectanceTexture")}},specularColorTexture:{extensions:{KHR_texture_transform:r("reflectanceTexture")}}},KHR_materials_transmission:{transmissionFactor:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"subSurface.refractionIntensity",i,function(){return 1})],transmissionTexture:{extensions:{KHR_texture_transform:r("subSurface.refractionIntensityTexture")}}},KHR_materials_volume:{attenuationColor:[new o(u.Animation.ANIMATIONTYPE_COLOR3,"subSurface.tintColor",m,function(){return 3})],attenuationDistance:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"subSurface.tintColorAtDistance",i,function(){return 1})],thicknessFactor:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"subSurface.maximumThickness",i,function(){return 1})],thicknessTexture:{extensions:{KHR_texture_transform:r("subSurface.thicknessTexture")}}},KHR_materials_diffuse_transmission:{diffuseTransmissionFactor:[new o(u.Animation.ANIMATIONTYPE_FLOAT,"subSurface.translucencyIntensity",i,function(){return 1})],diffuseTransmissionTexture:{extensions:{KHR_texture_transform:r("subSurface.translucencyIntensityTexture")}},diffuseTransmissionColorFactor:[new o(u.Animation.ANIMATIONTYPE_COLOR3,"subSurface.translucencyColor",m,function(){return 3})],diffuseTransmissionColorTexture:{extensions:{KHR_texture_transform:r("subSurface.translucencyColorTexture")}}}}}},g={KHR_lights_punctual:{lights:{__array__:{__target__:!0,color:[new c(u.Animation.ANIMATIONTYPE_COLOR3,"diffuse",m,function(){return 3})],intensity:[new c(u.Animation.ANIMATIONTYPE_FLOAT,"intensity",i,function(){return 1})],range:[new c(u.Animation.ANIMATIONTYPE_FLOAT,"range",i,function(){return 1})],spot:{innerConeAngle:[new c(u.Animation.ANIMATIONTYPE_FLOAT,"innerAngle",e,function(){return 1})],outerConeAngle:[new c(u.Animation.ANIMATIONTYPE_FLOAT,"angle",e,function(){return 1})]}}}}},F={nodes:d,materials:T,cameras:f,extensions:g}},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_animation_pointer.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_animation_pointer:()=>t});var s=h("../../../../node_modules/tslib/tslib.es6.mjs"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v=h("babylonjs/Misc/observable"),m=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_animation_pointer.data.ts"),l=h("../../../dev/loaders/src/glTF/2.0/Extensions/gltfPathToObjectConverter.ts"),i="KHR_animation_pointer",n=function(e){(0,s.__extends)(r,e);function r(a){return e.call(this,a,m.animationPointerTree)||this}return r}(l.GLTFPathToObjectConverter),t=function(){function e(r){this.name=i,this._loader=r,this._pathToObjectConverter=new n(this._loader.gltf)}return Object.defineProperty(e.prototype,"enabled",{get:function(){return this._loader.isExtensionUsed(i)},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._loader=null,delete this._pathToObjectConverter},e.prototype._loadAnimationChannelAsync=function(r,a,o,c,d){var f,T=(f=c.target.extensions)===null||f===void 0?void 0:f.KHR_animation_pointer;if(!T||!this._pathToObjectConverter)return null;c.target.path!=="pointer"&&v.Logger.Warn("".concat(r,"/target/path: Value (").concat(c.target.path,") must be (").concat("pointer",") when using the ").concat(this.name," extension")),c.target.node!=null&&v.Logger.Warn("".concat(r,"/target/node: Value (").concat(c.target.node,") must not be present when using the ").concat(this.name," extension"));var g="".concat(r,"/extensions/").concat(this.name),F=T.pointer;if(!F)throw new Error("".concat(g,": Pointer is missing"));try{var M=this._pathToObjectConverter.convert(F);return this._loader._loadAnimationChannelFromTargetInfoAsync(r,a,o,c,M,d)}catch{return v.Logger.Warn("".concat(g,"/pointer: Invalid pointer (").concat(F,") skipped")),null}},e}();u.GLTFLoader.RegisterExtension(i,function(e){return new t(e)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_draco_mesh_compression.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_draco_mesh_compression:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_draco_mesh_compression",m=function(){function l(i){this.name=v,this.useNormalizedFlagFromAccessor=!0,this._loader=i,this.enabled=s.DracoCompression.DecoderAvailable&&this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){delete this.dracoCompression,this._loader=null},l.prototype._loadVertexDataAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){if(n.mode!=null&&n.mode!==4&&n.mode!==5)throw new Error("".concat(i,": Unsupported mode ").concat(n.mode));var o={},c={},d=function(T,g){var F=a.attributes[T];if(F!=null&&(t._delayInfo=t._delayInfo||[],t._delayInfo.indexOf(g)===-1&&t._delayInfo.push(g),o[g]=F,e.useNormalizedFlagFromAccessor)){var M=u.ArrayItem.TryGet(e._loader.gltf.accessors,n.attributes[T]);M&&(c[g]=M.normalized||!1)}};d("POSITION",s.VertexBuffer.PositionKind),d("NORMAL",s.VertexBuffer.NormalKind),d("TANGENT",s.VertexBuffer.TangentKind),d("TEXCOORD_0",s.VertexBuffer.UVKind),d("TEXCOORD_1",s.VertexBuffer.UV2Kind),d("TEXCOORD_2",s.VertexBuffer.UV3Kind),d("TEXCOORD_3",s.VertexBuffer.UV4Kind),d("TEXCOORD_4",s.VertexBuffer.UV5Kind),d("TEXCOORD_5",s.VertexBuffer.UV6Kind),d("JOINTS_0",s.VertexBuffer.MatricesIndicesKind),d("WEIGHTS_0",s.VertexBuffer.MatricesWeightsKind),d("COLOR_0",s.VertexBuffer.ColorKind);var f=u.ArrayItem.Get(r,e._loader.gltf.bufferViews,a.bufferView);return f._dracoBabylonGeometry||(f._dracoBabylonGeometry=e._loader.loadBufferViewAsync("/bufferViews/".concat(f.index),f).then(function(T){var g=e.dracoCompression||s.DracoCompression.Default;return g._decodeMeshToGeometryForGltfAsync(t.name,e._loader.babylonScene,T,o,c).catch(function(F){throw new Error("".concat(i,": ").concat(F.message))})})),f._dracoBabylonGeometry})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_interactivity.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_interactivity:()=>i});var s=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),u=h("babylonjs/Misc/observable"),v=h("../../../dev/loaders/src/glTF/2.0/Extensions/interactivityFunctions.ts"),m=h("../../../dev/loaders/src/glTF/2.0/Extensions/interactivityPathToObjectConverter.ts"),l="KHR_interactivity",i=function(){function n(t){this._loader=t,this.name=l,this.enabled=this._loader.isExtensionUsed(l),this._pathConverter=new m.InteractivityPathToObjectConverter(this._loader.gltf)}return n.prototype.dispose=function(){this._loader=null,delete this._pathConverter},n.prototype.onReady=function(){var t;if(!(!this._loader.babylonScene||!this._pathConverter)){var e=this._loader.babylonScene,r=(t=this._loader.gltf.extensions)===null||t===void 0?void 0:t.KHR_interactivity,a=(0,v.convertGLTFToSerializedFlowGraph)(r),o=new u.FlowGraphCoordinator({scene:e});u.FlowGraph.Parse(a,{coordinator:o,pathConverter:this._pathConverter}),o.start()}},n}();s.GLTFLoader.RegisterExtension(l,function(n){return new i(n)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_lights_punctual.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_lights:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_lights_punctual",m=function(){function l(i){this.name=v,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null,delete this._lights},l.prototype.onLoading=function(){var i=this._loader.gltf.extensions;if(i&&i[this.name]){var n=i[this.name];this._lights=n.lights,u.ArrayItem.Assign(this._lights)}},l.prototype.loadNodeAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){return e._loader._allMaterialsDirtyRequired=!0,e._loader.loadNodeAsync(i,n,function(o){var c,d=u.ArrayItem.Get(r,e._lights,a.light),f=d.name||o.name;switch(e._loader.babylonScene._blockEntityCollection=!!e._loader._assetContainer,d.type){case"directional":{var T=new s.DirectionalLight(f,s.Vector3.Backward(),e._loader.babylonScene);T.position.setAll(0),c=T;break}case"point":{c=new s.PointLight(f,s.Vector3.Zero(),e._loader.babylonScene);break}case"spot":{var g=new s.SpotLight(f,s.Vector3.Zero(),s.Vector3.Backward(),0,1,e._loader.babylonScene);g.angle=(d.spot&&d.spot.outerConeAngle||Math.PI/4)*2,g.innerAngle=(d.spot&&d.spot.innerConeAngle||0)*2,c=g;break}default:throw e._loader.babylonScene._blockEntityCollection=!1,new Error("".concat(r,": Invalid light type (").concat(d.type,")"))}c._parentContainer=e._loader._assetContainer,e._loader.babylonScene._blockEntityCollection=!1,d._babylonLight=c,c.falloffType=s.Light.FALLOFF_GLTF,c.diffuse=d.color?s.Color3.FromArray(d.color):s.Color3.White(),c.intensity=d.intensity==null?1:d.intensity,c.range=d.range==null?Number.MAX_VALUE:d.range,c.parent=o,e._loader._babylonLights.push(c),u.GLTFLoader.AddPointerMetadata(c,r),t(o)})})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_anisotropy.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_materials_anisotropy:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_materials_anisotropy",m=function(){function l(i){this.name=v,this.order=195,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadMaterialPropertiesAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){var o=new Array;return o.push(e._loader.loadMaterialPropertiesAsync(i,n,t)),o.push(e._loadIridescencePropertiesAsync(r,a,t)),Promise.all(o).then(function(){})})},l.prototype._loadIridescencePropertiesAsync=function(i,n,t){var e,r;if(!(t instanceof s.PBRMaterial))throw new Error("".concat(i,": Material type not supported"));var a=new Array;return t.anisotropy.isEnabled=!0,t.anisotropy.intensity=(e=n.anisotropyStrength)!==null&&e!==void 0?e:0,t.anisotropy.angle=(r=n.anisotropyRotation)!==null&&r!==void 0?r:0,n.anisotropyTexture&&a.push(this._loader.loadTextureInfoAsync("".concat(i,"/anisotropyTexture"),n.anisotropyTexture,function(o){o.name="".concat(t.name," (Anisotropy Intensity)"),t.anisotropy.texture=o})),Promise.all(a).then(function(){})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_clearcoat.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_materials_clearcoat:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_materials_clearcoat",m=function(){function l(i){this.name=v,this.order=190,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadMaterialPropertiesAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){var o=new Array;return o.push(e._loader.loadMaterialPropertiesAsync(i,n,t)),o.push(e._loadClearCoatPropertiesAsync(r,a,t)),Promise.all(o).then(function(){})})},l.prototype._loadClearCoatPropertiesAsync=function(i,n,t){if(!(t instanceof s.PBRMaterial))throw new Error("".concat(i,": Material type not supported"));var e=new Array;return t.clearCoat.isEnabled=!0,t.clearCoat.useRoughnessFromMainTexture=!1,t.clearCoat.remapF0OnInterfaceChange=!1,n.clearcoatFactor!=null?t.clearCoat.intensity=n.clearcoatFactor:t.clearCoat.intensity=0,n.clearcoatTexture&&e.push(this._loader.loadTextureInfoAsync("".concat(i,"/clearcoatTexture"),n.clearcoatTexture,function(r){r.name="".concat(t.name," (ClearCoat Intensity)"),t.clearCoat.texture=r})),n.clearcoatRoughnessFactor!=null?t.clearCoat.roughness=n.clearcoatRoughnessFactor:t.clearCoat.roughness=0,n.clearcoatRoughnessTexture&&(n.clearcoatRoughnessTexture.nonColorData=!0,e.push(this._loader.loadTextureInfoAsync("".concat(i,"/clearcoatRoughnessTexture"),n.clearcoatRoughnessTexture,function(r){r.name="".concat(t.name," (ClearCoat Roughness)"),t.clearCoat.textureRoughness=r}))),n.clearcoatNormalTexture&&(n.clearcoatNormalTexture.nonColorData=!0,e.push(this._loader.loadTextureInfoAsync("".concat(i,"/clearcoatNormalTexture"),n.clearcoatNormalTexture,function(r){r.name="".concat(t.name," (ClearCoat Normal)"),t.clearCoat.bumpTexture=r})),t.invertNormalMapX=!t.getScene().useRightHandedSystem,t.invertNormalMapY=t.getScene().useRightHandedSystem,n.clearcoatNormalTexture.scale!=null&&(t.clearCoat.bumpTexture.level=n.clearcoatNormalTexture.scale)),Promise.all(e).then(function(){})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_diffuse_transmission.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_materials_diffuse_transmission:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_materials_diffuse_transmission",m=function(){function l(i){this.name=v,this.order=174,this._loader=i,this.enabled=this._loader.isExtensionUsed(v),this.enabled&&(i.parent.transparencyAsCoverage=!0)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadMaterialPropertiesAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){var o=new Array;return o.push(e._loader.loadMaterialBasePropertiesAsync(i,n,t)),o.push(e._loader.loadMaterialPropertiesAsync(i,n,t)),o.push(e._loadTranslucentPropertiesAsync(r,n,t,a)),Promise.all(o).then(function(){})})},l.prototype._loadTranslucentPropertiesAsync=function(i,n,t,e){if(!(t instanceof s.PBRMaterial))throw new Error("".concat(i,": Material type not supported"));var r=t;if(r.subSurface.isTranslucencyEnabled=!0,r.subSurface.volumeIndexOfRefraction=1,r.subSurface.minimumThickness=0,r.subSurface.maximumThickness=0,r.subSurface.useAlbedoToTintTranslucency=!1,e.diffuseTransmissionFactor!==void 0)r.subSurface.translucencyIntensity=e.diffuseTransmissionFactor;else return r.subSurface.translucencyIntensity=0,r.subSurface.isTranslucencyEnabled=!1,Promise.resolve();var a=new Array;return r.subSurface.useGltfStyleTextures=!0,e.diffuseTransmissionTexture&&(e.diffuseTransmissionTexture.nonColorData=!0,a.push(this._loader.loadTextureInfoAsync("".concat(i,"/diffuseTransmissionTexture"),e.diffuseTransmissionTexture).then(function(o){r.subSurface.translucencyIntensityTexture=o}))),e.diffuseTransmissionColorFactor!==void 0?r.subSurface.translucencyColor=s.Color3.FromArray(e.diffuseTransmissionColorFactor):r.subSurface.translucencyColor=s.Color3.White(),e.diffuseTransmissionColorTexture&&a.push(this._loader.loadTextureInfoAsync("".concat(i,"/diffuseTransmissionColorTexture"),e.diffuseTransmissionColorTexture).then(function(o){r.subSurface.translucencyColorTexture=o})),Promise.all(a).then(function(){})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_dispersion.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_materials_dispersion:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_materials_dispersion",m=function(){function l(i){this.name=v,this.order=174,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadMaterialPropertiesAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){var o=new Array;return o.push(e._loader.loadMaterialBasePropertiesAsync(i,n,t)),o.push(e._loader.loadMaterialPropertiesAsync(i,n,t)),o.push(e._loadDispersionPropertiesAsync(r,n,t,a)),Promise.all(o).then(function(){})})},l.prototype._loadDispersionPropertiesAsync=function(i,n,t,e){if(!(t instanceof s.PBRMaterial))throw new Error("".concat(i,": Material type not supported"));return!t.subSurface.isRefractionEnabled||!e.dispersion||(t.subSurface.isDispersionEnabled=!0,t.subSurface.dispersion=e.dispersion),Promise.resolve()},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_emissive_strength.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_materials_emissive_strength:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_materials_emissive_strength",m=function(){function l(i){this.name=v,this.order=170,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadMaterialPropertiesAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){return e._loader.loadMaterialPropertiesAsync(i,n,t).then(function(){e._loadEmissiveProperties(r,a,t)})})},l.prototype._loadEmissiveProperties=function(i,n,t){if(!(t instanceof s.PBRMaterial))throw new Error("".concat(i,": Material type not supported"));n.emissiveStrength!==void 0&&(t.emissiveIntensity=n.emissiveStrength)},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_ior.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_materials_ior:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_materials_ior",m=function(){function l(i){this.name=v,this.order=180,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadMaterialPropertiesAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){var o=new Array;return o.push(e._loader.loadMaterialPropertiesAsync(i,n,t)),o.push(e._loadIorPropertiesAsync(r,a,t)),Promise.all(o).then(function(){})})},l.prototype._loadIorPropertiesAsync=function(i,n,t){if(!(t instanceof s.PBRMaterial))throw new Error("".concat(i,": Material type not supported"));return n.ior!==void 0?t.indexOfRefraction=n.ior:t.indexOfRefraction=l._DEFAULT_IOR,Promise.resolve()},l._DEFAULT_IOR=1.5,l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_iridescence.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_materials_iridescence:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_materials_iridescence",m=function(){function l(i){this.name=v,this.order=195,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadMaterialPropertiesAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){var o=new Array;return o.push(e._loader.loadMaterialPropertiesAsync(i,n,t)),o.push(e._loadIridescencePropertiesAsync(r,a,t)),Promise.all(o).then(function(){})})},l.prototype._loadIridescencePropertiesAsync=function(i,n,t){var e,r,a,o,c;if(!(t instanceof s.PBRMaterial))throw new Error("".concat(i,": Material type not supported"));var d=new Array;return t.iridescence.isEnabled=!0,t.iridescence.intensity=(e=n.iridescenceFactor)!==null&&e!==void 0?e:0,t.iridescence.indexOfRefraction=(a=(r=n.iridescenceIor)!==null&&r!==void 0?r:n.iridescenceIOR)!==null&&a!==void 0?a:1.3,t.iridescence.minimumThickness=(o=n.iridescenceThicknessMinimum)!==null&&o!==void 0?o:100,t.iridescence.maximumThickness=(c=n.iridescenceThicknessMaximum)!==null&&c!==void 0?c:400,n.iridescenceTexture&&d.push(this._loader.loadTextureInfoAsync("".concat(i,"/iridescenceTexture"),n.iridescenceTexture,function(f){f.name="".concat(t.name," (Iridescence Intensity)"),t.iridescence.texture=f})),n.iridescenceThicknessTexture&&d.push(this._loader.loadTextureInfoAsync("".concat(i,"/iridescenceThicknessTexture"),n.iridescenceThicknessTexture,function(f){f.name="".concat(t.name," (Iridescence Thickness)"),t.iridescence.thicknessTexture=f})),Promise.all(d).then(function(){})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_pbrSpecularGlossiness.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_materials_pbrSpecularGlossiness:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_materials_pbrSpecularGlossiness",m=function(){function l(i){this.name=v,this.order=200,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadMaterialPropertiesAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){var o=new Array;return o.push(e._loader.loadMaterialBasePropertiesAsync(i,n,t)),o.push(e._loadSpecularGlossinessPropertiesAsync(r,a,t)),e._loader.loadMaterialAlphaProperties(i,n,t),Promise.all(o).then(function(){})})},l.prototype._loadSpecularGlossinessPropertiesAsync=function(i,n,t){if(!(t instanceof s.PBRMaterial))throw new Error("".concat(i,": Material type not supported"));var e=new Array;return t.metallic=null,t.roughness=null,n.diffuseFactor?(t.albedoColor=s.Color3.FromArray(n.diffuseFactor),t.alpha=n.diffuseFactor[3]):t.albedoColor=s.Color3.White(),t.reflectivityColor=n.specularFactor?s.Color3.FromArray(n.specularFactor):s.Color3.White(),t.microSurface=n.glossinessFactor==null?1:n.glossinessFactor,n.diffuseTexture&&e.push(this._loader.loadTextureInfoAsync("".concat(i,"/diffuseTexture"),n.diffuseTexture,function(r){r.name="".concat(t.name," (Diffuse)"),t.albedoTexture=r})),n.specularGlossinessTexture&&(e.push(this._loader.loadTextureInfoAsync("".concat(i,"/specularGlossinessTexture"),n.specularGlossinessTexture,function(r){r.name="".concat(t.name," (Specular Glossiness)"),t.reflectivityTexture=r,t.reflectivityTexture.hasAlpha=!0})),t.useMicroSurfaceFromReflectivityMapAlpha=!0),Promise.all(e).then(function(){})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_sheen.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_materials_sheen:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_materials_sheen",m=function(){function l(i){this.name=v,this.order=190,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadMaterialPropertiesAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){var o=new Array;return o.push(e._loader.loadMaterialPropertiesAsync(i,n,t)),o.push(e._loadSheenPropertiesAsync(r,a,t)),Promise.all(o).then(function(){})})},l.prototype._loadSheenPropertiesAsync=function(i,n,t){if(!(t instanceof s.PBRMaterial))throw new Error("".concat(i,": Material type not supported"));var e=new Array;return t.sheen.isEnabled=!0,t.sheen.intensity=1,n.sheenColorFactor!=null?t.sheen.color=s.Color3.FromArray(n.sheenColorFactor):t.sheen.color=s.Color3.Black(),n.sheenColorTexture&&e.push(this._loader.loadTextureInfoAsync("".concat(i,"/sheenColorTexture"),n.sheenColorTexture,function(r){r.name="".concat(t.name," (Sheen Color)"),t.sheen.texture=r})),n.sheenRoughnessFactor!==void 0?t.sheen.roughness=n.sheenRoughnessFactor:t.sheen.roughness=0,n.sheenRoughnessTexture&&(n.sheenRoughnessTexture.nonColorData=!0,e.push(this._loader.loadTextureInfoAsync("".concat(i,"/sheenRoughnessTexture"),n.sheenRoughnessTexture,function(r){r.name="".concat(t.name," (Sheen Roughness)"),t.sheen.textureRoughness=r}))),t.sheen.albedoScaling=!0,t.sheen.useRoughnessFromMainTexture=!1,Promise.all(e).then(function(){})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_specular.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_materials_specular:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_materials_specular",m=function(){function l(i){this.name=v,this.order=190,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadMaterialPropertiesAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){var o=new Array;return o.push(e._loader.loadMaterialPropertiesAsync(i,n,t)),o.push(e._loadSpecularPropertiesAsync(r,a,t)),Promise.all(o).then(function(){})})},l.prototype._loadSpecularPropertiesAsync=function(i,n,t){if(!(t instanceof s.PBRMaterial))throw new Error("".concat(i,": Material type not supported"));var e=new Array;return n.specularFactor!==void 0&&(t.metallicF0Factor=n.specularFactor),n.specularColorFactor!==void 0&&(t.metallicReflectanceColor=s.Color3.FromArray(n.specularColorFactor)),n.specularTexture&&(n.specularTexture.nonColorData=!0,e.push(this._loader.loadTextureInfoAsync("".concat(i,"/specularTexture"),n.specularTexture,function(r){r.name="".concat(t.name," (Specular F0 Strength)"),t.metallicReflectanceTexture=r,t.useOnlyMetallicFromMetallicReflectanceTexture=!0}))),n.specularColorTexture&&e.push(this._loader.loadTextureInfoAsync("".concat(i,"/specularColorTexture"),n.specularColorTexture,function(r){r.name="".concat(t.name," (Specular F0 Color)"),t.reflectanceTexture=r})),Promise.all(e).then(function(){})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_transmission.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_materials_transmission:()=>i});var s=h("../../../../node_modules/tslib/tslib.es6.mjs"),u=h("babylonjs/Misc/observable"),v=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),m=function(){function n(t,e){var r=this;this._opaqueRenderTarget=null,this._opaqueMeshesCache=[],this._transparentMeshesCache=[],this._materialObservers={},this._options=(0,s.__assign)((0,s.__assign)({},n._GetDefaultOptions()),t),this._scene=e,this._scene._transmissionHelper=this,this.onErrorObservable=new u.Observable,this._scene.onDisposeObservable.addOnce(function(){r.dispose()}),this._parseScene(),this._setupRenderTargets()}return n._GetDefaultOptions=function(){return{renderSize:1024,samples:4,lodGenerationScale:1,lodGenerationOffset:-4,renderTargetTextureType:u.Constants.TEXTURETYPE_HALF_FLOAT,generateMipmaps:!0}},n.prototype.updateOptions=function(t){var e=this,r=Object.keys(t).filter(function(c){return e._options[c]!==t[c]});if(r.length){var a=(0,s.__assign)((0,s.__assign)({},this._options),t),o=this._options;this._options=a,a.renderSize!==o.renderSize||a.renderTargetTextureType!==o.renderTargetTextureType||a.generateMipmaps!==o.generateMipmaps||!this._opaqueRenderTarget?this._setupRenderTargets():(this._opaqueRenderTarget.samples=a.samples,this._opaqueRenderTarget.lodGenerationScale=a.lodGenerationScale,this._opaqueRenderTarget.lodGenerationOffset=a.lodGenerationOffset)}},n.prototype.getOpaqueTarget=function(){return this._opaqueRenderTarget},n.prototype._shouldRenderAsTransmission=function(t){return t?!!(t instanceof u.PBRMaterial&&t.subSurface.isRefractionEnabled):!1},n.prototype._addMesh=function(t){var e=this;this._materialObservers[t.uniqueId]=t.onMaterialChangedObservable.add(this._onMeshMaterialChanged.bind(this)),u.Tools.SetImmediate(function(){e._shouldRenderAsTransmission(t.material)?(t.material.refractionTexture=e._opaqueRenderTarget,e._transparentMeshesCache.indexOf(t)===-1&&e._transparentMeshesCache.push(t)):e._opaqueMeshesCache.indexOf(t)===-1&&e._opaqueMeshesCache.push(t)})},n.prototype._removeMesh=function(t){t.onMaterialChangedObservable.remove(this._materialObservers[t.uniqueId]),delete this._materialObservers[t.uniqueId];var e=this._transparentMeshesCache.indexOf(t);e!==-1&&this._transparentMeshesCache.splice(e,1),e=this._opaqueMeshesCache.indexOf(t),e!==-1&&this._opaqueMeshesCache.splice(e,1)},n.prototype._parseScene=function(){this._scene.meshes.forEach(this._addMesh.bind(this)),this._scene.onNewMeshAddedObservable.add(this._addMesh.bind(this)),this._scene.onMeshRemovedObservable.add(this._removeMesh.bind(this))},n.prototype._onMeshMaterialChanged=function(t){var e=this._transparentMeshesCache.indexOf(t),r=this._opaqueMeshesCache.indexOf(t),a=this._shouldRenderAsTransmission(t.material);a?(t.material instanceof u.PBRMaterial&&(t.material.subSurface.refractionTexture=this._opaqueRenderTarget),r!==-1?(this._opaqueMeshesCache.splice(r,1),this._transparentMeshesCache.push(t)):e===-1&&this._transparentMeshesCache.push(t)):e!==-1?(this._transparentMeshesCache.splice(e,1),this._opaqueMeshesCache.push(t)):r===-1&&this._opaqueMeshesCache.push(t)},n.prototype._isRenderTargetValid=function(){var t;return((t=this._opaqueRenderTarget)===null||t===void 0?void 0:t.getInternalTexture())!==null},n.prototype._setupRenderTargets=function(){var t=this,e,r;this._opaqueRenderTarget&&this._opaqueRenderTarget.dispose(),this._opaqueRenderTarget=new u.RenderTargetTexture("opaqueSceneTexture",this._options.renderSize,this._scene,this._options.generateMipmaps,void 0,this._options.renderTargetTextureType),this._opaqueRenderTarget.ignoreCameraViewport=!0,this._opaqueRenderTarget.renderList=this._opaqueMeshesCache,this._opaqueRenderTarget.clearColor=(r=(e=this._options.clearColor)===null||e===void 0?void 0:e.clone())!==null&&r!==void 0?r:this._scene.clearColor.clone(),this._opaqueRenderTarget.gammaSpace=!1,this._opaqueRenderTarget.lodGenerationScale=this._options.lodGenerationScale,this._opaqueRenderTarget.lodGenerationOffset=this._options.lodGenerationOffset,this._opaqueRenderTarget.samples=this._options.samples,this._opaqueRenderTarget.renderSprites=!0,this._opaqueRenderTarget.renderParticles=!0;var a,o;this._opaqueRenderTarget.onBeforeBindObservable.add(function(c){o=t._scene.environmentIntensity,t._scene.environmentIntensity=1,a=t._scene.imageProcessingConfiguration.applyByPostProcess,t._options.clearColor?c.clearColor.copyFrom(t._options.clearColor):t._scene.clearColor.toLinearSpaceToRef(c.clearColor,t._scene.getEngine().useExactSrgbConversions),t._scene.imageProcessingConfiguration._applyByPostProcess=!0}),this._opaqueRenderTarget.onAfterUnbindObservable.add(function(){t._scene.environmentIntensity=o,t._scene.imageProcessingConfiguration._applyByPostProcess=a}),this._transparentMeshesCache.forEach(function(c){t._shouldRenderAsTransmission(c.material)&&(c.material.refractionTexture=t._opaqueRenderTarget)})},n.prototype.dispose=function(){this._scene._transmissionHelper=void 0,this._opaqueRenderTarget&&(this._opaqueRenderTarget.dispose(),this._opaqueRenderTarget=null),this._transparentMeshesCache=[],this._opaqueMeshesCache=[]},n}(),l="KHR_materials_transmission",i=function(){function n(t){this.name=l,this.order=175,this._loader=t,this.enabled=this._loader.isExtensionUsed(l),this.enabled&&(t.parent.transparencyAsCoverage=!0)}return n.prototype.dispose=function(){this._loader=null},n.prototype.loadMaterialPropertiesAsync=function(t,e,r){var a=this;return v.GLTFLoader.LoadExtensionAsync(t,e,this.name,function(o,c){var d=new Array;return d.push(a._loader.loadMaterialBasePropertiesAsync(t,e,r)),d.push(a._loader.loadMaterialPropertiesAsync(t,e,r)),d.push(a._loadTransparentPropertiesAsync(o,e,r,c)),Promise.all(d).then(function(){})})},n.prototype._loadTransparentPropertiesAsync=function(t,e,r,a){var o,c;if(!(r instanceof u.PBRMaterial))throw new Error("".concat(t,": Material type not supported"));var d=r;if(d.subSurface.isRefractionEnabled=!0,d.subSurface.volumeIndexOfRefraction=1,d.subSurface.useAlbedoToTintRefraction=!0,a.transmissionFactor!==void 0){d.subSurface.refractionIntensity=a.transmissionFactor;var f=d.getScene();d.subSurface.refractionIntensity&&!f._transmissionHelper?new m({},d.getScene()):d.subSurface.refractionIntensity&&!(!((o=f._transmissionHelper)===null||o===void 0)&&o._isRenderTargetValid())&&((c=f._transmissionHelper)===null||c===void 0||c._setupRenderTargets())}else return d.subSurface.refractionIntensity=0,d.subSurface.isRefractionEnabled=!1,Promise.resolve();return d.subSurface.minimumThickness=0,d.subSurface.maximumThickness=0,a.transmissionTexture?(a.transmissionTexture.nonColorData=!0,this._loader.loadTextureInfoAsync("".concat(t,"/transmissionTexture"),a.transmissionTexture,void 0).then(function(T){d.subSurface.refractionIntensityTexture=T,d.subSurface.useGltfStyleTextures=!0})):Promise.resolve()},n}();v.GLTFLoader.RegisterExtension(l,function(n){return new i(n)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_unlit.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_materials_unlit:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_materials_unlit",m=function(){function l(i){this.name=v,this.order=210,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadMaterialPropertiesAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(){return e._loadUnlitPropertiesAsync(i,n,t)})},l.prototype._loadUnlitPropertiesAsync=function(i,n,t){if(!(t instanceof s.PBRMaterial))throw new Error("".concat(i,": Material type not supported"));var e=new Array;t.unlit=!0;var r=n.pbrMetallicRoughness;return r&&(r.baseColorFactor?(t.albedoColor=s.Color3.FromArray(r.baseColorFactor),t.alpha=r.baseColorFactor[3]):t.albedoColor=s.Color3.White(),r.baseColorTexture&&e.push(this._loader.loadTextureInfoAsync("".concat(i,"/baseColorTexture"),r.baseColorTexture,function(a){a.name="".concat(t.name," (Base Color)"),t.albedoTexture=a}))),n.doubleSided&&(t.backFaceCulling=!1,t.twoSidedLighting=!0),this._loader.loadMaterialAlphaProperties(i,n,t),Promise.all(e).then(function(){})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_variants.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_materials_variants:()=>m});var s=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),u=h("babylonjs/Misc/observable"),v="KHR_materials_variants",m=function(){function l(i){this.name=v,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.GetAvailableVariants=function(i){var n=this._GetExtensionMetadata(i);return n?Object.keys(n.variants):[]},l.prototype.getAvailableVariants=function(i){return l.GetAvailableVariants(i)},l.SelectVariant=function(i,n){var t=this._GetExtensionMetadata(i);if(!t)throw new Error("Cannot select variant on a glTF mesh that does not have the ".concat(v," extension"));var e=function(c){var d=t.variants[c];if(d)for(var f=0,T=d;f<T.length;f++){var g=T[f];g.mesh.material=g.material}};if(n instanceof Array)for(var r=0,a=n;r<a.length;r++){var o=a[r];e(o)}else e(n);t.lastSelected=n},l.prototype.selectVariant=function(i,n){l.SelectVariant(i,n)},l.Reset=function(i){var n=this._GetExtensionMetadata(i);if(!n)throw new Error("Cannot reset on a glTF mesh that does not have the ".concat(v," extension"));for(var t=0,e=n.original;t<e.length;t++){var r=e[t];r.mesh.material=r.material}n.lastSelected=null},l.prototype.reset=function(i){l.Reset(i)},l.GetLastSelectedVariant=function(i){var n=this._GetExtensionMetadata(i);if(!n)throw new Error("Cannot get the last selected variant on a glTF mesh that does not have the ".concat(v," extension"));return n.lastSelected},l.prototype.getLastSelectedVariant=function(i){return l.GetLastSelectedVariant(i)},l._GetExtensionMetadata=function(i){var n,t;return((t=(n=i==null?void 0:i._internalMetadata)===null||n===void 0?void 0:n.gltf)===null||t===void 0?void 0:t[v])||null},l.prototype.onLoading=function(){var i=this._loader.gltf.extensions;if(i&&i[this.name]){var n=i[this.name];this._variants=n.variants}},l.prototype._loadMeshPrimitiveAsync=function(i,n,t,e,r,a){var o=this;return s.GLTFLoader.LoadExtensionAsync(i,r,this.name,function(c,d){var f=new Array;return f.push(o._loader._loadMeshPrimitiveAsync(i,n,t,e,r,function(T){if(a(T),T instanceof u.Mesh){var g=s.GLTFLoader._GetDrawMode(i,r.mode),F=o._loader.rootBabylonMesh,M=F?F._internalMetadata=F._internalMetadata||{}:{},C=M.gltf=M.gltf||{},R=C[v]=C[v]||{lastSelected:null,original:[],variants:{}};R.original.push({mesh:T,material:T.material});for(var B=function(V){var j=d.mappings[V],z=s.ArrayItem.Get("".concat(c,"/mappings/").concat(V,"/material"),o._loader.gltf.materials,j.material);f.push(o._loader._loadMaterialAsync("#/materials/".concat(j.material),z,T,g,function(Z){for(var Q=function(oe){var ue=j.variants[oe],ie=s.ArrayItem.Get("/extensions/".concat(v,"/variants/").concat(ue),o._variants,ue);R.variants[ie.name]=R.variants[ie.name]||[],R.variants[ie.name].push({mesh:T,material:Z}),T.onClonedObservable.add(function(q){var ee=q,$=null,O=ee;do{if(O=O.parent,!O)return;$=l._GetExtensionMetadata(O)}while($===null);if(F&&$===l._GetExtensionMetadata(F)){O._internalMetadata={};for(var b in F._internalMetadata)O._internalMetadata[b]=F._internalMetadata[b];O._internalMetadata.gltf=[];for(var b in F._internalMetadata.gltf)O._internalMetadata.gltf[b]=F._internalMetadata.gltf[b];O._internalMetadata.gltf[v]={lastSelected:null,original:[],variants:{}};for(var x=0,p=$.original;x<p.length;x++){var _=p[x];O._internalMetadata.gltf[v].original.push({mesh:_.mesh,material:_.material})}for(var b in $.variants)if(Object.prototype.hasOwnProperty.call($.variants,b)){O._internalMetadata.gltf[v].variants[b]=[];for(var y=0,A=$.variants[b];y<A.length;y++){var L=A[y];O._internalMetadata.gltf[v].variants[b].push({mesh:L.mesh,material:L.material})}}$=O._internalMetadata.gltf[v]}for(var S=0,P=$.original;S<P.length;S++){var I=P[S];I.mesh===T&&(I.mesh=ee)}for(var D=0,G=$.variants[ie.name];D<G.length;D++){var I=G[D];I.mesh===T&&(I.mesh=ee)}})},k=0;k<j.variants.length;++k)Q(k)}))},K=0;K<d.mappings.length;++K)B(K)}})),Promise.all(f).then(function(T){var g=T[0];return g})})},l}();s.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_volume.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_materials_volume:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_materials_volume",m=function(){function l(i){this.name=v,this.order=173,this._loader=i,this.enabled=this._loader.isExtensionUsed(v),this.enabled&&this._loader._disableInstancedMesh++}return l.prototype.dispose=function(){this.enabled&&this._loader._disableInstancedMesh--,this._loader=null},l.prototype.loadMaterialPropertiesAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){var o=new Array;return o.push(e._loader.loadMaterialBasePropertiesAsync(i,n,t)),o.push(e._loader.loadMaterialPropertiesAsync(i,n,t)),o.push(e._loadVolumePropertiesAsync(r,n,t,a)),Promise.all(o).then(function(){})})},l.prototype._loadVolumePropertiesAsync=function(i,n,t,e){if(!(t instanceof s.PBRMaterial))throw new Error("".concat(i,": Material type not supported"));if(!t.subSurface.isRefractionEnabled&&!t.subSurface.isTranslucencyEnabled||!e.thicknessFactor)return Promise.resolve();t.subSurface.volumeIndexOfRefraction=t.indexOfRefraction;var r=e.attenuationDistance!==void 0?e.attenuationDistance:Number.MAX_VALUE;return t.subSurface.tintColorAtDistance=r,e.attenuationColor!==void 0&&e.attenuationColor.length==3&&t.subSurface.tintColor.copyFromFloats(e.attenuationColor[0],e.attenuationColor[1],e.attenuationColor[2]),t.subSurface.minimumThickness=0,t.subSurface.maximumThickness=e.thicknessFactor,t.subSurface.useThicknessAsDepth=!0,e.thicknessTexture?(e.thicknessTexture.nonColorData=!0,this._loader.loadTextureInfoAsync("".concat(i,"/thicknessTexture"),e.thicknessTexture).then(function(a){t.subSurface.thicknessTexture=a,t.subSurface.useGltfStyleTextures=!0})):Promise.resolve()},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_mesh_quantization.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_mesh_quantization:()=>v});var s=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),u="KHR_mesh_quantization",v=function(){function m(l){this.name=u,this.enabled=l.isExtensionUsed(u)}return m.prototype.dispose=function(){},m}();s.GLTFLoader.RegisterExtension(u,function(m){return new v(m)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_texture_basisu.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_texture_basisu:()=>v});var s=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),u="KHR_texture_basisu",v=function(){function m(l){this.name=u,this._loader=l,this.enabled=l.isExtensionUsed(u)}return m.prototype.dispose=function(){this._loader=null},m.prototype._loadTextureAsync=function(l,i,n){var t=this;return s.GLTFLoader.LoadExtensionAsync(l,i,this.name,function(e,r){var a=i.sampler==null?s.GLTFLoader.DefaultSampler:s.ArrayItem.Get("".concat(l,"/sampler"),t._loader.gltf.samplers,i.sampler),o=s.ArrayItem.Get("".concat(e,"/source"),t._loader.gltf.images,r.source);return t._loader._createTextureAsync(l,a,o,function(c){n(c)},i._textureInfo.nonColorData?{useRGBAIfASTCBC7NotAvailableWhenUASTC:!0}:void 0,!i._textureInfo.nonColorData)})},m}();s.GLTFLoader.RegisterExtension(u,function(m){return new v(m)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_texture_transform.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_texture_transform:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="KHR_texture_transform",m=function(){function l(i){this.name=v,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadTextureInfoAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){return e._loader.loadTextureInfoAsync(i,n,function(o){if(!(o instanceof s.Texture))throw new Error("".concat(r,": Texture type not supported"));a.offset&&(o.uOffset=a.offset[0],o.vOffset=a.offset[1]),o.uRotationCenter=0,o.vRotationCenter=0,a.rotation&&(o.wAng=-a.rotation),a.scale&&(o.uScale=a.scale[0],o.vScale=a.scale[1]),a.texCoord!=null&&(o.coordinatesIndex=a.texCoord),t(o)})})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/KHR_xmp_json_ld.ts":(N,E,h)=>{h.r(E),h.d(E,{KHR_xmp_json_ld:()=>v});var s=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),u="KHR_xmp_json_ld",v=function(){function m(l){this.name=u,this.order=100,this._loader=l,this.enabled=this._loader.isExtensionUsed(u)}return m.prototype.dispose=function(){this._loader=null},m.prototype.onLoading=function(){var l,i,n;if(this._loader.rootBabylonMesh!==null){var t=(l=this._loader.gltf.extensions)===null||l===void 0?void 0:l.KHR_xmp_json_ld,e=(n=(i=this._loader.gltf.asset)===null||i===void 0?void 0:i.extensions)===null||n===void 0?void 0:n.KHR_xmp_json_ld;if(t&&e){var r=+e.packet;t.packets&&r<t.packets.length&&(this._loader.rootBabylonMesh.metadata=this._loader.rootBabylonMesh.metadata||{},this._loader.rootBabylonMesh.metadata.xmp=t.packets[r])}}},m}();s.GLTFLoader.RegisterExtension(u,function(m){return new v(m)})},"../../../dev/loaders/src/glTF/2.0/Extensions/MSFT_audio_emitter.ts":(N,E,h)=>{h.r(E),h.d(E,{MSFT_audio_emitter:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="MSFT_audio_emitter",m=function(){function l(i){this.name=v,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null,this._clips=null,this._emitters=null},l.prototype.onLoading=function(){var i=this._loader.gltf.extensions;if(i&&i[this.name]){var n=i[this.name];this._clips=n.clips,this._emitters=n.emitters,u.ArrayItem.Assign(this._clips),u.ArrayItem.Assign(this._emitters)}},l.prototype.loadSceneAsync=function(i,n){var t=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(e,r){var a=new Array;a.push(t._loader.loadSceneAsync(i,n));for(var o=0,c=r.emitters;o<c.length;o++){var d=c[o],f=u.ArrayItem.Get("".concat(e,"/emitters"),t._emitters,d);if(f.refDistance!=null||f.maxDistance!=null||f.rolloffFactor!=null||f.distanceModel!=null||f.innerAngle!=null||f.outerAngle!=null)throw new Error("".concat(e,": Direction or Distance properties are not allowed on emitters attached to a scene"));a.push(t._loadEmitterAsync("".concat(e,"/emitters/").concat(f.index),f))}return Promise.all(a).then(function(){})})},l.prototype.loadNodeAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){var o=new Array;return e._loader.loadNodeAsync(r,n,function(c){for(var d=function(F){var M=u.ArrayItem.Get("".concat(r,"/emitters"),e._emitters,F);o.push(e._loadEmitterAsync("".concat(r,"/emitters/").concat(M.index),M).then(function(){for(var C=0,R=M._babylonSounds;C<R.length;C++){var B=R[C];B.attachToMesh(c),(M.innerAngle!=null||M.outerAngle!=null)&&(B.setLocalDirectionToMesh(s.Vector3.Forward()),B.setDirectionalCone(2*s.Tools.ToDegrees(M.innerAngle==null?Math.PI:M.innerAngle),2*s.Tools.ToDegrees(M.outerAngle==null?Math.PI:M.outerAngle),0))}}))},f=0,T=a.emitters;f<T.length;f++){var g=T[f];d(g)}t(c)}).then(function(c){return Promise.all(o).then(function(){return c})})})},l.prototype.loadAnimationAsync=function(i,n){var t=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(e,r){return t._loader.loadAnimationAsync(i,n).then(function(a){var o=new Array;u.ArrayItem.Assign(r.events);for(var c=0,d=r.events;c<d.length;c++){var f=d[c];o.push(t._loadAnimationEventAsync("".concat(e,"/events/").concat(f.index),i,n,f,a))}return Promise.all(o).then(function(){return a})})})},l.prototype._loadClipAsync=function(i,n){if(n._objectURL)return n._objectURL;var t;if(n.uri)t=this._loader.loadUriAsync(i,n,n.uri);else{var e=u.ArrayItem.Get("".concat(i,"/bufferView"),this._loader.gltf.bufferViews,n.bufferView);t=this._loader.loadBufferViewAsync("/bufferViews/".concat(e.index),e)}return n._objectURL=t.then(function(r){return URL.createObjectURL(new Blob([r],{type:n.mimeType}))}),n._objectURL},l.prototype._loadEmitterAsync=function(i,n){var t=this;if(n._babylonSounds=n._babylonSounds||[],!n._babylonData){for(var e=new Array,r=n.name||"emitter".concat(n.index),a={loop:!1,autoplay:!1,volume:n.volume==null?1:n.volume},o=function(T){var g="/extensions/".concat(c.name,"/clips"),F=u.ArrayItem.Get(g,c._clips,n.clips[T].clip);e.push(c._loadClipAsync("".concat(g,"/").concat(n.clips[T].clip),F).then(function(M){var C=n._babylonSounds[T]=new s.Sound(r,M,t._loader.babylonScene,null,a);C.refDistance=n.refDistance||1,C.maxDistance=n.maxDistance||256,C.rolloffFactor=n.rolloffFactor||1,C.distanceModel=n.distanceModel||"exponential"}))},c=this,d=0;d<n.clips.length;d++)o(d);var f=Promise.all(e).then(function(){var T=n.clips.map(function(F){return F.weight||1}),g=new s.WeightedSound(n.loop||!1,n._babylonSounds,T);n.innerAngle&&(g.directionalConeInnerAngle=2*s.Tools.ToDegrees(n.innerAngle)),n.outerAngle&&(g.directionalConeOuterAngle=2*s.Tools.ToDegrees(n.outerAngle)),n.volume&&(g.volume=n.volume),n._babylonData.sound=g});n._babylonData={loaded:f}}return n._babylonData.loaded},l.prototype._getEventAction=function(i,n,t,e,r){switch(t){case"play":return function(a){var o=(r||0)+(a-e);n.play(o)};case"stop":return function(){n.stop()};case"pause":return function(){n.pause()};default:throw new Error("".concat(i,": Unsupported action ").concat(t))}},l.prototype._loadAnimationEventAsync=function(i,n,t,e,r){var a=this;if(r.targetedAnimations.length==0)return Promise.resolve();var o=r.targetedAnimations[0],c=e.emitter,d=u.ArrayItem.Get("/extensions/".concat(this.name,"/emitters"),this._emitters,c);return this._loadEmitterAsync(i,d).then(function(){var f=d._babylonData.sound;if(f){var T=new s.AnimationEvent(e.time,a._getEventAction(i,f,e.action,e.time,e.startOffset));o.animation.addEvent(T),r.onAnimationGroupEndObservable.add(function(){f.stop()}),r.onAnimationGroupPauseObservable.add(function(){f.pause()})}})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/MSFT_lod.ts":(N,E,h)=>{h.r(E),h.d(E,{MSFT_lod:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="MSFT_lod",m=function(){function l(i){this.name=v,this.order=100,this.maxLODsToLoad=10,this.onNodeLODsLoadedObservable=new s.Observable,this.onMaterialLODsLoadedObservable=new s.Observable,this._bufferLODs=new Array,this._nodeIndexLOD=null,this._nodeSignalLODs=new Array,this._nodePromiseLODs=new Array,this._nodeBufferLODs=new Array,this._materialIndexLOD=null,this._materialSignalLODs=new Array,this._materialPromiseLODs=new Array,this._materialBufferLODs=new Array,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null,this._nodeIndexLOD=null,this._nodeSignalLODs.length=0,this._nodePromiseLODs.length=0,this._nodeBufferLODs.length=0,this._materialIndexLOD=null,this._materialSignalLODs.length=0,this._materialPromiseLODs.length=0,this._materialBufferLODs.length=0,this.onMaterialLODsLoadedObservable.clear(),this.onNodeLODsLoadedObservable.clear()},l.prototype.onReady=function(){for(var i=this,n=function(o){var c=Promise.all(t._nodePromiseLODs[o]).then(function(){o!==0&&(i._loader.endPerformanceCounter("Node LOD ".concat(o)),i._loader.log("Loaded node LOD ".concat(o))),i.onNodeLODsLoadedObservable.notifyObservers(o),o!==i._nodePromiseLODs.length-1&&(i._loader.startPerformanceCounter("Node LOD ".concat(o+1)),i._loadBufferLOD(i._nodeBufferLODs,o+1),i._nodeSignalLODs[o]&&i._nodeSignalLODs[o].resolve())});t._loader._completePromises.push(c)},t=this,e=0;e<this._nodePromiseLODs.length;e++)n(e);for(var r=function(o){var c=Promise.all(a._materialPromiseLODs[o]).then(function(){o!==0&&(i._loader.endPerformanceCounter("Material LOD ".concat(o)),i._loader.log("Loaded material LOD ".concat(o))),i.onMaterialLODsLoadedObservable.notifyObservers(o),o!==i._materialPromiseLODs.length-1&&(i._loader.startPerformanceCounter("Material LOD ".concat(o+1)),i._loadBufferLOD(i._materialBufferLODs,o+1),i._materialSignalLODs[o]&&i._materialSignalLODs[o].resolve())});a._loader._completePromises.push(c)},a=this,e=0;e<this._materialPromiseLODs.length;e++)r(e)},l.prototype.loadSceneAsync=function(i,n){var t=this._loader.loadSceneAsync(i,n);return this._loadBufferLOD(this._bufferLODs,0),t},l.prototype.loadNodeAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(r,a){var o,c=e._getLODs(r,n,e._loader.gltf.nodes,a.ids);e._loader.logOpen("".concat(r));for(var d=function(T){var g=c[T];T!==0&&(e._nodeIndexLOD=T,e._nodeSignalLODs[T]=e._nodeSignalLODs[T]||new s.Deferred);var F=function(C){t(C),C.setEnabled(!1)},M=e._loader.loadNodeAsync("/nodes/".concat(g.index),g,F).then(function(C){if(T!==0){var R=c[T-1];R._babylonTransformNode&&(e._disposeTransformNode(R._babylonTransformNode),delete R._babylonTransformNode)}return C.setEnabled(!0),C});e._nodePromiseLODs[T]=e._nodePromiseLODs[T]||[],T===0?o=M:(e._nodeIndexLOD=null,e._nodePromiseLODs[T].push(M))},f=0;f<c.length;f++)d(f);return e._loader.logClose(),o})},l.prototype._loadMaterialAsync=function(i,n,t,e,r){var a=this;return this._nodeIndexLOD?null:u.GLTFLoader.LoadExtensionAsync(i,n,this.name,function(o,c){var d,f=a._getLODs(o,n,a._loader.gltf.materials,c.ids);a._loader.logOpen("".concat(o));for(var T=function(F){var M=f[F];F!==0&&(a._materialIndexLOD=F);var C=a._loader._loadMaterialAsync("/materials/".concat(M.index),M,t,e,function(R){F===0&&r(R)}).then(function(R){if(F!==0){r(R);var B=f[F-1]._data;B[e]&&(a._disposeMaterials([B[e].babylonMaterial]),delete B[e])}return R});a._materialPromiseLODs[F]=a._materialPromiseLODs[F]||[],F===0?d=C:(a._materialIndexLOD=null,a._materialPromiseLODs[F].push(C))},g=0;g<f.length;g++)T(g);return a._loader.logClose(),d})},l.prototype._loadUriAsync=function(i,n,t){var e=this;if(this._nodeIndexLOD!==null){this._loader.log("deferred");var r=this._nodeIndexLOD-1;return this._nodeSignalLODs[r]=this._nodeSignalLODs[r]||new s.Deferred,this._nodeSignalLODs[this._nodeIndexLOD-1].promise.then(function(){return e._loader.loadUriAsync(i,n,t)})}else if(this._materialIndexLOD!==null){this._loader.log("deferred");var r=this._materialIndexLOD-1;return this._materialSignalLODs[r]=this._materialSignalLODs[r]||new s.Deferred,this._materialSignalLODs[r].promise.then(function(){return e._loader.loadUriAsync(i,n,t)})}return null},l.prototype.loadBufferAsync=function(i,n,t,e){if(this._loader.parent.useRangeRequests&&!n.uri){if(!this._loader.bin)throw new Error("".concat(i,": Uri is missing or the binary glTF is missing its binary chunk"));var r=function(a,o){var c=t,d=c+e-1,f=a[o];return f?(f.start=Math.min(f.start,c),f.end=Math.max(f.end,d)):(f={start:c,end:d,loaded:new s.Deferred},a[o]=f),f.loaded.promise.then(function(T){return new Uint8Array(T.buffer,T.byteOffset+t-f.start,e)})};return this._loader.log("deferred"),this._nodeIndexLOD!==null?r(this._nodeBufferLODs,this._nodeIndexLOD):this._materialIndexLOD!==null?r(this._materialBufferLODs,this._materialIndexLOD):r(this._bufferLODs,0)}return null},l.prototype._loadBufferLOD=function(i,n){var t=i[n];t&&(this._loader.log("Loading buffer range [".concat(t.start,"-").concat(t.end,"]")),this._loader.bin.readAsync(t.start,t.end-t.start+1).then(function(e){t.loaded.resolve(e)},function(e){t.loaded.reject(e)}))},l.prototype._getLODs=function(i,n,t,e){if(this.maxLODsToLoad<=0)throw new Error("maxLODsToLoad must be greater than zero");for(var r=[],a=e.length-1;a>=0;a--)if(r.push(u.ArrayItem.Get("".concat(i,"/ids/").concat(e[a]),t,e[a])),r.length===this.maxLODsToLoad)return r;return r.push(n),r},l.prototype._disposeTransformNode=function(i){var n=this,t=[],e=i.material;e&&t.push(e);for(var r=0,a=i.getChildMeshes();r<a.length;r++){var o=a[r];o.material&&t.push(o.material)}i.dispose();var c=t.filter(function(d){return n._loader.babylonScene.meshes.every(function(f){return f.material!=d})});this._disposeMaterials(c)},l.prototype._disposeMaterials=function(i){for(var n={},t=0,e=i;t<e.length;t++){for(var r=e[t],a=0,o=r.getActiveTextures();a<o.length;a++){var c=o[a];n[c.uniqueId]=c}r.dispose()}for(var d in n)for(var f=0,T=this._loader.babylonScene.materials;f<T.length;f++){var r=T[f];r.hasTexture(n[d])&&delete n[d]}for(var d in n)n[d].dispose()},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/MSFT_minecraftMesh.ts":(N,E,h)=>{h.r(E),h.d(E,{MSFT_minecraftMesh:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="MSFT_minecraftMesh",m=function(){function l(i){this.name=v,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadMaterialPropertiesAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtraAsync(i,n,this.name,function(r,a){if(a){if(!(t instanceof s.PBRMaterial))throw new Error("".concat(r,": Material type not supported"));var o=e._loader.loadMaterialPropertiesAsync(i,n,t);return t.needAlphaBlending()&&(t.forceDepthWrite=!0,t.separateCullingPass=!0),t.backFaceCulling=t.forceDepthWrite,t.twoSidedLighting=!0,o}return null})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/MSFT_sRGBFactors.ts":(N,E,h)=>{h.r(E),h.d(E,{MSFT_sRGBFactors:()=>m});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts"),v="MSFT_sRGBFactors",m=function(){function l(i){this.name=v,this._loader=i,this.enabled=this._loader.isExtensionUsed(v)}return l.prototype.dispose=function(){this._loader=null},l.prototype.loadMaterialPropertiesAsync=function(i,n,t){var e=this;return u.GLTFLoader.LoadExtraAsync(i,n,this.name,function(r,a){if(a){if(!(t instanceof s.PBRMaterial))throw new Error("".concat(r,": Material type not supported"));var o=e._loader.loadMaterialPropertiesAsync(i,n,t),c=t.getScene().getEngine().useExactSrgbConversions;return t.albedoTexture||t.albedoColor.toLinearSpaceToRef(t.albedoColor,c),t.reflectivityTexture||t.reflectivityColor.toLinearSpaceToRef(t.reflectivityColor,c),o}return null})},l}();u.GLTFLoader.RegisterExtension(v,function(l){return new m(l)})},"../../../dev/loaders/src/glTF/2.0/Extensions/gltfPathToObjectConverter.ts":(N,E,h)=>{h.r(E),h.d(E,{GLTFPathToObjectConverter:()=>s});var s=function(){function u(v,m){this._gltf=v,this._infoTree=m}return u.prototype.convert=function(v){var m=this._gltf,l=this._infoTree,i=void 0;if(!v.startsWith("/"))throw new Error("Path must start with a /");var n=v.split("/");n.shift();for(var t=0,e=n;t<e.length;t++){var r=e[t];if(l.__array__)l=l.__array__;else if(l=l[r],!l)throw new Error("Path ".concat(v," is invalid"));if(m===void 0)throw new Error("Path ".concat(v," is invalid"));m=m[r],l.__target__&&(i=m)}return{object:i,info:l}},u}()},"../../../dev/loaders/src/glTF/2.0/Extensions/index.ts":(N,E,h)=>{h.r(E),h.d(E,{EXT_lights_image_based:()=>s.EXT_lights_image_based,EXT_mesh_gpu_instancing:()=>u.EXT_mesh_gpu_instancing,EXT_meshopt_compression:()=>v.EXT_meshopt_compression,EXT_texture_avif:()=>l.EXT_texture_avif,EXT_texture_webp:()=>m.EXT_texture_webp,ExtrasAsMetadata:()=>ie.ExtrasAsMetadata,KHR_animation_pointer:()=>z.KHR_animation_pointer,KHR_draco_mesh_compression:()=>i.KHR_draco_mesh_compression,KHR_interactivity:()=>ue.KHR_interactivity,KHR_lights:()=>n.KHR_lights,KHR_materials_anisotropy:()=>o.KHR_materials_anisotropy,KHR_materials_clearcoat:()=>r.KHR_materials_clearcoat,KHR_materials_diffuse_transmission:()=>M.KHR_materials_diffuse_transmission,KHR_materials_dispersion:()=>R.KHR_materials_dispersion,KHR_materials_emissive_strength:()=>c.KHR_materials_emissive_strength,KHR_materials_ior:()=>T.KHR_materials_ior,KHR_materials_iridescence:()=>a.KHR_materials_iridescence,KHR_materials_pbrSpecularGlossiness:()=>t.KHR_materials_pbrSpecularGlossiness,KHR_materials_sheen:()=>d.KHR_materials_sheen,KHR_materials_specular:()=>f.KHR_materials_specular,KHR_materials_transmission:()=>F.KHR_materials_transmission,KHR_materials_unlit:()=>e.KHR_materials_unlit,KHR_materials_variants:()=>g.KHR_materials_variants,KHR_materials_volume:()=>C.KHR_materials_volume,KHR_mesh_quantization:()=>B.KHR_mesh_quantization,KHR_texture_basisu:()=>K.KHR_texture_basisu,KHR_texture_transform:()=>V.KHR_texture_transform,KHR_xmp_json_ld:()=>j.KHR_xmp_json_ld,MSFT_audio_emitter:()=>Z.MSFT_audio_emitter,MSFT_lod:()=>Q.MSFT_lod,MSFT_minecraftMesh:()=>k.MSFT_minecraftMesh,MSFT_sRGBFactors:()=>oe.MSFT_sRGBFactors});var s=h("../../../dev/loaders/src/glTF/2.0/Extensions/EXT_lights_image_based.ts"),u=h("../../../dev/loaders/src/glTF/2.0/Extensions/EXT_mesh_gpu_instancing.ts"),v=h("../../../dev/loaders/src/glTF/2.0/Extensions/EXT_meshopt_compression.ts"),m=h("../../../dev/loaders/src/glTF/2.0/Extensions/EXT_texture_webp.ts"),l=h("../../../dev/loaders/src/glTF/2.0/Extensions/EXT_texture_avif.ts"),i=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_draco_mesh_compression.ts"),n=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_lights_punctual.ts"),t=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_pbrSpecularGlossiness.ts"),e=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_unlit.ts"),r=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_clearcoat.ts"),a=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_iridescence.ts"),o=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_anisotropy.ts"),c=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_emissive_strength.ts"),d=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_sheen.ts"),f=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_specular.ts"),T=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_ior.ts"),g=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_variants.ts"),F=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_transmission.ts"),M=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_diffuse_transmission.ts"),C=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_volume.ts"),R=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_materials_dispersion.ts"),B=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_mesh_quantization.ts"),K=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_texture_basisu.ts"),V=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_texture_transform.ts"),j=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_xmp_json_ld.ts"),z=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_animation_pointer.ts"),Z=h("../../../dev/loaders/src/glTF/2.0/Extensions/MSFT_audio_emitter.ts"),Q=h("../../../dev/loaders/src/glTF/2.0/Extensions/MSFT_lod.ts"),k=h("../../../dev/loaders/src/glTF/2.0/Extensions/MSFT_minecraftMesh.ts"),oe=h("../../../dev/loaders/src/glTF/2.0/Extensions/MSFT_sRGBFactors.ts"),ue=h("../../../dev/loaders/src/glTF/2.0/Extensions/KHR_interactivity.ts"),ie=h("../../../dev/loaders/src/glTF/2.0/Extensions/ExtrasAsMetadata.ts")},"../../../dev/loaders/src/glTF/2.0/Extensions/interactivityFunctions.ts":(N,E,h)=>{h.r(E),h.d(E,{convertGLTFToSerializedFlowGraph:()=>i});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/2.0/Extensions/interactivityUtils.ts");function v(n,t,e){if(n.type!==void 0){var r=t.types&&t.types[n.type];if(!r)throw new Error("".concat(e,": Unknown type: ").concat(n.type));var a=r.signature;if(!a)throw new Error("".concat(e,": Type ").concat(n.type," has no signature"));var o=u.gltfTypeToBabylonType[a];return{value:n.value,className:o}}else return n.value}function m(n,t,e){for(var r,a={},o=(r=n.configuration)!==null&&r!==void 0?r:[],c=0,d=o;c<d.length;c++){var f=d[c];if(f.id==="customEvent"){var T=t.customEvents&&t.customEvents[f.value];if(!T)throw new Error("/extensions/KHR_interactivity/nodes/".concat(e,": Unknown custom event: ").concat(f.value));a.eventId=T.id,a.eventData=T.values.map(function(M){return M.id})}else if(f.id==="variable"){var g=t.variables&&t.variables[f.value];if(!g)throw new Error("/extensions/KHR_interactivity/nodes/".concat(e,": Unknown variable: ").concat(f.value));a.variableName=g.id}else if(f.id==="path"){var F=f.value;a.path=F}else a[f.id]=v(f,t,"/extensions/KHR_interactivity/nodes/".concat(e))}return a}function l(n,t,e){var r=u.gltfToFlowGraphTypeMap[t.type];if(!r)throw new Error("/extensions/KHR_interactivity/nodes/".concat(n,": Unknown block type: ").concat(t.type));var a=n.toString(),o=m(t,e,a),c=t.metadata,d=[],f=[],T=[],g=[];return{className:r,config:o,uniqueId:a,metadata:c,dataInputs:d,dataOutputs:f,signalInputs:T,signalOutputs:g}}function i(n){for(var t,e,r,a={uniqueId:(0,s.RandomGUID)(),_userVariables:{},_connectionValues:{}},o=[a],c=[],d=0;d<n.nodes.length;d++){var f=n.nodes[d],T=l(d,f,n);c.push(T)}for(var d=0;d<n.nodes.length;d++){for(var f=n.nodes[d],g=c[d],F=(t=f.flows)!==null&&t!==void 0?t:[],M=function(q){var ee=q.id,$={uniqueId:(0,s.RandomGUID)(),name:ee,_connectionType:1,connectedPointIds:[]};g.signalOutputs.push($);var O=q.node,b=q.socket,x=c[O];if(!x)throw new Error("/extensions/KHR_interactivity/nodes/".concat(d,": Could not find node with id ").concat(O," that connects its input with with node ").concat(d,"'s output ").concat(ee));var p=x.signalInputs.find(function(_){return _.name===b});p||(p={uniqueId:(0,s.RandomGUID)(),name:b,_connectionType:0,connectedPointIds:[]},x.signalInputs.push(p)),p.connectedPointIds.push($.uniqueId),$.connectedPointIds.push(p.uniqueId)},C=0,R=F;C<R.length;C++){var B=R[C];M(B)}for(var K=(e=f.values)!==null&&e!==void 0?e:[],V=function(q){var ee=q.id,$={uniqueId:(0,s.RandomGUID)(),name:ee,_connectionType:0,connectedPointIds:[]};if(g.dataInputs.push($),q.value!==void 0){var O=v(q,n,"/extensions/KHR_interactivity/nodes/".concat(d));a._connectionValues[$.uniqueId]=O}else if(q.node!==void 0&&q.socket!==void 0){var b=q.node,x=q.socket,p=c[b];if(!p)throw new Error("/extensions/KHR_interactivity/nodes/".concat(d,": Could not find node with id ").concat(b," that connects its output with node").concat(d,"'s input ").concat(ee));var _=p.dataOutputs.find(function(y){return y.name===x});_||(_={uniqueId:(0,s.RandomGUID)(),name:x,_connectionType:1,connectedPointIds:[]},p.dataOutputs.push(_)),$.connectedPointIds.push(_.uniqueId),_.connectedPointIds.push($.uniqueId)}else throw new Error("/extensions/KHR_interactivity/nodes/".concat(d,": Invalid socket ").concat(ee," in node ").concat(d))},j=0,z=K;j<z.length;j++){var Z=z[j];V(Z)}}for(var Q=(r=n.variables)!==null&&r!==void 0?r:[],d=0;d<Q.length;d++){var k=Q[d],oe=k.id;a._userVariables[oe]=v(k,n,"/extensions/KHR_interactivity/variables/".concat(d))}return{allBlocks:c,executionContexts:o}}},"../../../dev/loaders/src/glTF/2.0/Extensions/interactivityPathToObjectConverter.ts":(N,E,h)=>{h.r(E),h.d(E,{InteractivityPathToObjectConverter:()=>v});var s=h("../../../../node_modules/tslib/tslib.es6.mjs"),u=h("../../../dev/loaders/src/glTF/2.0/Extensions/gltfPathToObjectConverter.ts"),v=function(i){(0,s.__extends)(n,i);function n(t){return i.call(this,t,l)||this}return n}(u.GLTFPathToObjectConverter),m={__array__:{__target__:!0,translation:{type:"Vector3",get:function(i){var n=i._babylonTransformNode;return n.position},set:function(i,n){var t=n._babylonTransformNode;t.position=i},getObject:function(i){return i._babylonTransformNode}}}},l={nodes:m}},"../../../dev/loaders/src/glTF/2.0/Extensions/interactivityUtils.ts":(N,E,h)=>{h.r(E),h.d(E,{gltfToFlowGraphTypeMap:()=>u,gltfTypeToBabylonType:()=>v});var s=h("babylonjs/Misc/observable"),u={"lifecycle/onStart":s.FlowGraphSceneReadyEventBlock.ClassName,"lifecycle/onTick":s.FlowGraphSceneTickEventBlock.ClassName,log:s.FlowGraphConsoleLogBlock.ClassName,"flow/delay":s.FlowGraphTimerBlock.ClassName,"customEvent/send":s.FlowGraphSendCustomEventBlock.ClassName,"customEvent/receive":s.FlowGraphReceiveCustomEventBlock.ClassName,"flow/sequence":s.FlowGraphSequenceBlock.ClassName,"world/get":s.FlowGraphGetPropertyBlock.ClassName,"world/set":s.FlowGraphSetPropertyBlock.ClassName,"flow/doN":s.FlowGraphDoNBlock.ClassName,"variable/get":s.FlowGraphGetVariableBlock.ClassName,"variable/set":s.FlowGraphSetVariableBlock.ClassName,"flow/whileLoop":s.FlowGraphWhileLoopBlock.ClassName,"math/random":s.FlowGraphRandomBlock.ClassName,"math/e":s.FlowGraphEBlock.ClassName,"math/pi":s.FlowGraphPiBlock.ClassName,"math/inf":s.FlowGraphInfBlock.ClassName,"math/nan":s.FlowGraphNaNBlock.ClassName,"math/abs":s.FlowGraphAbsBlock.ClassName,"math/sign":s.FlowGraphSignBlock.ClassName,"math/trunc":s.FlowGraphTruncBlock.ClassName,"math/floor":s.FlowGraphFloorBlock.ClassName,"math/ceil":s.FlowGraphCeilBlock.ClassName,"math/fract":s.FlowGraphFractBlock.ClassName,"math/neg":s.FlowGraphNegBlock.ClassName,"math/add":s.FlowGraphAddBlock.ClassName,"math/sub":s.FlowGraphSubtractBlock.ClassName,"math/mul":s.FlowGraphMultiplyBlock.ClassName,"math/div":s.FlowGraphDivideBlock.ClassName,"math/rem":s.FlowGraphRemainderBlock.ClassName,"math/min":s.FlowGraphMinBlock.ClassName,"math/max":s.FlowGraphMaxBlock.ClassName,"math/clamp":s.FlowGraphClampBlock.ClassName,"math/saturate":s.FlowGraphSaturateBlock.ClassName,"math/mix":s.FlowGraphInterpolateBlock.ClassName,"math/eq":s.FlowGraphEqBlock.ClassName,"math/lt":s.FlowGraphLessThanBlock.ClassName,"math/le":s.FlowGraphLessThanOrEqualBlock.ClassName,"math/gt":s.FlowGraphGreaterThanBlock.ClassName,"math/ge":s.FlowGraphGreaterThanOrEqualBlock.ClassName,"math/isnan":s.FlowGraphIsNanBlock.ClassName,"math/isinf":s.FlowGraphIsInfBlock.ClassName,"math/rad":s.FlowGraphDegToRadBlock.ClassName,"math/deg":s.FlowGraphRadToDegBlock.ClassName,"math/sin":s.FlowGraphSinBlock.ClassName,"math/cos":s.FlowGraphCosBlock.ClassName,"math/tan":s.FlowGraphTanBlock.ClassName,"math/asin":s.FlowGraphAsinBlock.ClassName,"math/acos":s.FlowGraphAcosBlock.ClassName,"math/atan":s.FlowGraphAtanBlock.ClassName,"math/atan2":s.FlowGraphAtan2Block.ClassName,"math/sinh":s.FlowGraphSinhBlock.ClassName,"math/cosh":s.FlowGraphCoshBlock.ClassName,"math/tanh":s.FlowGraphTanhBlock.ClassName,"math/asinh":s.FlowGraphAsinhBlock.ClassName,"math/acosh":s.FlowGraphAcoshBlock.ClassName,"math/atanh":s.FlowGraphAtanhBlock.ClassName,"math/exp":s.FlowGraphExpBlock.ClassName,"math/log":s.FlowGraphLogBlock.ClassName,"math/log2":s.FlowGraphLog2Block.ClassName,"math/log10":s.FlowGraphLog10Block.ClassName,"math/sqrt":s.FlowGraphSqrtBlock.ClassName,"math/cbrt":s.FlowGraphCubeRootBlock.ClassName,"math/pow":s.FlowGraphPowBlock.ClassName,"math/length":s.FlowGraphLengthBlock.ClassName,"math/normalize":s.FlowGraphNormalizeBlock.ClassName,"math/dot":s.FlowGraphDotBlock.ClassName,"math/cross":s.FlowGraphCrossBlock.ClassName,"math/rotate2d":s.FlowGraphRotate2DBlock.ClassName,"math/rotate3d":s.FlowGraphRotate3DBlock.ClassName,"math/transpose":s.FlowGraphTransposeBlock.ClassName,"math/determinant":s.FlowGraphDeterminantBlock.ClassName,"math/inverse":s.FlowGraphInvertMatrixBlock.ClassName,"math/matmul":s.FlowGraphMatMulBlock.ClassName,"math/not":s.FlowGraphBitwiseNotBlock.ClassName,"math/and":s.FlowGraphBitwiseAndBlock.ClassName,"math/or":s.FlowGraphBitwiseOrBlock.ClassName,"math/xor":s.FlowGraphBitwiseXorBlock.ClassName,"math/asr":s.FlowGraphBitwiseRightShiftBlock.ClassName,"math/lsl":s.FlowGraphBitwiseLeftShiftBlock.ClassName,"math/clz":s.FlowGraphCountLeadingZerosBlock.ClassName,"math/ctz":s.FlowGraphCountTrailingZerosBlock.ClassName,"math/popcnt":s.FlowGraphCountOneBitsBlock.ClassName},v={float2:"Vector2",float3:"Vector3",float4:"Vector4",float4x4:"Matrix",int:"FlowGraphInteger"}},"../../../dev/loaders/src/glTF/2.0/glTFLoader.ts":(N,E,h)=>{h.r(E),h.d(E,{ArrayItem:()=>l,GLTFLoader:()=>i});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/glTFFileLoader.ts"),v=h("../../../dev/loaders/src/glTF/2.0/glTFLoaderAnimation.ts");function m(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=function(r){return r&&typeof r=="object"};return n.reduce(function(r,a){return Object.keys(a).forEach(function(o){var c=r[o],d=a[o];Array.isArray(c)&&Array.isArray(d)?r[o]=c.concat.apply(c,d):e(c)&&e(d)?r[o]=m(c,d):r[o]=d}),r},{})}var l=function(){function n(){}return n.Get=function(t,e,r){if(!e||r==null||!e[r])throw new Error("".concat(t,": Failed to find index (").concat(r,")"));return e[r]},n.TryGet=function(t,e){return!t||e==null||!t[e]?null:t[e]},n.Assign=function(t){if(t)for(var e=0;e<t.length;e++)t[e].index=e},n}(),i=function(){function n(t){this._completePromises=new Array,this._assetContainer=null,this._babylonLights=[],this._disableInstancedMesh=0,this._allMaterialsDirtyRequired=!1,this._extensions=new Array,this._disposed=!1,this._rootUrl=null,this._fileName=null,this._uniqueRootUrl=null,this._bin=null,this._rootBabylonMesh=null,this._defaultBabylonMaterialData={},this._postSceneLoadActions=new Array,this._parent=t}return n.RegisterExtension=function(t,e){n.UnregisterExtension(t)&&s.Logger.Warn("Extension with the name '".concat(t,"' already exists")),n._RegisteredExtensions[t]={factory:e}},n.UnregisterExtension=function(t){return n._RegisteredExtensions[t]?(delete n._RegisteredExtensions[t],!0):!1},Object.defineProperty(n.prototype,"gltf",{get:function(){if(!this._gltf)throw new Error("glTF JSON is not available");return this._gltf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bin",{get:function(){return this._bin},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"babylonScene",{get:function(){if(!this._babylonScene)throw new Error("Scene is not available");return this._babylonScene},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rootBabylonMesh",{get:function(){return this._rootBabylonMesh},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rootUrl",{get:function(){return this._rootUrl},enumerable:!1,configurable:!0}),n.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._completePromises.length=0,this._extensions.forEach(function(t){return t.dispose&&t.dispose()}),this._extensions.length=0,this._gltf=null,this._bin=null,this._babylonScene=null,this._rootBabylonMesh=null,this._defaultBabylonMaterialData={},this._postSceneLoadActions.length=0,this._parent.dispose())},n.prototype.importMeshAsync=function(t,e,r,a,o,c,d){var f=this;return d===void 0&&(d=""),Promise.resolve().then(function(){f._babylonScene=e,f._assetContainer=r,f._loadData(a);var T=null;if(t){var g={};if(f._gltf.nodes)for(var F=0,M=f._gltf.nodes;F<M.length;F++){var C=M[F];C.name&&(g[C.name]=C.index)}var R=t instanceof Array?t:[t];T=R.map(function(B){var K=g[B];if(K===void 0)throw new Error("Failed to find node '".concat(B,"'"));return K})}return f._loadAsync(o,d,T,function(){return{meshes:f._getMeshes(),particleSystems:[],skeletons:f._getSkeletons(),animationGroups:f._getAnimationGroups(),lights:f._babylonLights,transformNodes:f._getTransformNodes(),geometries:f._getGeometries(),spriteManagers:[]}})})},n.prototype.loadAsync=function(t,e,r,a,o){var c=this;return o===void 0&&(o=""),Promise.resolve().then(function(){return c._babylonScene=t,c._loadData(e),c._loadAsync(r,o,null,function(){})})},n.prototype._loadAsync=function(t,e,r,a){var o=this;return Promise.resolve().then(function(){o._rootUrl=t,o._uniqueRootUrl=!t.startsWith("file:")&&e?t:"".concat(t).concat(Date.now(),"/"),o._fileName=e,o._allMaterialsDirtyRequired=!1,o._loadExtensions(),o._checkExtensions();var c="".concat(u.GLTFLoaderState[u.GLTFLoaderState.LOADING]," => ").concat(u.GLTFLoaderState[u.GLTFLoaderState.READY]),d="".concat(u.GLTFLoaderState[u.GLTFLoaderState.LOADING]," => ").concat(u.GLTFLoaderState[u.GLTFLoaderState.COMPLETE]);o._parent._startPerformanceCounter(c),o._parent._startPerformanceCounter(d),o._parent._setState(u.GLTFLoaderState.LOADING),o._extensionsOnLoading();var f=new Array,T=o._babylonScene.blockMaterialDirtyMechanism;if(o._babylonScene.blockMaterialDirtyMechanism=!0,!o.parent.loadOnlyMaterials){if(r)f.push(o.loadSceneAsync("/nodes",{nodes:r,index:-1}));else if(o._gltf.scene!=null||o._gltf.scenes&&o._gltf.scenes[0]){var g=l.Get("/scene",o._gltf.scenes,o._gltf.scene||0);f.push(o.loadSceneAsync("/scenes/".concat(g.index),g))}}if(!o.parent.skipMaterials&&o.parent.loadAllMaterials&&o._gltf.materials)for(var F=0;F<o._gltf.materials.length;++F){var M=o._gltf.materials[F],C="/materials/"+F,R=s.Material.TriangleFillMode;f.push(o._loadMaterialAsync(C,M,null,R,function(){}))}o._allMaterialsDirtyRequired?o._babylonScene.blockMaterialDirtyMechanism=T:o._babylonScene._forceBlockMaterialDirtyMechanism(T),o._parent.compileMaterials&&f.push(o._compileMaterialsAsync()),o._parent.compileShadowGenerators&&f.push(o._compileShadowGeneratorsAsync());var B=Promise.all(f).then(function(){return o._rootBabylonMesh&&o._rootBabylonMesh!==o._parent.customRootNode&&o._rootBabylonMesh.setEnabled(!0),o._extensionsOnReady(),o._parent._setState(u.GLTFLoaderState.READY),o._startAnimations(),a()});return B.then(function(K){return o._parent._endPerformanceCounter(c),s.Tools.SetImmediate(function(){o._disposed||Promise.all(o._completePromises).then(function(){o._parent._endPerformanceCounter(d),o._parent._setState(u.GLTFLoaderState.COMPLETE),o._parent.onCompleteObservable.notifyObservers(void 0),o._parent.onCompleteObservable.clear(),o.dispose()},function(V){o._parent.onErrorObservable.notifyObservers(V),o._parent.onErrorObservable.clear(),o.dispose()})}),K})}).catch(function(c){throw o._disposed||(o._parent.onErrorObservable.notifyObservers(c),o._parent.onErrorObservable.clear(),o.dispose()),c})},n.prototype._loadData=function(t){if(this._gltf=t.json,this._setupData(),t.bin){var e=this._gltf.buffers;if(e&&e[0]&&!e[0].uri){var r=e[0];(r.byteLength<t.bin.byteLength-3||r.byteLength>t.bin.byteLength)&&s.Logger.Warn("Binary buffer length (".concat(r.byteLength,") from JSON does not match chunk length (").concat(t.bin.byteLength,")")),this._bin=t.bin}else s.Logger.Warn("Unexpected BIN chunk")}},n.prototype._setupData=function(){if(l.Assign(this._gltf.accessors),l.Assign(this._gltf.animations),l.Assign(this._gltf.buffers),l.Assign(this._gltf.bufferViews),l.Assign(this._gltf.cameras),l.Assign(this._gltf.images),l.Assign(this._gltf.materials),l.Assign(this._gltf.meshes),l.Assign(this._gltf.nodes),l.Assign(this._gltf.samplers),l.Assign(this._gltf.scenes),l.Assign(this._gltf.skins),l.Assign(this._gltf.textures),this._gltf.nodes){for(var t={},e=0,r=this._gltf.nodes;e<r.length;e++){var a=r[e];if(a.children)for(var o=0,c=a.children;o<c.length;o++){var d=c[o];t[d]=a.index}}for(var f=this._createRootNode(),T=0,g=this._gltf.nodes;T<g.length;T++){var a=g[T],F=t[a.index];a.parent=F===void 0?f:this._gltf.nodes[F]}}},n.prototype._loadExtensions=function(){for(var t in n._RegisteredExtensions){var e=n._RegisteredExtensions[t].factory(this);e.name!==t&&s.Logger.Warn("The name of the glTF loader extension instance does not match the registered name: ".concat(e.name," !== ").concat(t)),this._extensions.push(e),this._parent.onExtensionLoadedObservable.notifyObservers(e)}this._extensions.sort(function(r,a){return(r.order||Number.MAX_VALUE)-(a.order||Number.MAX_VALUE)}),this._parent.onExtensionLoadedObservable.clear()},n.prototype._checkExtensions=function(){if(this._gltf.extensionsRequired)for(var t=function(c){var d=e._extensions.some(function(f){return f.name===c&&f.enabled});if(!d)throw new Error("Required extension ".concat(c," is not available"))},e=this,r=0,a=this._gltf.extensionsRequired;r<a.length;r++){var o=a[r];t(o)}},n.prototype._createRootNode=function(){if(this._parent.customRootNode!==void 0)return this._rootBabylonMesh=this._parent.customRootNode,{_babylonTransformNode:this._rootBabylonMesh===null?void 0:this._rootBabylonMesh,index:-1};this._babylonScene._blockEntityCollection=!!this._assetContainer;var t=new s.Mesh("__root__",this._babylonScene);this._rootBabylonMesh=t,this._rootBabylonMesh._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,this._rootBabylonMesh.setEnabled(!1);var e={_babylonTransformNode:this._rootBabylonMesh,index:-1};switch(this._parent.coordinateSystemMode){case u.GLTFLoaderCoordinateSystemMode.AUTO:{this._babylonScene.useRightHandedSystem||(e.rotation=[0,1,0,0],e.scale=[1,1,-1],n._LoadTransform(e,this._rootBabylonMesh));break}case u.GLTFLoaderCoordinateSystemMode.FORCE_RIGHT_HANDED:{this._babylonScene.useRightHandedSystem=!0;break}default:throw new Error("Invalid coordinate system mode (".concat(this._parent.coordinateSystemMode,")"))}return this._parent.onMeshLoadedObservable.notifyObservers(t),e},n.prototype.loadSceneAsync=function(t,e){var r=this,a=this._extensionsLoadSceneAsync(t,e);if(a)return a;var o=new Array;if(this.logOpen("".concat(t," ").concat(e.name||"")),e.nodes)for(var c=0,d=e.nodes;c<d.length;c++){var f=d[c],T=l.Get("".concat(t,"/nodes/").concat(f),this._gltf.nodes,f);o.push(this.loadNodeAsync("/nodes/".concat(T.index),T,function(C){C.parent=r._rootBabylonMesh}))}for(var g=0,F=this._postSceneLoadActions;g<F.length;g++){var M=F[g];M()}return o.push(this._loadAnimationsAsync()),this.logClose(),Promise.all(o).then(function(){})},n.prototype._forEachPrimitive=function(t,e){if(t._primitiveBabylonMeshes)for(var r=0,a=t._primitiveBabylonMeshes;r<a.length;r++){var o=a[r];e(o)}},n.prototype._getGeometries=function(){var t=[],e=this._gltf.nodes;if(e)for(var r=0,a=e;r<a.length;r++){var o=a[r];this._forEachPrimitive(o,function(c){var d=c.geometry;d&&t.indexOf(d)===-1&&t.push(d)})}return t},n.prototype._getMeshes=function(){var t=[];this._rootBabylonMesh instanceof s.AbstractMesh&&t.push(this._rootBabylonMesh);var e=this._gltf.nodes;if(e)for(var r=0,a=e;r<a.length;r++){var o=a[r];this._forEachPrimitive(o,function(c){t.push(c)})}return t},n.prototype._getTransformNodes=function(){var t=[],e=this._gltf.nodes;if(e)for(var r=0,a=e;r<a.length;r++){var o=a[r];o._babylonTransformNode&&o._babylonTransformNode.getClassName()==="TransformNode"&&t.push(o._babylonTransformNode),o._babylonTransformNodeForSkin&&t.push(o._babylonTransformNodeForSkin)}return t},n.prototype._getSkeletons=function(){var t=[],e=this._gltf.skins;if(e)for(var r=0,a=e;r<a.length;r++){var o=a[r];o._data&&t.push(o._data.babylonSkeleton)}return t},n.prototype._getAnimationGroups=function(){var t=[],e=this._gltf.animations;if(e)for(var r=0,a=e;r<a.length;r++){var o=a[r];o._babylonAnimationGroup&&t.push(o._babylonAnimationGroup)}return t},n.prototype._startAnimations=function(){switch(this._parent.animationStartMode){case u.GLTFLoaderAnimationStartMode.NONE:break;case u.GLTFLoaderAnimationStartMode.FIRST:{var t=this._getAnimationGroups();t.length!==0&&t[0].start(!0);break}case u.GLTFLoaderAnimationStartMode.ALL:{for(var t=this._getAnimationGroups(),e=0,r=t;e<r.length;e++){var a=r[e];a.start(!0)}break}default:{s.Logger.Error("Invalid animation start mode (".concat(this._parent.animationStartMode,")"));return}}},n.prototype.loadNodeAsync=function(t,e,r){var a=this;r===void 0&&(r=function(){});var o=this._extensionsLoadNodeAsync(t,e,r);if(o)return o;if(e._babylonTransformNode)throw new Error("".concat(t,": Invalid recursive node hierarchy"));var c=new Array;this.logOpen("".concat(t," ").concat(e.name||""));var d=function(F){if(n.AddPointerMetadata(F,t),n._LoadTransform(e,F),e.camera!=null){var M=l.Get("".concat(t,"/camera"),a._gltf.cameras,e.camera);c.push(a.loadCameraAsync("/cameras/".concat(M.index),M,function(V){V.parent=F}))}if(e.children)for(var C=0,R=e.children;C<R.length;C++){var B=R[C],K=l.Get("".concat(t,"/children/").concat(B),a._gltf.nodes,B);c.push(a.loadNodeAsync("/nodes/".concat(K.index),K,function(V){V.parent=F}))}r(F)};if(e.mesh==null||e.skin!=null){var f=e.name||"node".concat(e.index);this._babylonScene._blockEntityCollection=!!this._assetContainer;var T=new s.TransformNode(f,this._babylonScene);T._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,e.mesh==null?e._babylonTransformNode=T:e._babylonTransformNodeForSkin=T,d(T)}if(e.mesh!=null)if(e.skin==null){var g=l.Get("".concat(t,"/mesh"),this._gltf.meshes,e.mesh);c.push(this._loadMeshAsync("/meshes/".concat(g.index),e,g,d))}else{var g=l.Get("".concat(t,"/mesh"),this._gltf.meshes,e.mesh);c.push(this._loadMeshAsync("/meshes/".concat(g.index),e,g,function(M){var C=e._babylonTransformNodeForSkin;M.metadata=m(C.metadata,M.metadata||{});var R=l.Get("".concat(t,"/skin"),a._gltf.skins,e.skin);c.push(a._loadSkinAsync("/skins/".concat(R.index),e,R,function(B){a._forEachPrimitive(e,function(K){K.skeleton=B}),a._postSceneLoadActions.push(function(){if(R.skeleton!=null){var K=l.Get("/skins/".concat(R.index,"/skeleton"),a._gltf.nodes,R.skeleton).parent;e.index===K.index?M.parent=C.parent:M.parent=K._babylonTransformNode}else M.parent=a._rootBabylonMesh;a._parent.onSkinLoadedObservable.notifyObservers({node:C,skinnedNode:M})})}))}))}return this.logClose(),Promise.all(c).then(function(){return a._forEachPrimitive(e,function(F){F.geometry&&F.geometry.useBoundingInfoFromGeometry?F._updateBoundingInfo():F.refreshBoundingInfo(!0,!0)}),e._babylonTransformNode})},n.prototype._loadMeshAsync=function(t,e,r,a){var o=r.primitives;if(!o||!o.length)throw new Error("".concat(t,": Primitives are missing"));o[0].index==null&&l.Assign(o);var c=new Array;this.logOpen("".concat(t," ").concat(r.name||""));var d=e.name||"node".concat(e.index);if(o.length===1){var f=r.primitives[0];c.push(this._loadMeshPrimitiveAsync("".concat(t,"/primitives/").concat(f.index),d,e,r,f,function(F){e._babylonTransformNode=F,e._primitiveBabylonMeshes=[F]}))}else{this._babylonScene._blockEntityCollection=!!this._assetContainer,e._babylonTransformNode=new s.TransformNode(d,this._babylonScene),e._babylonTransformNode._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,e._primitiveBabylonMeshes=[];for(var T=0,g=o;T<g.length;T++){var f=g[T];c.push(this._loadMeshPrimitiveAsync("".concat(t,"/primitives/").concat(f.index),"".concat(d,"_primitive").concat(f.index),e,r,f,function(M){M.parent=e._babylonTransformNode,e._primitiveBabylonMeshes.push(M)}))}}return a(e._babylonTransformNode),this.logClose(),Promise.all(c).then(function(){return e._babylonTransformNode})},n.prototype._loadMeshPrimitiveAsync=function(t,e,r,a,o,c){var d=this,f=this._extensionsLoadMeshPrimitiveAsync(t,e,r,a,o,c);if(f)return f;this.logOpen("".concat(t));var T=this._disableInstancedMesh===0&&this._parent.createInstances&&r.skin==null&&!a.primitives[0].targets,g,F;if(T&&o._instanceData)this._babylonScene._blockEntityCollection=!!this._assetContainer,g=o._instanceData.babylonSourceMesh.createInstance(e),g._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,F=o._instanceData.promise;else{var M=new Array;this._babylonScene._blockEntityCollection=!!this._assetContainer;var C=new s.Mesh(e,this._babylonScene);C._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,C.sideOrientation=this._babylonScene.useRightHandedSystem?s.Material.CounterClockWiseSideOrientation:s.Material.ClockWiseSideOrientation,this._createMorphTargets(t,r,a,o,C),M.push(this._loadVertexDataAsync(t,o,C).then(function(V){return d._loadMorphTargetsAsync(t,o,C,V).then(function(){d._disposed||(d._babylonScene._blockEntityCollection=!!d._assetContainer,V.applyToMesh(C),V._parentContainer=d._assetContainer,d._babylonScene._blockEntityCollection=!1)})}));var R=n._GetDrawMode(t,o.mode);if(o.material==null){var B=this._defaultBabylonMaterialData[R];B||(B=this._createDefaultMaterial("__GLTFLoader._default",R),this._parent.onMaterialLoadedObservable.notifyObservers(B),this._defaultBabylonMaterialData[R]=B),C.material=B}else if(!this.parent.skipMaterials){var K=l.Get("".concat(t,"/material"),this._gltf.materials,o.material);M.push(this._loadMaterialAsync("/materials/".concat(K.index),K,C,R,function(V){C.material=V}))}F=Promise.all(M),T&&(o._instanceData={babylonSourceMesh:C,promise:F}),g=C}return n.AddPointerMetadata(g,t),this._parent.onMeshLoadedObservable.notifyObservers(g),c(g),this.logClose(),F.then(function(){return g})},n.prototype._loadVertexDataAsync=function(t,e,r){var a=this,o=this._extensionsLoadVertexDataAsync(t,e,r);if(o)return o;var c=e.attributes;if(!c)throw new Error("".concat(t,": Attributes are missing"));var d=new Array,f=new s.Geometry(r.name,this._babylonScene);if(e.indices==null)r.isUnIndexed=!0;else{var T=l.Get("".concat(t,"/indices"),this._gltf.accessors,e.indices);d.push(this._loadIndicesAccessorAsync("/accessors/".concat(T.index),T).then(function(F){f.setIndices(F)}))}var g=function(F,M,C){if(c[F]!=null){r._delayInfo=r._delayInfo||[],r._delayInfo.indexOf(M)===-1&&r._delayInfo.push(M);var R=l.Get("".concat(t,"/attributes/").concat(F),a._gltf.accessors,c[F]);d.push(a._loadVertexAccessorAsync("/accessors/".concat(R.index),R,M).then(function(B){var K,V;if(B.getKind()===s.VertexBuffer.PositionKind&&!a.parent.alwaysComputeBoundingBox&&!r.skeleton&&R.min&&R.max){var j=(K=s.TmpVectors.Vector3[0]).copyFromFloats.apply(K,R.min),z=(V=s.TmpVectors.Vector3[1]).copyFromFloats.apply(V,R.max);if(R.normalized&&R.componentType!==5126){var Z=1;switch(R.componentType){case 5120:Z=127;break;case 5121:Z=255;break;case 5122:Z=32767;break;case 5123:Z=65535;break}var Q=1/Z;j.scaleInPlace(Q),z.scaleInPlace(Q)}f._boundingInfo=new s.BoundingInfo(j,z),f.useBoundingInfoFromGeometry=!0}f.setVerticesBuffer(B,R.count)})),M==s.VertexBuffer.MatricesIndicesExtraKind&&(r.numBoneInfluencers=8),C&&C(R)}};return g("POSITION",s.VertexBuffer.PositionKind),g("NORMAL",s.VertexBuffer.NormalKind),g("TANGENT",s.VertexBuffer.TangentKind),g("TEXCOORD_0",s.VertexBuffer.UVKind),g("TEXCOORD_1",s.VertexBuffer.UV2Kind),g("TEXCOORD_2",s.VertexBuffer.UV3Kind),g("TEXCOORD_3",s.VertexBuffer.UV4Kind),g("TEXCOORD_4",s.VertexBuffer.UV5Kind),g("TEXCOORD_5",s.VertexBuffer.UV6Kind),g("JOINTS_0",s.VertexBuffer.MatricesIndicesKind),g("WEIGHTS_0",s.VertexBuffer.MatricesWeightsKind),g("JOINTS_1",s.VertexBuffer.MatricesIndicesExtraKind),g("WEIGHTS_1",s.VertexBuffer.MatricesWeightsExtraKind),g("COLOR_0",s.VertexBuffer.ColorKind,function(F){F.type==="VEC4"&&(r.hasVertexAlpha=!0)}),Promise.all(d).then(function(){return f})},n.prototype._createMorphTargets=function(t,e,r,a,o){if(a.targets){if(e._numMorphTargets==null)e._numMorphTargets=a.targets.length;else if(a.targets.length!==e._numMorphTargets)throw new Error("".concat(t,": Primitives do not have the same number of targets"));var c=r.extras?r.extras.targetNames:null;this._babylonScene._blockEntityCollection=!!this._assetContainer,o.morphTargetManager=new s.MorphTargetManager(this._babylonScene),o.morphTargetManager._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,o.morphTargetManager.areUpdatesFrozen=!0;for(var d=0;d<a.targets.length;d++){var f=e.weights?e.weights[d]:r.weights?r.weights[d]:0,T=c?c[d]:"morphTarget".concat(d);o.morphTargetManager.addTarget(new s.MorphTarget(T,f,o.getScene()))}}},n.prototype._loadMorphTargetsAsync=function(t,e,r,a){if(!e.targets)return Promise.resolve();for(var o=new Array,c=r.morphTargetManager,d=0;d<c.numTargets;d++){var f=c.getTarget(d);o.push(this._loadMorphTargetVertexDataAsync("".concat(t,"/targets/").concat(d),a,e.targets[d],f))}return Promise.all(o).then(function(){c.areUpdatesFrozen=!1})},n.prototype._loadMorphTargetVertexDataAsync=function(t,e,r,a){var o=this,c=new Array,d=function(f,T,g){if(r[f]!=null){var F=e.getVertexBuffer(T);if(F){var M=l.Get("".concat(t,"/").concat(f),o._gltf.accessors,r[f]);c.push(o._loadFloatAccessorAsync("/accessors/".concat(M.index),M).then(function(C){g(F,C)}))}}};return d("POSITION",s.VertexBuffer.PositionKind,function(f,T){var g=new Float32Array(T.length);f.forEach(T.length,function(F,M){g[M]=T[M]+F}),a.setPositions(g)}),d("NORMAL",s.VertexBuffer.NormalKind,function(f,T){var g=new Float32Array(T.length);f.forEach(g.length,function(F,M){g[M]=T[M]+F}),a.setNormals(g)}),d("TANGENT",s.VertexBuffer.TangentKind,function(f,T){var g=new Float32Array(T.length/3*4),F=0;f.forEach(T.length/3*4,function(M,C){(C+1)%4!==0&&(g[F]=T[F]+M,F++)}),a.setTangents(g)}),Promise.all(c).then(function(){})},n._LoadTransform=function(t,e){if(t.skin==null){var r=s.Vector3.Zero(),a=s.Quaternion.Identity(),o=s.Vector3.One();if(t.matrix){var c=s.Matrix.FromArray(t.matrix);c.decompose(o,a,r)}else t.translation&&(r=s.Vector3.FromArray(t.translation)),t.rotation&&(a=s.Quaternion.FromArray(t.rotation)),t.scale&&(o=s.Vector3.FromArray(t.scale));e.position=r,e.rotationQuaternion=a,e.scaling=o}},n.prototype._loadSkinAsync=function(t,e,r,a){var o=this,c=this._extensionsLoadSkinAsync(t,e,r);if(c)return c;if(r._data)return a(r._data.babylonSkeleton),r._data.promise;var d="skeleton".concat(r.index);this._babylonScene._blockEntityCollection=!!this._assetContainer;var f=new s.Skeleton(r.name||d,d,this._babylonScene);f._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,this._loadBones(t,r,f);var T=this._loadSkinInverseBindMatricesDataAsync(t,r).then(function(g){o._updateBoneMatrices(f,g)});return r._data={babylonSkeleton:f,promise:T},a(f),T},n.prototype._loadBones=function(t,e,r){if(e.skeleton==null||this._parent.alwaysComputeSkeletonRootNode){var a=this._findSkeletonRootNode("".concat(t,"/joints"),e.joints);if(a)if(e.skeleton===void 0)e.skeleton=a.index;else{var o=function(M,C){for(;C.parent;C=C.parent)if(C.parent===M)return!0;return!1},c=l.Get("".concat(t,"/skeleton"),this._gltf.nodes,e.skeleton);c!==a&&!o(c,a)&&(s.Logger.Warn("".concat(t,"/skeleton: Overriding with nearest common ancestor as skeleton node is not a common root")),e.skeleton=a.index)}else s.Logger.Warn("".concat(t,": Failed to find common root"))}for(var d={},f=0,T=e.joints;f<T.length;f++){var g=T[f],F=l.Get("".concat(t,"/joints/").concat(g),this._gltf.nodes,g);this._loadBone(F,e,r,d)}},n.prototype._findSkeletonRootNode=function(t,e){if(e.length===0)return null;for(var r={},a=0,o=e;a<o.length;a++){for(var c=o[a],d=[],f=l.Get("".concat(t,"/").concat(c),this._gltf.nodes,c);f.index!==-1;)d.unshift(f),f=f.parent;r[c]=d}for(var T=null,g=0;;++g){var d=r[e[0]];if(g>=d.length)return T;for(var f=d[g],F=1;F<e.length;++F)if(d=r[e[F]],g>=d.length||f!==d[g])return T;T=f}},n.prototype._loadBone=function(t,e,r,a){var o=a[t.index];if(o)return o;var c=null;t.index!==e.skeleton&&(t.parent&&t.parent.index!==-1?c=this._loadBone(t.parent,e,r,a):e.skeleton!==void 0&&s.Logger.Warn("/skins/".concat(e.index,"/skeleton: Skeleton node is not a common root")));var d=e.joints.indexOf(t.index);return o=new s.Bone(t.name||"joint".concat(t.index),r,c,this._getNodeMatrix(t),null,null,d),a[t.index]=o,this._postSceneLoadActions.push(function(){o.linkTransformNode(t._babylonTransformNode)}),o},n.prototype._loadSkinInverseBindMatricesDataAsync=function(t,e){if(e.inverseBindMatrices==null)return Promise.resolve(null);var r=l.Get("".concat(t,"/inverseBindMatrices"),this._gltf.accessors,e.inverseBindMatrices);return this._loadFloatAccessorAsync("/accessors/".concat(r.index),r)},n.prototype._updateBoneMatrices=function(t,e){for(var r=0,a=t.bones;r<a.length;r++){var o=a[r],c=s.Matrix.Identity(),d=o._index;e&&d!==-1&&(s.Matrix.FromArrayToRef(e,d*16,c),c.invertToRef(c));var f=o.getParent();f&&c.multiplyToRef(f.getAbsoluteInverseBindMatrix(),c),o.updateMatrix(c,!1,!1),o._updateAbsoluteBindMatrices(void 0,!1)}},n.prototype._getNodeMatrix=function(t){return t.matrix?s.Matrix.FromArray(t.matrix):s.Matrix.Compose(t.scale?s.Vector3.FromArray(t.scale):s.Vector3.One(),t.rotation?s.Quaternion.FromArray(t.rotation):s.Quaternion.Identity(),t.translation?s.Vector3.FromArray(t.translation):s.Vector3.Zero())},n.prototype.loadCameraAsync=function(t,e,r){r===void 0&&(r=function(){});var a=this._extensionsLoadCameraAsync(t,e,r);if(a)return a;var o=new Array;this.logOpen("".concat(t," ").concat(e.name||"")),this._babylonScene._blockEntityCollection=!!this._assetContainer;var c=new s.FreeCamera(e.name||"camera".concat(e.index),s.Vector3.Zero(),this._babylonScene,!1);switch(c._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,c.ignoreParentScaling=!0,e._babylonCamera=c,c.rotation.set(0,Math.PI,0),e.type){case"perspective":{var d=e.perspective;if(!d)throw new Error("".concat(t,": Camera perspective properties are missing"));c.fov=d.yfov,c.minZ=d.znear,c.maxZ=d.zfar||0;break}case"orthographic":{if(!e.orthographic)throw new Error("".concat(t,": Camera orthographic properties are missing"));c.mode=s.Camera.ORTHOGRAPHIC_CAMERA,c.orthoLeft=-e.orthographic.xmag,c.orthoRight=e.orthographic.xmag,c.orthoBottom=-e.orthographic.ymag,c.orthoTop=e.orthographic.ymag,c.minZ=e.orthographic.znear,c.maxZ=e.orthographic.zfar;break}default:throw new Error("".concat(t,": Invalid camera type (").concat(e.type,")"))}return n.AddPointerMetadata(c,t),this._parent.onCameraLoadedObservable.notifyObservers(c),r(c),this.logClose(),Promise.all(o).then(function(){return c})},n.prototype._loadAnimationsAsync=function(){var t=this._gltf.animations;if(!t)return Promise.resolve();for(var e=new Array,r=0;r<t.length;r++){var a=t[r];e.push(this.loadAnimationAsync("/animations/".concat(a.index),a).then(function(o){o.targetedAnimations.length===0&&o.dispose()}))}return Promise.all(e).then(function(){})},n.prototype.loadAnimationAsync=function(t,e){var r=this._extensionsLoadAnimationAsync(t,e);if(r)return r;this._babylonScene._blockEntityCollection=!!this._assetContainer;var a=new s.AnimationGroup(e.name||"animation".concat(e.index),this._babylonScene);a._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,e._babylonAnimationGroup=a;var o=new Array;l.Assign(e.channels),l.Assign(e.samplers);for(var c=0,d=e.channels;c<d.length;c++){var f=d[c];o.push(this._loadAnimationChannelAsync("".concat(t,"/channels/").concat(f.index),t,e,f,function(T,g){T.animations=T.animations||[],T.animations.push(g),a.addTargetedAnimation(g,T)}))}return Promise.all(o).then(function(){return a.normalize(0),a})},n.prototype._loadAnimationChannelAsync=function(t,e,r,a,o){var c=this._extensionsLoadAnimationChannelAsync(t,e,r,a,o);if(c)return c;if(a.target.node==null)return Promise.resolve();var d=l.Get("".concat(t,"/target/node"),this._gltf.nodes,a.target.node);if(a.target.path==="weights"&&!d._numMorphTargets||a.target.path!=="weights"&&!d._babylonTransformNode)return Promise.resolve();var f;switch(a.target.path){case"translation":{f=v.nodeAnimationData.translation;break}case"rotation":{f=v.nodeAnimationData.rotation;break}case"scale":{f=v.nodeAnimationData.scale;break}case"weights":{f=v.nodeAnimationData.weights;break}default:throw new Error("".concat(t,"/target/path: Invalid value (").concat(a.target.path,")"))}var T={object:d,info:f};return this._loadAnimationChannelFromTargetInfoAsync(t,e,r,a,T,o)},n.prototype._loadAnimationChannelFromTargetInfoAsync=function(t,e,r,a,o,c){var d=this.parent.targetFps,f=1/d,T=l.Get("".concat(t,"/sampler"),r.samplers,a.sampler);return this._loadAnimationSamplerAsync("".concat(e,"/samplers/").concat(a.sampler),T).then(function(g){for(var F=0,M=o.object,C=o.info,R=0,B=C;R<B.length;R++){var K=B[R],V=K.getStride(M),j=g.input,z=g.output,Z=new Array(j.length),Q=0;switch(g.interpolation){case"STEP":{for(var k=0;k<j.length;k++){var oe=K.getValue(M,z,Q,1);Q+=V,Z[k]={frame:j[k]*d,value:oe,interpolation:1}}break}case"CUBICSPLINE":{for(var k=0;k<j.length;k++){var ue=K.getValue(M,z,Q,f);Q+=V;var oe=K.getValue(M,z,Q,1);Q+=V;var ie=K.getValue(M,z,Q,f);Q+=V,Z[k]={frame:j[k]*d,inTangent:ue,value:oe,outTangent:ie}}break}case"LINEAR":{for(var k=0;k<j.length;k++){var oe=K.getValue(M,z,Q,1);Q+=V,Z[k]={frame:j[k]*d,value:oe}}break}}if(Q>0){var q="".concat(r.name||"animation".concat(r.index),"_channel").concat(a.index,"_").concat(F);K.buildAnimations(M,q,d,Z,function(ee,$){++F,c(ee,$)})}}})},n.prototype._loadAnimationSamplerAsync=function(t,e){if(e._data)return e._data;var r=e.interpolation||"LINEAR";switch(r){case"STEP":case"LINEAR":case"CUBICSPLINE":break;default:throw new Error("".concat(t,"/interpolation: Invalid value (").concat(e.interpolation,")"))}var a=l.Get("".concat(t,"/input"),this._gltf.accessors,e.input),o=l.Get("".concat(t,"/output"),this._gltf.accessors,e.output);return e._data=Promise.all([this._loadFloatAccessorAsync("/accessors/".concat(a.index),a),this._loadFloatAccessorAsync("/accessors/".concat(o.index),o)]).then(function(c){var d=c[0],f=c[1];return{input:d,interpolation:r,output:f}}),e._data},n.prototype.loadBufferAsync=function(t,e,r,a){var o=this._extensionsLoadBufferAsync(t,e,r,a);if(o)return o;if(!e._data)if(e.uri)e._data=this.loadUriAsync("".concat(t,"/uri"),e,e.uri);else{if(!this._bin)throw new Error("".concat(t,": Uri is missing or the binary glTF is missing its binary chunk"));e._data=this._bin.readAsync(0,e.byteLength)}return e._data.then(function(c){try{return new Uint8Array(c.buffer,c.byteOffset+r,a)}catch(d){throw new Error("".concat(t,": ").concat(d.message))}})},n.prototype.loadBufferViewAsync=function(t,e){var r=this._extensionsLoadBufferViewAsync(t,e);if(r)return r;if(e._data)return e._data;var a=l.Get("".concat(t,"/buffer"),this._gltf.buffers,e.buffer);return e._data=this.loadBufferAsync("/buffers/".concat(a.index),a,e.byteOffset||0,e.byteLength),e._data},n.prototype._loadAccessorAsync=function(t,e,r){var a=this;if(e._data)return e._data;var o=n._GetNumComponents(t,e.type),c=o*s.VertexBuffer.GetTypeByteLength(e.componentType),d=o*e.count;if(e.bufferView==null)e._data=Promise.resolve(new r(d));else{var f=l.Get("".concat(t,"/bufferView"),this._gltf.bufferViews,e.bufferView);e._data=this.loadBufferViewAsync("/bufferViews/".concat(f.index),f).then(function(g){if(e.componentType===5126&&!e.normalized&&(!f.byteStride||f.byteStride===c))return n._GetTypedArray(t,e.componentType,g,e.byteOffset,d);var F=new r(d);return s.VertexBuffer.ForEach(g,e.byteOffset||0,f.byteStride||c,o,e.componentType,F.length,e.normalized||!1,function(M,C){F[C]=M}),F})}if(e.sparse){var T=e.sparse;e._data=e._data.then(function(g){var F=g,M=l.Get("".concat(t,"/sparse/indices/bufferView"),a._gltf.bufferViews,T.indices.bufferView),C=l.Get("".concat(t,"/sparse/values/bufferView"),a._gltf.bufferViews,T.values.bufferView);return Promise.all([a.loadBufferViewAsync("/bufferViews/".concat(M.index),M),a.loadBufferViewAsync("/bufferViews/".concat(C.index),C)]).then(function(R){var B=R[0],K=R[1],V=n._GetTypedArray("".concat(t,"/sparse/indices"),T.indices.componentType,B,T.indices.byteOffset,T.count),j=o*T.count,z;if(e.componentType===5126&&!e.normalized)z=n._GetTypedArray("".concat(t,"/sparse/values"),e.componentType,K,T.values.byteOffset,j);else{var Z=n._GetTypedArray("".concat(t,"/sparse/values"),e.componentType,K,T.values.byteOffset,j);z=new r(j),s.VertexBuffer.ForEach(Z,0,c,o,e.componentType,z.length,e.normalized||!1,function(ie,q){z[q]=ie})}for(var Q=0,k=0;k<V.length;k++)for(var oe=V[k]*o,ue=0;ue<o;ue++)F[oe++]=z[Q++];return F})})}return e._data},n.prototype._loadFloatAccessorAsync=function(t,e){return this._loadAccessorAsync(t,e,Float32Array)},n.prototype._loadIndicesAccessorAsync=function(t,e){if(e.type!=="SCALAR")throw new Error("".concat(t,"/type: Invalid value ").concat(e.type));if(e.componentType!==5121&&e.componentType!==5123&&e.componentType!==5125)throw new Error("".concat(t,"/componentType: Invalid value ").concat(e.componentType));if(e._data)return e._data;if(e.sparse){var r=n._GetTypedArrayConstructor("".concat(t,"/componentType"),e.componentType);e._data=this._loadAccessorAsync(t,e,r)}else{var a=l.Get("".concat(t,"/bufferView"),this._gltf.bufferViews,e.bufferView);e._data=this.loadBufferViewAsync("/bufferViews/".concat(a.index),a).then(function(o){return n._GetTypedArray(t,e.componentType,o,e.byteOffset,e.count)})}return e._data},n.prototype._loadVertexBufferViewAsync=function(t){if(t._babylonBuffer)return t._babylonBuffer;var e=this._babylonScene.getEngine();return t._babylonBuffer=this.loadBufferViewAsync("/bufferViews/".concat(t.index),t).then(function(r){return new s.Buffer(e,r,!1)}),t._babylonBuffer},n.prototype._loadVertexAccessorAsync=function(t,e,r){var a;if(!((a=e._babylonVertexBuffer)===null||a===void 0)&&a[r])return e._babylonVertexBuffer[r];e._babylonVertexBuffer||(e._babylonVertexBuffer={});var o=this._babylonScene.getEngine();if(e.sparse||e.bufferView==null)e._babylonVertexBuffer[r]=this._loadFloatAccessorAsync(t,e).then(function(d){return new s.VertexBuffer(o,d,r,!1)});else{var c=l.Get("".concat(t,"/bufferView"),this._gltf.bufferViews,e.bufferView);e._babylonVertexBuffer[r]=this._loadVertexBufferViewAsync(c).then(function(d){var f=n._GetNumComponents(t,e.type);return new s.VertexBuffer(o,d,r,!1,void 0,c.byteStride,void 0,e.byteOffset,f,e.componentType,e.normalized,!0,void 0,!0)})}return e._babylonVertexBuffer[r]},n.prototype._loadMaterialMetallicRoughnessPropertiesAsync=function(t,e,r){if(!(r instanceof s.PBRMaterial))throw new Error("".concat(t,": Material type not supported"));var a=new Array;return e&&(e.baseColorFactor?(r.albedoColor=s.Color3.FromArray(e.baseColorFactor),r.alpha=e.baseColorFactor[3]):r.albedoColor=s.Color3.White(),r.metallic=e.metallicFactor==null?1:e.metallicFactor,r.roughness=e.roughnessFactor==null?1:e.roughnessFactor,e.baseColorTexture&&a.push(this.loadTextureInfoAsync("".concat(t,"/baseColorTexture"),e.baseColorTexture,function(o){o.name="".concat(r.name," (Base Color)"),r.albedoTexture=o})),e.metallicRoughnessTexture&&(e.metallicRoughnessTexture.nonColorData=!0,a.push(this.loadTextureInfoAsync("".concat(t,"/metallicRoughnessTexture"),e.metallicRoughnessTexture,function(o){o.name="".concat(r.name," (Metallic Roughness)"),r.metallicTexture=o})),r.useMetallnessFromMetallicTextureBlue=!0,r.useRoughnessFromMetallicTextureGreen=!0,r.useRoughnessFromMetallicTextureAlpha=!1)),Promise.all(a).then(function(){})},n.prototype._loadMaterialAsync=function(t,e,r,a,o){o===void 0&&(o=function(){});var c=this._extensionsLoadMaterialAsync(t,e,r,a,o);if(c)return c;e._data=e._data||{};var d=e._data[a];if(!d){this.logOpen("".concat(t," ").concat(e.name||""));var f=this.createMaterial(t,e,a);d={babylonMaterial:f,babylonMeshes:[],promise:this.loadMaterialPropertiesAsync(t,e,f)},e._data[a]=d,n.AddPointerMetadata(f,t),this._parent.onMaterialLoadedObservable.notifyObservers(f),this.logClose()}return r&&(d.babylonMeshes.push(r),r.onDisposeObservable.addOnce(function(){var T=d.babylonMeshes.indexOf(r);T!==-1&&d.babylonMeshes.splice(T,1)})),o(d.babylonMaterial),d.promise.then(function(){return d.babylonMaterial})},n.prototype._createDefaultMaterial=function(t,e){this._babylonScene._blockEntityCollection=!!this._assetContainer;var r=new s.PBRMaterial(t,this._babylonScene);return r._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,r.fillMode=e,r.enableSpecularAntiAliasing=!0,r.useRadianceOverAlpha=!this._parent.transparencyAsCoverage,r.useSpecularOverAlpha=!this._parent.transparencyAsCoverage,r.transparencyMode=s.PBRMaterial.PBRMATERIAL_OPAQUE,r.metallic=1,r.roughness=1,r},n.prototype.createMaterial=function(t,e,r){var a=this._extensionsCreateMaterial(t,e,r);if(a)return a;var o=e.name||"material".concat(e.index),c=this._createDefaultMaterial(o,r);return c},n.prototype.loadMaterialPropertiesAsync=function(t,e,r){var a=this._extensionsLoadMaterialPropertiesAsync(t,e,r);if(a)return a;var o=new Array;return o.push(this.loadMaterialBasePropertiesAsync(t,e,r)),e.pbrMetallicRoughness&&o.push(this._loadMaterialMetallicRoughnessPropertiesAsync("".concat(t,"/pbrMetallicRoughness"),e.pbrMetallicRoughness,r)),this.loadMaterialAlphaProperties(t,e,r),Promise.all(o).then(function(){})},n.prototype.loadMaterialBasePropertiesAsync=function(t,e,r){if(!(r instanceof s.PBRMaterial))throw new Error("".concat(t,": Material type not supported"));var a=new Array;return r.emissiveColor=e.emissiveFactor?s.Color3.FromArray(e.emissiveFactor):new s.Color3(0,0,0),e.doubleSided&&(r.backFaceCulling=!1,r.twoSidedLighting=!0),e.normalTexture&&(e.normalTexture.nonColorData=!0,a.push(this.loadTextureInfoAsync("".concat(t,"/normalTexture"),e.normalTexture,function(o){o.name="".concat(r.name," (Normal)"),r.bumpTexture=o})),r.invertNormalMapX=!this._babylonScene.useRightHandedSystem,r.invertNormalMapY=this._babylonScene.useRightHandedSystem,e.normalTexture.scale!=null&&r.bumpTexture&&(r.bumpTexture.level=e.normalTexture.scale),r.forceIrradianceInFragment=!0),e.occlusionTexture&&(e.occlusionTexture.nonColorData=!0,a.push(this.loadTextureInfoAsync("".concat(t,"/occlusionTexture"),e.occlusionTexture,function(o){o.name="".concat(r.name," (Occlusion)"),r.ambientTexture=o})),r.useAmbientInGrayScale=!0,e.occlusionTexture.strength!=null&&(r.ambientTextureStrength=e.occlusionTexture.strength)),e.emissiveTexture&&a.push(this.loadTextureInfoAsync("".concat(t,"/emissiveTexture"),e.emissiveTexture,function(o){o.name="".concat(r.name," (Emissive)"),r.emissiveTexture=o})),Promise.all(a).then(function(){})},n.prototype.loadMaterialAlphaProperties=function(t,e,r){if(!(r instanceof s.PBRMaterial))throw new Error("".concat(t,": Material type not supported"));var a=e.alphaMode||"OPAQUE";switch(a){case"OPAQUE":{r.transparencyMode=s.PBRMaterial.PBRMATERIAL_OPAQUE,r.alpha=1;break}case"MASK":{r.transparencyMode=s.PBRMaterial.PBRMATERIAL_ALPHATEST,r.alphaCutOff=e.alphaCutoff==null?.5:e.alphaCutoff,r.albedoTexture&&(r.albedoTexture.hasAlpha=!0);break}case"BLEND":{r.transparencyMode=s.PBRMaterial.PBRMATERIAL_ALPHABLEND,r.albedoTexture&&(r.albedoTexture.hasAlpha=!0,r.useAlphaFromAlbedoTexture=!0);break}default:throw new Error("".concat(t,"/alphaMode: Invalid value (").concat(e.alphaMode,")"))}},n.prototype.loadTextureInfoAsync=function(t,e,r){var a=this;r===void 0&&(r=function(){});var o=this._extensionsLoadTextureInfoAsync(t,e,r);if(o)return o;if(this.logOpen("".concat(t)),e.texCoord>=6)throw new Error("".concat(t,"/texCoord: Invalid value (").concat(e.texCoord,")"));var c=l.Get("".concat(t,"/index"),this._gltf.textures,e.index);c._textureInfo=e;var d=this._loadTextureAsync("/textures/".concat(e.index),c,function(f){f.coordinatesIndex=e.texCoord||0,n.AddPointerMetadata(f,t),a._parent.onTextureLoadedObservable.notifyObservers(f),r(f)});return this.logClose(),d},n.prototype._loadTextureAsync=function(t,e,r){r===void 0&&(r=function(){});var a=this._extensionsLoadTextureAsync(t,e,r);if(a)return a;this.logOpen("".concat(t," ").concat(e.name||""));var o=e.sampler==null?n.DefaultSampler:l.Get("".concat(t,"/sampler"),this._gltf.samplers,e.sampler),c=l.Get("".concat(t,"/source"),this._gltf.images,e.source),d=this._createTextureAsync(t,o,c,r,void 0,!e._textureInfo.nonColorData);return this.logClose(),d},n.prototype._createTextureAsync=function(t,e,r,a,o,c){var d=this;a===void 0&&(a=function(){});var f=this._loadSampler("/samplers/".concat(e.index),e),T=new Array,g=new s.Deferred;this._babylonScene._blockEntityCollection=!!this._assetContainer;var F={noMipmap:f.noMipMaps,invertY:!1,samplingMode:f.samplingMode,onLoad:function(){d._disposed||g.resolve()},onError:function(C,R){d._disposed||g.reject(new Error("".concat(t,": ").concat(R&&R.message?R.message:C||"Failed to load texture")))},mimeType:r.mimeType,loaderOptions:o,useSRGBBuffer:!!c&&this._parent.useSRGBBuffers},M=new s.Texture(null,this._babylonScene,F);return M._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,T.push(g.promise),T.push(this.loadImageAsync("/images/".concat(r.index),r).then(function(C){var R=r.uri||"".concat(d._fileName,"#image").concat(r.index),B="data:".concat(d._uniqueRootUrl).concat(R);M.updateURL(B,C)})),M.wrapU=f.wrapU,M.wrapV=f.wrapV,a(M),Promise.all(T).then(function(){return M})},n.prototype._loadSampler=function(t,e){return e._data||(e._data={noMipMaps:e.minFilter===9728||e.minFilter===9729,samplingMode:n._GetTextureSamplingMode(t,e),wrapU:n._GetTextureWrapMode("".concat(t,"/wrapS"),e.wrapS),wrapV:n._GetTextureWrapMode("".concat(t,"/wrapT"),e.wrapT)}),e._data},n.prototype.loadImageAsync=function(t,e){if(!e._data){if(this.logOpen("".concat(t," ").concat(e.name||"")),e.uri)e._data=this.loadUriAsync("".concat(t,"/uri"),e,e.uri);else{var r=l.Get("".concat(t,"/bufferView"),this._gltf.bufferViews,e.bufferView);e._data=this.loadBufferViewAsync("/bufferViews/".concat(r.index),r)}this.logClose()}return e._data},n.prototype.loadUriAsync=function(t,e,r){var a=this,o=this._extensionsLoadUriAsync(t,e,r);if(o)return o;if(!n._ValidateUri(r))throw new Error("".concat(t,": '").concat(r,"' is invalid"));if((0,s.IsBase64DataUrl)(r)){var c=new Uint8Array((0,s.DecodeBase64UrlToBinary)(r));return this.log("".concat(t,": Decoded ").concat(r.substr(0,64),"... (").concat(c.length," bytes)")),Promise.resolve(c)}return this.log("".concat(t,": Loading ").concat(r)),this._parent.preprocessUrlAsync(this._rootUrl+r).then(function(d){return new Promise(function(f,T){a._parent._loadFile(a._babylonScene,d,function(g){a._disposed||(a.log("".concat(t,": Loaded ").concat(r," (").concat(g.byteLength," bytes)")),f(new Uint8Array(g)))},!0,function(g){T(new s.LoadFileError("".concat(t,": Failed to load '").concat(r,"'").concat(g?": "+g.status+" "+g.statusText:""),g))})})})},n.AddPointerMetadata=function(t,e){t.metadata=t.metadata||{};var r=t._internalMetadata=t._internalMetadata||{},a=r.gltf=r.gltf||{},o=a.pointers=a.pointers||[];o.push(e)},n._GetTextureWrapMode=function(t,e){switch(e=e??10497,e){case 33071:return s.Texture.CLAMP_ADDRESSMODE;case 33648:return s.Texture.MIRROR_ADDRESSMODE;case 10497:return s.Texture.WRAP_ADDRESSMODE;default:return s.Logger.Warn("".concat(t,": Invalid value (").concat(e,")")),s.Texture.WRAP_ADDRESSMODE}},n._GetTextureSamplingMode=function(t,e){var r=e.magFilter==null?9729:e.magFilter,a=e.minFilter==null?9987:e.minFilter;if(r===9729)switch(a){case 9728:return s.Texture.LINEAR_NEAREST;case 9729:return s.Texture.LINEAR_LINEAR;case 9984:return s.Texture.LINEAR_NEAREST_MIPNEAREST;case 9985:return s.Texture.LINEAR_LINEAR_MIPNEAREST;case 9986:return s.Texture.LINEAR_NEAREST_MIPLINEAR;case 9987:return s.Texture.LINEAR_LINEAR_MIPLINEAR;default:return s.Logger.Warn("".concat(t,"/minFilter: Invalid value (").concat(a,")")),s.Texture.LINEAR_LINEAR_MIPLINEAR}else switch(r!==9728&&s.Logger.Warn("".concat(t,"/magFilter: Invalid value (").concat(r,")")),a){case 9728:return s.Texture.NEAREST_NEAREST;case 9729:return s.Texture.NEAREST_LINEAR;case 9984:return s.Texture.NEAREST_NEAREST_MIPNEAREST;case 9985:return s.Texture.NEAREST_LINEAR_MIPNEAREST;case 9986:return s.Texture.NEAREST_NEAREST_MIPLINEAR;case 9987:return s.Texture.NEAREST_LINEAR_MIPLINEAR;default:return s.Logger.Warn("".concat(t,"/minFilter: Invalid value (").concat(a,")")),s.Texture.NEAREST_NEAREST_MIPNEAREST}},n._GetTypedArrayConstructor=function(t,e){switch(e){case 5120:return Int8Array;case 5121:return Uint8Array;case 5122:return Int16Array;case 5123:return Uint16Array;case 5125:return Uint32Array;case 5126:return Float32Array;default:throw new Error("".concat(t,": Invalid component type ").concat(e))}},n._GetTypedArray=function(t,e,r,a,o){var c=r.buffer;a=r.byteOffset+(a||0);var d=n._GetTypedArrayConstructor("".concat(t,"/componentType"),e),f=s.VertexBuffer.GetTypeByteLength(e);return a%f!==0?(s.Logger.Warn("".concat(t,": Copying buffer as byte offset (").concat(a,") is not a multiple of component type byte length (").concat(f,")")),new d(c.slice(a,a+o*f),0)):new d(c,a,o)},n._GetNumComponents=function(t,e){switch(e){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":return 4;case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}throw new Error("".concat(t,": Invalid type (").concat(e,")"))},n._ValidateUri=function(t){return s.Tools.IsBase64(t)||t.indexOf("..")===-1},n._GetDrawMode=function(t,e){switch(e==null&&(e=4),e){case 0:return s.Material.PointListDrawMode;case 1:return s.Material.LineListDrawMode;case 2:return s.Material.LineLoopDrawMode;case 3:return s.Material.LineStripDrawMode;case 4:return s.Material.TriangleFillMode;case 5:return s.Material.TriangleStripDrawMode;case 6:return s.Material.TriangleFanDrawMode}throw new Error("".concat(t,": Invalid mesh primitive mode (").concat(e,")"))},n.prototype._compileMaterialsAsync=function(){var t=this;this._parent._startPerformanceCounter("Compile materials");var e=new Array;if(this._gltf.materials)for(var r=0,a=this._gltf.materials;r<a.length;r++){var o=a[r];if(o._data)for(var c in o._data)for(var d=o._data[c],f=0,T=d.babylonMeshes;f<T.length;f++){var g=T[f];g.computeWorldMatrix(!0);var F=d.babylonMaterial;e.push(F.forceCompilationAsync(g)),e.push(F.forceCompilationAsync(g,{useInstances:!0})),this._parent.useClipPlane&&(e.push(F.forceCompilationAsync(g,{clipPlane:!0})),e.push(F.forceCompilationAsync(g,{clipPlane:!0,useInstances:!0})))}}return Promise.all(e).then(function(){t._parent._endPerformanceCounter("Compile materials")})},n.prototype._compileShadowGeneratorsAsync=function(){var t=this;this._parent._startPerformanceCounter("Compile shadow generators");for(var e=new Array,r=this._babylonScene.lights,a=0,o=r;a<o.length;a++){var c=o[a],d=c.getShadowGenerator();d&&e.push(d.forceCompilationAsync())}return Promise.all(e).then(function(){t._parent._endPerformanceCounter("Compile shadow generators")})},n.prototype._forEachExtensions=function(t){for(var e=0,r=this._extensions;e<r.length;e++){var a=r[e];a.enabled&&t(a)}},n.prototype._applyExtensions=function(t,e,r){for(var a=0,o=this._extensions;a<o.length;a++){var c=o[a];if(c.enabled){var d="".concat(c.name,".").concat(e),f=t;f._activeLoaderExtensionFunctions=f._activeLoaderExtensionFunctions||{};var T=f._activeLoaderExtensionFunctions;if(!T[d]){T[d]=!0;try{var g=r(c);if(g)return g}finally{delete T[d]}}}}return null},n.prototype._extensionsOnLoading=function(){this._forEachExtensions(function(t){return t.onLoading&&t.onLoading()})},n.prototype._extensionsOnReady=function(){this._forEachExtensions(function(t){return t.onReady&&t.onReady()})},n.prototype._extensionsLoadSceneAsync=function(t,e){return this._applyExtensions(e,"loadScene",function(r){return r.loadSceneAsync&&r.loadSceneAsync(t,e)})},n.prototype._extensionsLoadNodeAsync=function(t,e,r){return this._applyExtensions(e,"loadNode",function(a){return a.loadNodeAsync&&a.loadNodeAsync(t,e,r)})},n.prototype._extensionsLoadCameraAsync=function(t,e,r){return this._applyExtensions(e,"loadCamera",function(a){return a.loadCameraAsync&&a.loadCameraAsync(t,e,r)})},n.prototype._extensionsLoadVertexDataAsync=function(t,e,r){return this._applyExtensions(e,"loadVertexData",function(a){return a._loadVertexDataAsync&&a._loadVertexDataAsync(t,e,r)})},n.prototype._extensionsLoadMeshPrimitiveAsync=function(t,e,r,a,o,c){return this._applyExtensions(o,"loadMeshPrimitive",function(d){return d._loadMeshPrimitiveAsync&&d._loadMeshPrimitiveAsync(t,e,r,a,o,c)})},n.prototype._extensionsLoadMaterialAsync=function(t,e,r,a,o){return this._applyExtensions(e,"loadMaterial",function(c){return c._loadMaterialAsync&&c._loadMaterialAsync(t,e,r,a,o)})},n.prototype._extensionsCreateMaterial=function(t,e,r){return this._applyExtensions(e,"createMaterial",function(a){return a.createMaterial&&a.createMaterial(t,e,r)})},n.prototype._extensionsLoadMaterialPropertiesAsync=function(t,e,r){return this._applyExtensions(e,"loadMaterialProperties",function(a){return a.loadMaterialPropertiesAsync&&a.loadMaterialPropertiesAsync(t,e,r)})},n.prototype._extensionsLoadTextureInfoAsync=function(t,e,r){return this._applyExtensions(e,"loadTextureInfo",function(a){return a.loadTextureInfoAsync&&a.loadTextureInfoAsync(t,e,r)})},n.prototype._extensionsLoadTextureAsync=function(t,e,r){return this._applyExtensions(e,"loadTexture",function(a){return a._loadTextureAsync&&a._loadTextureAsync(t,e,r)})},n.prototype._extensionsLoadAnimationAsync=function(t,e){return this._applyExtensions(e,"loadAnimation",function(r){return r.loadAnimationAsync&&r.loadAnimationAsync(t,e)})},n.prototype._extensionsLoadAnimationChannelAsync=function(t,e,r,a,o){return this._applyExtensions(r,"loadAnimationChannel",function(c){return c._loadAnimationChannelAsync&&c._loadAnimationChannelAsync(t,e,r,a,o)})},n.prototype._extensionsLoadSkinAsync=function(t,e,r){return this._applyExtensions(r,"loadSkin",function(a){return a._loadSkinAsync&&a._loadSkinAsync(t,e,r)})},n.prototype._extensionsLoadUriAsync=function(t,e,r){return this._applyExtensions(e,"loadUri",function(a){return a._loadUriAsync&&a._loadUriAsync(t,e,r)})},n.prototype._extensionsLoadBufferViewAsync=function(t,e){return this._applyExtensions(e,"loadBufferView",function(r){return r.loadBufferViewAsync&&r.loadBufferViewAsync(t,e)})},n.prototype._extensionsLoadBufferAsync=function(t,e,r,a){return this._applyExtensions(e,"loadBuffer",function(o){return o.loadBufferAsync&&o.loadBufferAsync(t,e,r,a)})},n.LoadExtensionAsync=function(t,e,r,a){if(!e.extensions)return null;var o=e.extensions,c=o[r];return c?a("".concat(t,"/extensions/").concat(r),c):null},n.LoadExtraAsync=function(t,e,r,a){if(!e.extras)return null;var o=e.extras,c=o[r];return c?a("".concat(t,"/extras/").concat(r),c):null},n.prototype.isExtensionUsed=function(t){return!!this._gltf.extensionsUsed&&this._gltf.extensionsUsed.indexOf(t)!==-1},n.prototype.logOpen=function(t){this._parent._logOpen(t)},n.prototype.logClose=function(){this._parent._logClose()},n.prototype.log=function(t){this._parent._log(t)},n.prototype.startPerformanceCounter=function(t){this._parent._startPerformanceCounter(t)},n.prototype.endPerformanceCounter=function(t){this._parent._endPerformanceCounter(t)},n._RegisteredExtensions={},n.DefaultSampler={index:-1},n}();u.GLTFFileLoader._CreateGLTF2Loader=function(n){return new i(n)}},"../../../dev/loaders/src/glTF/2.0/glTFLoaderAnimation.ts":(N,E,h)=>{h.r(E),h.d(E,{AnimationPropertyInfo:()=>i,TransformNodeAnimationPropertyInfo:()=>n,WeightAnimationPropertyInfo:()=>t,getQuaternion:()=>m,getVector3:()=>v,getWeights:()=>l,nodeAnimationData:()=>e});var s=h("../../../../node_modules/tslib/tslib.es6.mjs"),u=h("babylonjs/Misc/observable");function v(r,a,o,c){return u.Vector3.FromArray(a,o).scaleInPlace(c)}function m(r,a,o,c){return u.Quaternion.FromArray(a,o).scaleInPlace(c)}function l(r,a,o,c){for(var d=new Array(r._numMorphTargets),f=0;f<d.length;f++)d[f]=a[o++]*c;return d}var i=function(){function r(a,o,c,d){this.type=a,this.name=o,this.getValue=c,this.getStride=d}return r.prototype._buildAnimation=function(a,o,c){var d=new u.Animation(a,this.name,o,this.type);return d.setKeys(c),d},r}(),n=function(r){(0,s.__extends)(a,r);function a(){return r!==null&&r.apply(this,arguments)||this}return a.prototype.buildAnimations=function(o,c,d,f,T){T(o._babylonTransformNode,this._buildAnimation(c,d,f))},a}(i),t=function(r){(0,s.__extends)(a,r);function a(){return r!==null&&r.apply(this,arguments)||this}return a.prototype.buildAnimations=function(o,c,d,f,T){if(o._numMorphTargets)for(var g=function(C){var R=new u.Animation("".concat(c,"_").concat(C),F.name,d,F.type);if(R.setKeys(f.map(function(Z){return{frame:Z.frame,inTangent:Z.inTangent?Z.inTangent[C]:void 0,value:Z.value[C],outTangent:Z.outTangent?Z.outTangent[C]:void 0,interpolation:Z.interpolation}})),o._primitiveBabylonMeshes)for(var B=0,K=o._primitiveBabylonMeshes;B<K.length;B++){var V=K[B];if(V.morphTargetManager){var j=V.morphTargetManager.getTarget(C),z=R.clone();j.animations.push(z),T(j,z)}}},F=this,M=0;M<o._numMorphTargets;M++)g(M)},a}(i),e={translation:[new n(u.Animation.ANIMATIONTYPE_VECTOR3,"position",v,function(){return 3})],rotation:[new n(u.Animation.ANIMATIONTYPE_QUATERNION,"rotationQuaternion",m,function(){return 4})],scale:[new n(u.Animation.ANIMATIONTYPE_VECTOR3,"scaling",v,function(){return 3})],weights:[new t(u.Animation.ANIMATIONTYPE_FLOAT,"influence",l,function(r){return r._numMorphTargets})]}},"../../../dev/loaders/src/glTF/2.0/glTFLoaderExtension.ts":(N,E,h)=>{h.r(E)},"../../../dev/loaders/src/glTF/2.0/glTFLoaderInterfaces.ts":(N,E,h)=>{h.r(E)},"../../../dev/loaders/src/glTF/2.0/index.ts":(N,E,h)=>{h.r(E),h.d(E,{ArrayItem:()=>s.ArrayItem,EXT_lights_image_based:()=>u.EXT_lights_image_based,EXT_mesh_gpu_instancing:()=>u.EXT_mesh_gpu_instancing,EXT_meshopt_compression:()=>u.EXT_meshopt_compression,EXT_texture_avif:()=>u.EXT_texture_avif,EXT_texture_webp:()=>u.EXT_texture_webp,ExtrasAsMetadata:()=>u.ExtrasAsMetadata,GLTFLoader:()=>s.GLTFLoader,KHR_animation_pointer:()=>u.KHR_animation_pointer,KHR_draco_mesh_compression:()=>u.KHR_draco_mesh_compression,KHR_interactivity:()=>u.KHR_interactivity,KHR_lights:()=>u.KHR_lights,KHR_materials_anisotropy:()=>u.KHR_materials_anisotropy,KHR_materials_clearcoat:()=>u.KHR_materials_clearcoat,KHR_materials_diffuse_transmission:()=>u.KHR_materials_diffuse_transmission,KHR_materials_dispersion:()=>u.KHR_materials_dispersion,KHR_materials_emissive_strength:()=>u.KHR_materials_emissive_strength,KHR_materials_ior:()=>u.KHR_materials_ior,KHR_materials_iridescence:()=>u.KHR_materials_iridescence,KHR_materials_pbrSpecularGlossiness:()=>u.KHR_materials_pbrSpecularGlossiness,KHR_materials_sheen:()=>u.KHR_materials_sheen,KHR_materials_specular:()=>u.KHR_materials_specular,KHR_materials_transmission:()=>u.KHR_materials_transmission,KHR_materials_unlit:()=>u.KHR_materials_unlit,KHR_materials_variants:()=>u.KHR_materials_variants,KHR_materials_volume:()=>u.KHR_materials_volume,KHR_mesh_quantization:()=>u.KHR_mesh_quantization,KHR_texture_basisu:()=>u.KHR_texture_basisu,KHR_texture_transform:()=>u.KHR_texture_transform,KHR_xmp_json_ld:()=>u.KHR_xmp_json_ld,MSFT_audio_emitter:()=>u.MSFT_audio_emitter,MSFT_lod:()=>u.MSFT_lod,MSFT_minecraftMesh:()=>u.MSFT_minecraftMesh,MSFT_sRGBFactors:()=>u.MSFT_sRGBFactors});var s=h("../../../dev/loaders/src/glTF/2.0/glTFLoader.ts");h("../../../dev/loaders/src/glTF/2.0/glTFLoaderExtension.ts"),h("../../../dev/loaders/src/glTF/2.0/glTFLoaderInterfaces.ts");var u=h("../../../dev/loaders/src/glTF/2.0/Extensions/index.ts")},"../../../dev/loaders/src/glTF/glTFFileLoader.ts":(N,E,h)=>{h.r(E),h.d(E,{GLTFFileLoader:()=>t,GLTFLoaderAnimationStartMode:()=>i,GLTFLoaderCoordinateSystemMode:()=>l,GLTFLoaderState:()=>n});var s=h("babylonjs/Misc/observable"),u=h("../../../dev/loaders/src/glTF/glTFValidation.ts");function v(e,r,a){try{return Promise.resolve(new Uint8Array(e,r,a))}catch(o){return Promise.reject(o)}}function m(e,r,a){try{if(r<0||r>=e.byteLength)throw new RangeError("Offset is out of range.");if(r+a>e.byteLength)throw new RangeError("Length is out of range.");return Promise.resolve(new Uint8Array(e.buffer,e.byteOffset+r,a))}catch(o){return Promise.reject(o)}}var l;(function(e){e[e.AUTO=0]="AUTO",e[e.FORCE_RIGHT_HANDED=1]="FORCE_RIGHT_HANDED"})(l||(l={}));var i;(function(e){e[e.NONE=0]="NONE",e[e.FIRST=1]="FIRST",e[e.ALL=2]="ALL"})(i||(i={}));var n;(function(e){e[e.LOADING=0]="LOADING",e[e.READY=1]="READY",e[e.COMPLETE=2]="COMPLETE"})(n||(n={}));var t=function(){function e(){this.onParsedObservable=new s.Observable,this.coordinateSystemMode=l.AUTO,this.animationStartMode=i.FIRST,this.compileMaterials=!1,this.useClipPlane=!1,this.compileShadowGenerators=!1,this.transparencyAsCoverage=!1,this.useRangeRequests=!1,this.createInstances=!0,this.alwaysComputeBoundingBox=!1,this.loadAllMaterials=!1,this.loadOnlyMaterials=!1,this.skipMaterials=!1,this.useSRGBBuffers=!0,this.targetFps=60,this.alwaysComputeSkeletonRootNode=!1,this.preprocessUrlAsync=function(r){return Promise.resolve(r)},this.onMeshLoadedObservable=new s.Observable,this.onSkinLoadedObservable=new s.Observable,this.onTextureLoadedObservable=new s.Observable,this.onMaterialLoadedObservable=new s.Observable,this.onCameraLoadedObservable=new s.Observable,this.onCompleteObservable=new s.Observable,this.onErrorObservable=new s.Observable,this.onDisposeObservable=new s.Observable,this.onExtensionLoadedObservable=new s.Observable,this.validate=!1,this.onValidatedObservable=new s.Observable,this._loader=null,this._state=null,this._requests=new Array,this.name="gltf",this.extensions={".gltf":{isBinary:!1},".glb":{isBinary:!0}},this.onLoaderStateChangedObservable=new s.Observable,this._logIndentLevel=0,this._loggingEnabled=!1,this._log=this._logDisabled,this._capturePerformanceCounters=!1,this._startPerformanceCounter=this._startPerformanceCounterDisabled,this._endPerformanceCounter=this._endPerformanceCounterDisabled}return Object.defineProperty(e.prototype,"onParsed",{set:function(r){this._onParsedObserver&&this.onParsedObservable.remove(this._onParsedObserver),this._onParsedObserver=this.onParsedObservable.add(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMeshLoaded",{set:function(r){this._onMeshLoadedObserver&&this.onMeshLoadedObservable.remove(this._onMeshLoadedObserver),this._onMeshLoadedObserver=this.onMeshLoadedObservable.add(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onTextureLoaded",{set:function(r){this._onTextureLoadedObserver&&this.onTextureLoadedObservable.remove(this._onTextureLoadedObserver),this._onTextureLoadedObserver=this.onTextureLoadedObservable.add(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMaterialLoaded",{set:function(r){this._onMaterialLoadedObserver&&this.onMaterialLoadedObservable.remove(this._onMaterialLoadedObserver),this._onMaterialLoadedObserver=this.onMaterialLoadedObservable.add(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCameraLoaded",{set:function(r){this._onCameraLoadedObserver&&this.onCameraLoadedObservable.remove(this._onCameraLoadedObserver),this._onCameraLoadedObserver=this.onCameraLoadedObservable.add(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onComplete",{set:function(r){this._onCompleteObserver&&this.onCompleteObservable.remove(this._onCompleteObserver),this._onCompleteObserver=this.onCompleteObservable.add(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{set:function(r){this._onErrorObserver&&this.onErrorObservable.remove(this._onErrorObserver),this._onErrorObserver=this.onErrorObservable.add(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDispose",{set:function(r){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onExtensionLoaded",{set:function(r){this._onExtensionLoadedObserver&&this.onExtensionLoadedObservable.remove(this._onExtensionLoadedObserver),this._onExtensionLoadedObserver=this.onExtensionLoadedObservable.add(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loggingEnabled",{get:function(){return this._loggingEnabled},set:function(r){this._loggingEnabled!==r&&(this._loggingEnabled=r,this._loggingEnabled?this._log=this._logEnabled:this._log=this._logDisabled)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"capturePerformanceCounters",{get:function(){return this._capturePerformanceCounters},set:function(r){this._capturePerformanceCounters!==r&&(this._capturePerformanceCounters=r,this._capturePerformanceCounters?(this._startPerformanceCounter=this._startPerformanceCounterEnabled,this._endPerformanceCounter=this._endPerformanceCounterEnabled):(this._startPerformanceCounter=this._startPerformanceCounterDisabled,this._endPerformanceCounter=this._endPerformanceCounterDisabled))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onValidated",{set:function(r){this._onValidatedObserver&&this.onValidatedObservable.remove(this._onValidatedObserver),this._onValidatedObserver=this.onValidatedObservable.add(r)},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._loader&&(this._loader.dispose(),this._loader=null);for(var r=0,a=this._requests;r<a.length;r++){var o=a[r];o.abort()}this._requests.length=0,delete this._progressCallback,this.preprocessUrlAsync=function(c){return Promise.resolve(c)},this.onMeshLoadedObservable.clear(),this.onSkinLoadedObservable.clear(),this.onTextureLoadedObservable.clear(),this.onMaterialLoadedObservable.clear(),this.onCameraLoadedObservable.clear(),this.onCompleteObservable.clear(),this.onExtensionLoadedObservable.clear(),this.onDisposeObservable.notifyObservers(void 0),this.onDisposeObservable.clear()},e.prototype.loadFile=function(r,a,o,c,d,f,T,g){var F=this;if(ArrayBuffer.isView(a))return this._loadBinary(r,a,o,c,T,g),null;this._progressCallback=d;var M=a.name||s.Tools.GetFilename(a);if(f){if(this.useRangeRequests){this.validate&&s.Logger.Warn("glTF validation is not supported when range requests are enabled");var C={abort:function(){},onCompleteObservable:new s.Observable},R={readAsync:function(B,K){return new Promise(function(V,j){F._loadFile(r,a,function(z){V(new Uint8Array(z))},!0,function(z){j(z)},function(z){z.setRequestHeader("Range","bytes=".concat(B,"-").concat(B+K-1))})})},byteLength:0};return this._unpackBinaryAsync(new s.DataReader(R)).then(function(B){C.onCompleteObservable.notifyObservers(C),c(B)},T?function(B){return T(void 0,B)}:void 0),C}return this._loadFile(r,a,function(B){F._validate(r,new Uint8Array(B,0,B.byteLength),o,M),F._unpackBinaryAsync(new s.DataReader({readAsync:function(K,V){return v(B,K,V)},byteLength:B.byteLength})).then(function(K){c(K)},T?function(K){return T(void 0,K)}:void 0)},!0,T)}else return this._loadFile(r,a,function(B){try{F._validate(r,B,o,M),c({json:F._parseJson(B)})}catch{T&&T()}},!1,T)},e.prototype._loadBinary=function(r,a,o,c,d,f){this._validate(r,new Uint8Array(a.buffer,a.byteOffset,a.byteLength),o,f),this._unpackBinaryAsync(new s.DataReader({readAsync:function(T,g){return m(a,T,g)},byteLength:a.byteLength})).then(function(T){c(T)},d?function(T){return d(void 0,T)}:void 0)},e.prototype.importMeshAsync=function(r,a,o,c,d,f){var T=this;return Promise.resolve().then(function(){return T.onParsedObservable.notifyObservers(o),T.onParsedObservable.clear(),T._log("Loading ".concat(f||"")),T._loader=T._getLoader(o),T._loader.importMeshAsync(r,a,null,o,c,d,f)})},e.prototype.loadAsync=function(r,a,o,c,d){var f=this;return Promise.resolve().then(function(){return f.onParsedObservable.notifyObservers(a),f.onParsedObservable.clear(),f._log("Loading ".concat(d||"")),f._loader=f._getLoader(a),f._loader.loadAsync(r,a,o,c,d)})},e.prototype.loadAssetContainerAsync=function(r,a,o,c,d){var f=this;return Promise.resolve().then(function(){f.onParsedObservable.notifyObservers(a),f.onParsedObservable.clear(),f._log("Loading ".concat(d||"")),f._loader=f._getLoader(a);var T=new s.AssetContainer(r),g=[];f.onMaterialLoadedObservable.add(function(R){g.push(R)});var F=[];f.onTextureLoadedObservable.add(function(R){F.push(R)});var M=[];f.onCameraLoadedObservable.add(function(R){M.push(R)});var C=[];return f.onMeshLoadedObservable.add(function(R){R.morphTargetManager&&C.push(R.morphTargetManager)}),f._loader.importMeshAsync(null,r,T,a,o,c,d).then(function(R){return Array.prototype.push.apply(T.geometries,R.geometries),Array.prototype.push.apply(T.meshes,R.meshes),Array.prototype.push.apply(T.particleSystems,R.particleSystems),Array.prototype.push.apply(T.skeletons,R.skeletons),Array.prototype.push.apply(T.animationGroups,R.animationGroups),Array.prototype.push.apply(T.materials,g),Array.prototype.push.apply(T.textures,F),Array.prototype.push.apply(T.lights,R.lights),Array.prototype.push.apply(T.transformNodes,R.transformNodes),Array.prototype.push.apply(T.cameras,M),Array.prototype.push.apply(T.morphTargetManagers,C),T})})},e.prototype.canDirectLoad=function(r){return r.indexOf("asset")!==-1&&r.indexOf("version")!==-1||r.startsWith("data:base64,"+e._MagicBase64Encoded)||r.startsWith("data:;base64,"+e._MagicBase64Encoded)||r.startsWith("data:application/octet-stream;base64,"+e._MagicBase64Encoded)||r.startsWith("data:model/gltf-binary;base64,"+e._MagicBase64Encoded)},e.prototype.directLoad=function(r,a){if(a.startsWith("base64,"+e._MagicBase64Encoded)||a.startsWith(";base64,"+e._MagicBase64Encoded)||a.startsWith("application/octet-stream;base64,"+e._MagicBase64Encoded)||a.startsWith("model/gltf-binary;base64,"+e._MagicBase64Encoded)){var o=(0,s.DecodeBase64UrlToBinary)(a);return this._validate(r,new Uint8Array(o,0,o.byteLength)),this._unpackBinaryAsync(new s.DataReader({readAsync:function(c,d){return v(o,c,d)},byteLength:o.byteLength}))}return this._validate(r,a),Promise.resolve({json:this._parseJson(a)})},e.prototype.createPlugin=function(){return new e},Object.defineProperty(e.prototype,"loaderState",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.whenCompleteAsync=function(){var r=this;return new Promise(function(a,o){r.onCompleteObservable.addOnce(function(){a()}),r.onErrorObservable.addOnce(function(c){o(c)})})},e.prototype._setState=function(r){this._state!==r&&(this._state=r,this.onLoaderStateChangedObservable.notifyObservers(this._state),this._log(n[this._state]))},e.prototype._loadFile=function(r,a,o,c,d,f){var T=this,g=r._loadFile(a,o,function(F){T._onProgress(F,g)},!0,c,d,f);return g.onCompleteObservable.add(function(){g._lengthComputable=!0,g._total=g._loaded}),this._requests.push(g),g},e.prototype._onProgress=function(r,a){if(this._progressCallback){a._lengthComputable=r.lengthComputable,a._loaded=r.loaded,a._total=r.total;for(var o=!0,c=0,d=0,f=0,T=this._requests;f<T.length;f++){var g=T[f];if(g._lengthComputable===void 0||g._loaded===void 0||g._total===void 0)return;o=o&&g._lengthComputable,c+=g._loaded,d+=g._total}this._progressCallback({lengthComputable:o,loaded:c,total:o?d:0})}},e.prototype._validate=function(r,a,o,c){var d=this;o===void 0&&(o=""),c===void 0&&(c=""),this.validate&&(this._startPerformanceCounter("Validate JSON"),u.GLTFValidation.ValidateAsync(a,o,c,function(f){return d.preprocessUrlAsync(o+f).then(function(T){return r._loadFileAsync(T,void 0,!0,!0).then(function(g){return new Uint8Array(g,0,g.byteLength)})})}).then(function(f){d._endPerformanceCounter("Validate JSON"),d.onValidatedObservable.notifyObservers(f),d.onValidatedObservable.clear()},function(f){d._endPerformanceCounter("Validate JSON"),s.Tools.Warn("Failed to validate: ".concat(f.message)),d.onValidatedObservable.clear()}))},e.prototype._getLoader=function(r){var a=r.json.asset||{};this._log("Asset version: ".concat(a.version)),a.minVersion&&this._log("Asset minimum version: ".concat(a.minVersion)),a.generator&&this._log("Asset generator: ".concat(a.generator));var o=e._parseVersion(a.version);if(!o)throw new Error("Invalid version: "+a.version);if(a.minVersion!==void 0){var c=e._parseVersion(a.minVersion);if(!c)throw new Error("Invalid minimum version: "+a.minVersion);if(e._compareVersion(c,{major:2,minor:0})>0)throw new Error("Incompatible minimum version: "+a.minVersion)}var d={1:e._CreateGLTF1Loader,2:e._CreateGLTF2Loader},f=d[o.major];if(!f)throw new Error("Unsupported version: "+a.version);return f(this)},e.prototype._parseJson=function(r){this._startPerformanceCounter("Parse JSON"),this._log("JSON length: ".concat(r.length));var a=JSON.parse(r);return this._endPerformanceCounter("Parse JSON"),a},e.prototype._unpackBinaryAsync=function(r){var a=this;return this._startPerformanceCounter("Unpack Binary"),r.loadAsync(20).then(function(){var o={Magic:1179937895},c=r.readUint32();if(c!==o.Magic)throw new s.RuntimeError("Unexpected magic: "+c,s.ErrorCodes.GLTFLoaderUnexpectedMagicError);var d=r.readUint32();a.loggingEnabled&&a._log("Binary version: ".concat(d));var f=r.readUint32();!a.useRangeRequests&&f!==r.buffer.byteLength&&s.Logger.Warn("Length in header does not match actual data length: ".concat(f," != ").concat(r.buffer.byteLength));var T;switch(d){case 1:{T=a._unpackBinaryV1Async(r,f);break}case 2:{T=a._unpackBinaryV2Async(r,f);break}default:throw new Error("Unsupported version: "+d)}return a._endPerformanceCounter("Unpack Binary"),T})},e.prototype._unpackBinaryV1Async=function(r,a){var o={JSON:0},c=r.readUint32(),d=r.readUint32();if(d!==o.JSON)throw new Error("Unexpected content format: ".concat(d));var f=a-r.byteOffset,T={json:this._parseJson(r.readString(c)),bin:null};if(f!==0){var g=r.byteOffset;T.bin={readAsync:function(F,M){return r.buffer.readAsync(g+F,M)},byteLength:f}}return Promise.resolve(T)},e.prototype._unpackBinaryV2Async=function(r,a){var o=this,c={JSON:1313821514,BIN:5130562},d=r.readUint32(),f=r.readUint32();if(f!==c.JSON)throw new Error("First chunk format is not JSON");return r.byteOffset+d===a?r.loadAsync(d).then(function(){return{json:o._parseJson(r.readString(d)),bin:null}}):r.loadAsync(d+8).then(function(){var T={json:o._parseJson(r.readString(d)),bin:null},g=function(){var F=r.readUint32(),M=r.readUint32();switch(M){case c.JSON:throw new Error("Unexpected JSON chunk");case c.BIN:{var C=r.byteOffset;T.bin={readAsync:function(R,B){return r.buffer.readAsync(C+R,B)},byteLength:F},r.skipBytes(F);break}default:{r.skipBytes(F);break}}return r.byteOffset!==a?r.loadAsync(8).then(g):Promise.resolve(T)};return g()})},e._parseVersion=function(r){if(r==="1.0"||r==="1.0.1")return{major:1,minor:0};var a=(r+"").match(/^(\d+)\.(\d+)/);return a?{major:parseInt(a[1]),minor:parseInt(a[2])}:null},e._compareVersion=function(r,a){return r.major>a.major?1:r.major<a.major?-1:r.minor>a.minor?1:r.minor<a.minor?-1:0},e.prototype._logOpen=function(r){this._log(r),this._logIndentLevel++},e.prototype._logClose=function(){--this._logIndentLevel},e.prototype._logEnabled=function(r){var a=e._logSpaces.substr(0,this._logIndentLevel*2);s.Logger.Log("".concat(a).concat(r))},e.prototype._logDisabled=function(r){},e.prototype._startPerformanceCounterEnabled=function(r){s.Tools.StartPerformanceCounter(r)},e.prototype._startPerformanceCounterDisabled=function(r){},e.prototype._endPerformanceCounterEnabled=function(r){s.Tools.EndPerformanceCounter(r)},e.prototype._endPerformanceCounterDisabled=function(r){},e.IncrementalLoading=!0,e.HomogeneousCoordinates=!1,e._MagicBase64Encoded="Z2xURg",e._logSpaces="                                ",e}();s.SceneLoader&&s.SceneLoader.RegisterPlugin(new t)},"../../../dev/loaders/src/glTF/glTFValidation.ts":(N,E,h)=>{h.r(E),h.d(E,{GLTFValidation:()=>m});var s=h("babylonjs/Misc/observable");function u(l,i,n,t){var e={externalResourceFunction:t};return n&&(e.uri=i==="file:"?n:i+n),ArrayBuffer.isView(l)?GLTFValidator.validateBytes(l,e):GLTFValidator.validateString(l,e)}function v(){var l=[];onmessage=function(i){var n=i.data;switch(n.id){case"init":{importScripts(n.url);break}case"validate":{u(n.data,n.rootUrl,n.fileName,function(t){return new Promise(function(e,r){var a=l.length;l.push({resolve:e,reject:r}),postMessage({id:"getExternalResource",index:a,uri:t})})}).then(function(t){postMessage({id:"validate.resolve",value:t})},function(t){postMessage({id:"validate.reject",reason:t})});break}case"getExternalResource.resolve":{l[n.index].resolve(n.value);break}case"getExternalResource.reject":{l[n.index].reject(n.reason);break}}}}var m=function(){function l(){}return l.ValidateAsync=function(i,n,t,e){var r=this;return typeof Worker=="function"?new Promise(function(a,o){var c="".concat(u,"(").concat(v,")()"),d=URL.createObjectURL(new Blob([c],{type:"application/javascript"})),f=new Worker(d),T=function(M){f.removeEventListener("error",T),f.removeEventListener("message",g),o(M)},g=function(M){var C=M.data;switch(C.id){case"getExternalResource":{e(C.uri).then(function(R){f.postMessage({id:"getExternalResource.resolve",index:C.index,value:R},[R.buffer])},function(R){f.postMessage({id:"getExternalResource.reject",index:C.index,reason:R})});break}case"validate.resolve":{f.removeEventListener("error",T),f.removeEventListener("message",g),a(C.value),f.terminate();break}case"validate.reject":f.removeEventListener("error",T),f.removeEventListener("message",g),o(C.reason),f.terminate()}};if(f.addEventListener("error",T),f.addEventListener("message",g),f.postMessage({id:"init",url:s.Tools.GetBabylonScriptURL(r.Configuration.url)}),ArrayBuffer.isView(i)){var F=i.slice();f.postMessage({id:"validate",data:F,rootUrl:n,fileName:t},[F.buffer])}else f.postMessage({id:"validate",data:i,rootUrl:n,fileName:t})}):(this._LoadScriptPromise||(this._LoadScriptPromise=s.Tools.LoadBabylonScriptAsync(this.Configuration.url)),this._LoadScriptPromise.then(function(){return u(i,n,t,e)}))},l.Configuration={url:"".concat(s.Tools._DefaultCdnUrl,"/gltf_validator.js")},l}()},"../../../dev/loaders/src/glTF/index.ts":(N,E,h)=>{h.r(E),h.d(E,{GLTF1:()=>v,GLTF2:()=>m,GLTFFileLoader:()=>s.GLTFFileLoader,GLTFLoaderAnimationStartMode:()=>s.GLTFLoaderAnimationStartMode,GLTFLoaderCoordinateSystemMode:()=>s.GLTFLoaderCoordinateSystemMode,GLTFLoaderState:()=>s.GLTFLoaderState,GLTFValidation:()=>u.GLTFValidation});var s=h("../../../dev/loaders/src/glTF/glTFFileLoader.ts"),u=h("../../../dev/loaders/src/glTF/glTFValidation.ts"),v=h("../../../dev/loaders/src/glTF/1.0/index.ts"),m=h("../../../dev/loaders/src/glTF/2.0/index.ts")},"../../../dev/loaders/src/index.ts":(N,E,h)=>{h.r(E),h.d(E,{GLTF1:()=>s.GLTF1,GLTF2:()=>s.GLTF2,GLTFFileLoader:()=>s.GLTFFileLoader,GLTFLoaderAnimationStartMode:()=>s.GLTFLoaderAnimationStartMode,GLTFLoaderCoordinateSystemMode:()=>s.GLTFLoaderCoordinateSystemMode,GLTFLoaderState:()=>s.GLTFLoaderState,GLTFValidation:()=>s.GLTFValidation,MTLFileLoader:()=>u.MTLFileLoader,OBJFileLoader:()=>u.OBJFileLoader,SPLATFileLoader:()=>m.SPLATFileLoader,STLFileLoader:()=>v.STLFileLoader,SolidParser:()=>u.SolidParser});var s=h("../../../dev/loaders/src/glTF/index.ts"),u=h("../../../dev/loaders/src/OBJ/index.ts"),v=h("../../../dev/loaders/src/STL/index.ts"),m=h("../../../dev/loaders/src/SPLAT/index.ts")},"../../../lts/loaders/src/legacy/legacy-glTF.ts":(N,E,h)=>{h.r(E),h.d(E,{GLTFFileLoader:()=>s.GLTFFileLoader,GLTFLoaderAnimationStartMode:()=>s.GLTFLoaderAnimationStartMode,GLTFLoaderCoordinateSystemMode:()=>s.GLTFLoaderCoordinateSystemMode,GLTFLoaderState:()=>s.GLTFLoaderState,GLTFValidation:()=>u.GLTFValidation});var s=h("../../../dev/loaders/src/glTF/glTFFileLoader.ts"),u=h("../../../dev/loaders/src/glTF/glTFValidation.ts"),v=typeof h.g<"u"?h.g:typeof window<"u"?window:void 0;if(typeof v<"u"){v.BABYLON=v.BABYLON||{};for(var m in s)v.BABYLON[m]=s[m];for(var m in u)v.BABYLON[m]=u[m]}},"../../../lts/loaders/src/legacy/legacy-glTF1.ts":(N,E,h)=>{h.r(E),h.d(E,{GLTF1:()=>s});var s=h("../../../dev/loaders/src/glTF/1.0/index.ts"),u=typeof h.g<"u"?h.g:typeof window<"u"?window:void 0;if(typeof u<"u"){u.BABYLON=u.BABYLON||{},u.BABYLON.GLTF1=u.BABYLON.GLTF1||{};for(var v in s)u.BABYLON.GLTF1[v]=s[v]}},"../../../lts/loaders/src/legacy/legacy-glTF2.ts":(N,E,h)=>{h.r(E),h.d(E,{GLTF2:()=>v});var s=h("../../../dev/loaders/src/glTF/2.0/Extensions/index.ts"),u=h("../../../dev/loaders/src/glTF/2.0/glTFLoaderInterfaces.ts"),v=h("../../../dev/loaders/src/glTF/2.0/index.ts"),m=typeof h.g<"u"?h.g:typeof window<"u"?window:void 0;if(typeof m<"u"){m.BABYLON=m.BABYLON||{};var l=m.BABYLON;l.GLTF2=l.GLTF2||{},l.GLTF2.Loader=l.GLTF2.Loader||{},l.GLTF2.Loader.Extensions=l.GLTF2.Loader.Extensions||{};var i=[];for(var n in s)l.GLTF2.Loader.Extensions[n]=s[n],i.push(n);for(var n in u)l.GLTF2.Loader[n]=u[n],i.push(n);for(var n in v)i.indexOf(n)>-1||(l.GLTF2[n]=v[n])}},"../../../lts/loaders/src/legacy/legacy-objFileLoader.ts":(N,E,h)=>{h.r(E),h.d(E,{MTLFileLoader:()=>s.MTLFileLoader,OBJFileLoader:()=>s.OBJFileLoader,SolidParser:()=>s.SolidParser});var s=h("../../../dev/loaders/src/OBJ/index.ts"),u=typeof h.g<"u"?h.g:typeof window<"u"?window:void 0;if(typeof u<"u")for(var v in s)u.BABYLON[v]||(u.BABYLON[v]=s[v])},"../../../lts/loaders/src/legacy/legacy-stlFileLoader.ts":(N,E,h)=>{h.r(E),h.d(E,{STLFileLoader:()=>s.STLFileLoader});var s=h("../../../dev/loaders/src/STL/index.ts"),u=typeof h.g<"u"?h.g:typeof window<"u"?window:void 0;if(typeof u<"u")for(var v in s)u.BABYLON[v]||(u.BABYLON[v]=s[v])},"../../../lts/loaders/src/legacy/legacy.ts":(N,E,h)=>{h.r(E),h.d(E,{GLTF1:()=>s.GLTF1,GLTF2:()=>s.GLTF2,GLTFFileLoader:()=>s.GLTFFileLoader,GLTFLoaderAnimationStartMode:()=>s.GLTFLoaderAnimationStartMode,GLTFLoaderCoordinateSystemMode:()=>s.GLTFLoaderCoordinateSystemMode,GLTFLoaderState:()=>s.GLTFLoaderState,GLTFValidation:()=>s.GLTFValidation,MTLFileLoader:()=>s.MTLFileLoader,OBJFileLoader:()=>s.OBJFileLoader,SPLATFileLoader:()=>s.SPLATFileLoader,STLFileLoader:()=>s.STLFileLoader,SolidParser:()=>s.SolidParser});var s=h("../../../dev/loaders/src/index.ts");h("../../../lts/loaders/src/legacy/legacy-glTF.ts"),h("../../../lts/loaders/src/legacy/legacy-glTF1.ts"),h("../../../lts/loaders/src/legacy/legacy-glTF2.ts"),h("../../../lts/loaders/src/legacy/legacy-objFileLoader.ts"),h("../../../lts/loaders/src/legacy/legacy-stlFileLoader.ts")},"babylonjs/Misc/observable":N=>{N.exports=Le},"../../../../node_modules/tslib/tslib.es6.mjs":(N,E,h)=>{h.r(E),h.d(E,{__addDisposableResource:()=>ie,__assign:()=>v,__asyncDelegator:()=>K,__asyncGenerator:()=>B,__asyncValues:()=>V,__await:()=>R,__awaiter:()=>o,__classPrivateFieldGet:()=>k,__classPrivateFieldIn:()=>ue,__classPrivateFieldSet:()=>oe,__createBinding:()=>d,__decorate:()=>l,__disposeResources:()=>ee,__esDecorate:()=>n,__exportStar:()=>f,__extends:()=>u,__generator:()=>c,__importDefault:()=>Q,__importStar:()=>Z,__makeTemplateObject:()=>j,__metadata:()=>a,__param:()=>i,__propKey:()=>e,__read:()=>g,__rest:()=>m,__runInitializers:()=>t,__setFunctionName:()=>r,__spread:()=>F,__spreadArray:()=>C,__spreadArrays:()=>M,__values:()=>T,default:()=>$});var s=function(O,b){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,p){x.__proto__=p}||function(x,p){for(var _ in p)Object.prototype.hasOwnProperty.call(p,_)&&(x[_]=p[_])},s(O,b)};function u(O,b){if(typeof b!="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");s(O,b);function x(){this.constructor=O}O.prototype=b===null?Object.create(b):(x.prototype=b.prototype,new x)}var v=function(){return v=Object.assign||function(b){for(var x,p=1,_=arguments.length;p<_;p++){x=arguments[p];for(var y in x)Object.prototype.hasOwnProperty.call(x,y)&&(b[y]=x[y])}return b},v.apply(this,arguments)};function m(O,b){var x={};for(var p in O)Object.prototype.hasOwnProperty.call(O,p)&&b.indexOf(p)<0&&(x[p]=O[p]);if(O!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,p=Object.getOwnPropertySymbols(O);_<p.length;_++)b.indexOf(p[_])<0&&Object.prototype.propertyIsEnumerable.call(O,p[_])&&(x[p[_]]=O[p[_]]);return x}function l(O,b,x,p){var _=arguments.length,y=_<3?b:p===null?p=Object.getOwnPropertyDescriptor(b,x):p,A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(O,b,x,p);else for(var L=O.length-1;L>=0;L--)(A=O[L])&&(y=(_<3?A(y):_>3?A(b,x,y):A(b,x))||y);return _>3&&y&&Object.defineProperty(b,x,y),y}function i(O,b){return function(x,p){b(x,p,O)}}function n(O,b,x,p,_,y){function A(Y){if(Y!==void 0&&typeof Y!="function")throw new TypeError("Function expected");return Y}for(var L=p.kind,S=L==="getter"?"get":L==="setter"?"set":"value",P=!b&&O?p.static?O:O.prototype:null,I=b||(P?Object.getOwnPropertyDescriptor(P,p.name):{}),D,G=!1,w=x.length-1;w>=0;w--){var W={};for(var U in p)W[U]=U==="access"?{}:p[U];for(var U in p.access)W.access[U]=p.access[U];W.addInitializer=function(Y){if(G)throw new TypeError("Cannot add initializers after decoration has completed");y.push(A(Y||null))};var H=(0,x[w])(L==="accessor"?{get:I.get,set:I.set}:I[S],W);if(L==="accessor"){if(H===void 0)continue;if(H===null||typeof H!="object")throw new TypeError("Object expected");(D=A(H.get))&&(I.get=D),(D=A(H.set))&&(I.set=D),(D=A(H.init))&&_.unshift(D)}else(D=A(H))&&(L==="field"?_.unshift(D):I[S]=D)}P&&Object.defineProperty(P,p.name,I),G=!0}function t(O,b,x){for(var p=arguments.length>2,_=0;_<b.length;_++)x=p?b[_].call(O,x):b[_].call(O);return p?x:void 0}function e(O){return typeof O=="symbol"?O:"".concat(O)}function r(O,b,x){return typeof b=="symbol"&&(b=b.description?"[".concat(b.description,"]"):""),Object.defineProperty(O,"name",{configurable:!0,value:x?"".concat(x," ",b):b})}function a(O,b){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(O,b)}function o(O,b,x,p){function _(y){return y instanceof x?y:new x(function(A){A(y)})}return new(x||(x=Promise))(function(y,A){function L(I){try{P(p.next(I))}catch(D){A(D)}}function S(I){try{P(p.throw(I))}catch(D){A(D)}}function P(I){I.done?y(I.value):_(I.value).then(L,S)}P((p=p.apply(O,b||[])).next())})}function c(O,b){var x={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},p,_,y,A;return A={next:L(0),throw:L(1),return:L(2)},typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function L(P){return function(I){return S([P,I])}}function S(P){if(p)throw new TypeError("Generator is already executing.");for(;A&&(A=0,P[0]&&(x=0)),x;)try{if(p=1,_&&(y=P[0]&2?_.return:P[0]?_.throw||((y=_.return)&&y.call(_),0):_.next)&&!(y=y.call(_,P[1])).done)return y;switch(_=0,y&&(P=[P[0]&2,y.value]),P[0]){case 0:case 1:y=P;break;case 4:return x.label++,{value:P[1],done:!1};case 5:x.label++,_=P[1],P=[0];continue;case 7:P=x.ops.pop(),x.trys.pop();continue;default:if(y=x.trys,!(y=y.length>0&&y[y.length-1])&&(P[0]===6||P[0]===2)){x=0;continue}if(P[0]===3&&(!y||P[1]>y[0]&&P[1]<y[3])){x.label=P[1];break}if(P[0]===6&&x.label<y[1]){x.label=y[1],y=P;break}if(y&&x.label<y[2]){x.label=y[2],x.ops.push(P);break}y[2]&&x.ops.pop(),x.trys.pop();continue}P=b.call(O,x)}catch(I){P=[6,I],_=0}finally{p=y=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}}var d=Object.create?function(O,b,x,p){p===void 0&&(p=x);var _=Object.getOwnPropertyDescriptor(b,x);(!_||("get"in _?!b.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return b[x]}}),Object.defineProperty(O,p,_)}:function(O,b,x,p){p===void 0&&(p=x),O[p]=b[x]};function f(O,b){for(var x in O)x!=="default"&&!Object.prototype.hasOwnProperty.call(b,x)&&d(b,O,x)}function T(O){var b=typeof Symbol=="function"&&Symbol.iterator,x=b&&O[b],p=0;if(x)return x.call(O);if(O&&typeof O.length=="number")return{next:function(){return O&&p>=O.length&&(O=void 0),{value:O&&O[p++],done:!O}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(O,b){var x=typeof Symbol=="function"&&O[Symbol.iterator];if(!x)return O;var p=x.call(O),_,y=[],A;try{for(;(b===void 0||b-- >0)&&!(_=p.next()).done;)y.push(_.value)}catch(L){A={error:L}}finally{try{_&&!_.done&&(x=p.return)&&x.call(p)}finally{if(A)throw A.error}}return y}function F(){for(var O=[],b=0;b<arguments.length;b++)O=O.concat(g(arguments[b]));return O}function M(){for(var O=0,b=0,x=arguments.length;b<x;b++)O+=arguments[b].length;for(var p=Array(O),_=0,b=0;b<x;b++)for(var y=arguments[b],A=0,L=y.length;A<L;A++,_++)p[_]=y[A];return p}function C(O,b,x){if(x||arguments.length===2)for(var p=0,_=b.length,y;p<_;p++)(y||!(p in b))&&(y||(y=Array.prototype.slice.call(b,0,p)),y[p]=b[p]);return O.concat(y||Array.prototype.slice.call(b))}function R(O){return this instanceof R?(this.v=O,this):new R(O)}function B(O,b,x){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var p=x.apply(O,b||[]),_,y=[];return _={},L("next"),L("throw"),L("return",A),_[Symbol.asyncIterator]=function(){return this},_;function A(w){return function(W){return Promise.resolve(W).then(w,D)}}function L(w,W){p[w]&&(_[w]=function(U){return new Promise(function(H,Y){y.push([w,U,H,Y])>1||S(w,U)})},W&&(_[w]=W(_[w])))}function S(w,W){try{P(p[w](W))}catch(U){G(y[0][3],U)}}function P(w){w.value instanceof R?Promise.resolve(w.value.v).then(I,D):G(y[0][2],w)}function I(w){S("next",w)}function D(w){S("throw",w)}function G(w,W){w(W),y.shift(),y.length&&S(y[0][0],y[0][1])}}function K(O){var b,x;return b={},p("next"),p("throw",function(_){throw _}),p("return"),b[Symbol.iterator]=function(){return this},b;function p(_,y){b[_]=O[_]?function(A){return(x=!x)?{value:R(O[_](A)),done:!1}:y?y(A):A}:y}}function V(O){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var b=O[Symbol.asyncIterator],x;return b?b.call(O):(O=typeof T=="function"?T(O):O[Symbol.iterator](),x={},p("next"),p("throw"),p("return"),x[Symbol.asyncIterator]=function(){return this},x);function p(y){x[y]=O[y]&&function(A){return new Promise(function(L,S){A=O[y](A),_(L,S,A.done,A.value)})}}function _(y,A,L,S){Promise.resolve(S).then(function(P){y({value:P,done:L})},A)}}function j(O,b){return Object.defineProperty?Object.defineProperty(O,"raw",{value:b}):O.raw=b,O}var z=Object.create?function(O,b){Object.defineProperty(O,"default",{enumerable:!0,value:b})}:function(O,b){O.default=b};function Z(O){if(O&&O.__esModule)return O;var b={};if(O!=null)for(var x in O)x!=="default"&&Object.prototype.hasOwnProperty.call(O,x)&&d(b,O,x);return z(b,O),b}function Q(O){return O&&O.__esModule?O:{default:O}}function k(O,b,x,p){if(x==="a"&&!p)throw new TypeError("Private accessor was defined without a getter");if(typeof b=="function"?O!==b||!p:!b.has(O))throw new TypeError("Cannot read private member from an object whose class did not declare it");return x==="m"?p:x==="a"?p.call(O):p?p.value:b.get(O)}function oe(O,b,x,p,_){if(p==="m")throw new TypeError("Private method is not writable");if(p==="a"&&!_)throw new TypeError("Private accessor was defined without a setter");if(typeof b=="function"?O!==b||!_:!b.has(O))throw new TypeError("Cannot write private member to an object whose class did not declare it");return p==="a"?_.call(O,x):_?_.value=x:b.set(O,x),x}function ue(O,b){if(b===null||typeof b!="object"&&typeof b!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof O=="function"?b===O:O.has(b)}function ie(O,b,x){if(b!=null){if(typeof b!="object"&&typeof b!="function")throw new TypeError("Object expected.");var p,_;if(x){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");p=b[Symbol.asyncDispose]}if(p===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");p=b[Symbol.dispose],x&&(_=p)}if(typeof p!="function")throw new TypeError("Object not disposable.");_&&(p=function(){try{_.call(this)}catch(y){return Promise.reject(y)}}),O.stack.push({value:b,dispose:p,async:x})}else x&&O.stack.push({async:!0});return b}var q=typeof SuppressedError=="function"?SuppressedError:function(O,b,x){var p=new Error(x);return p.name="SuppressedError",p.error=O,p.suppressed=b,p};function ee(O){function b(p){O.error=O.hasError?new q(p,O.error,"An error was suppressed during disposal."):p,O.hasError=!0}function x(){for(;O.stack.length;){var p=O.stack.pop();try{var _=p.dispose&&p.dispose.call(p.value);if(p.async)return Promise.resolve(_).then(x,function(y){return b(y),x()})}catch(y){b(y)}}if(O.hasError)throw O.error}return x()}const $={__extends:u,__assign:v,__rest:m,__decorate:l,__param:i,__metadata:a,__awaiter:o,__generator:c,__createBinding:d,__exportStar:f,__values:T,__read:g,__spread:F,__spreadArrays:M,__spreadArray:C,__await:R,__asyncGenerator:B,__asyncDelegator:K,__asyncValues:V,__makeTemplateObject:j,__importStar:Z,__importDefault:Q,__classPrivateFieldGet:k,__classPrivateFieldSet:oe,__classPrivateFieldIn:ue,__addDisposableResource:ie,__disposeResources:ee}}},ge={};function de(N){var E=ge[N];if(E!==void 0)return E.exports;var h=ge[N]={exports:{}};return Fe[N](h,h.exports,de),h.exports}de.n=N=>{var E=N&&N.__esModule?()=>N.default:()=>N;return de.d(E,{a:E}),E},de.d=(N,E)=>{for(var h in E)de.o(E,h)&&!de.o(N,h)&&Object.defineProperty(N,h,{enumerable:!0,get:E[h]})},de.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),de.o=(N,E)=>Object.prototype.hasOwnProperty.call(N,E),de.r=N=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(N,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(N,"__esModule",{value:!0})};var ye={};return(()=>{/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/de.r(ye),de.d(ye,{default:()=>E,loaders:()=>N});var N=de("../../../lts/loaders/src/legacy/legacy.ts");const E=N})(),ye=ye.default,ye})())})(Re);
